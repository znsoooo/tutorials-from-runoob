<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>E.202. 版本 8.2</title><link rel="stylesheet" type="text/css" href="../../0/stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="release-8-2-1.html" title="E.201. 版本 8.2.1" /><link rel="next" href="release-8-1-23.html" title="E.203. 版本 8.1.23" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">E.202. 版本 8.2</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="release-8-2-1.html" title="E.201. 版本 8.2.1">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="release.html" title="附录 E. 版本说明">上一级</a></td><th width="60%" align="center">附录 E. 版本说明</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.1 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="release-8-1-23.html" title="E.203. 版本 8.1.23">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="RELEASE-8-2"><div class="titlepage"><div><div><h2 class="title" style="clear: both">E.202. 版本 8.2</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="release-8-2.html#idp80089040">E.202.1. 概述</a></span></dt><dt><span class="sect2"><a href="release-8-2.html#idp80104336">E.202.2. 迁移到版本 8.2</a></span></dt><dt><span class="sect2"><a href="release-8-2.html#idp80177904">E.202.3. 修改列表</a></span></dt></dl></div><p><strong>发布日期：. </strong>2006-12-05</p><div class="sect2" id="idp80089040"><div class="titlepage"><div><div><h3 class="title">E.202.1. 概述</h3></div></div></div><p>这个版本添加了许多用户要求的功能和性能改善，包括：

   </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>查询语言增强包括<code class="command">INSERT/UPDATE/DELETE RETURNING</code>，
多行<code class="literal">VALUES</code>列表和<code class="command">UPDATE</code>/<code class="command">DELETE</code>
中可选的目标表别名。</p></li><li class="listitem"><p>不带有并发锁的索引创建<code class="command">INSERT</code>/<code class="command">UPDATE</code>/<code class="command">DELETE</code>操作</p></li><li class="listitem"><p>许多查询最优化改善，包括对重新排序外连接的支持</p></li><li class="listitem"><p>提高降低内存使用的排序性能</p></li><li class="listitem"><p>带有更好的并发性的更多有效的锁定</p></li><li class="listitem"><p>更有效的清理</p></li><li class="listitem"><p>简化热备服务器的管理</p></li><li class="listitem"><p>为表和索引新增<code class="literal">FILLFACTOR</code>支持</p></li><li class="listitem"><p>监视、记录和性能调优的添加</p></li><li class="listitem"><p>对创建和删除对象的更多控制</p></li><li class="listitem"><p>表继承管理可以为已经存在的表定义或从已经存在的表中删除</p></li><li class="listitem"><p><code class="command">COPY TO</code>可以拷贝任意<code class="command">SELECT</code>语句的输出</p></li><li class="listitem"><p>数组的改进，包括空数组</p></li><li class="listitem"><p>聚合函数的改进，包括多重输入聚合和SQL:2003统计函数</p></li><li class="listitem"><p>许多<code class="filename">contrib/</code>的改进</p></li></ul></div><p>

   </p></div><div class="sect2" id="idp80104336"><div class="titlepage"><div><div><h3 class="title">E.202.2. 迁移到版本 8.2</h3></div></div></div><p>想要从任何以前的版本中迁移数据的用户需要使用<span class="application">pg_dump</span>转储/恢复。</p><p>观察下列的不兼容性：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>缺省设置<a class="link" href="runtime-config-compatible.html#GUC-ESCAPE-STRING-WARNING"><code class="varname">escape_string_warning</code></a>
为<code class="literal">on</code> (Bruce)</p><p>如果反斜杠转义在<a class="link" href="sql-syntax-lexical.html#SQL-SYNTAX-STRINGS" title="4.1.2.1. 字符串常量">非转义(非<code class="literal">E''</code>)字符串</a>
中使用，这会发出一个警告。</p></li><li class="listitem"><p>修改<a class="link" href="sql-expressions.html#SQL-SYNTAX-ROW-CONSTRUCTORS" title="4.2.13. 行构造器">行构造函数语法</a> (<code class="literal">ROW(...)</code>)，
这样列表元素<code class="literal">foo.*</code>将被扩展到一个他们的成员字段的列表，
而不是和以前一样创建一个嵌套的行类型字段 (Tom)</p><p>新的行为实际上更有用，因为它允许，例如，触发器用
<code class="literal">IF row(new.*) IS DISTINCT FROM row(old.*)</code>检查数据的改变。
通过省略<code class="literal">.*</code>，仍然可以使用老的行为。</p></li><li class="listitem"><p>让<a class="link" href="functions-comparisons.html#ROW-WISE-COMPARISON" title="9.23.5. 行构造器比较">行比较</a>遵循<acronym class="acronym">SQL</acronym>
标准语义，并允许它们在索引扫描中使用 (Tom)</p><p>以前，row = 和 &lt;&gt;比较遵循标准，但是&lt; &lt;= &gt; &gt;=不遵循标准。
行比较现在可以用作多字段索引的索引约束匹配行值。</p></li><li class="listitem"><p>让<a class="link" href="functions-comparison.html" title="9.2. 比较操作符">row <code class="literal">IS [<span class="optional">NOT</span>] NULL</code></a>
测试遵循<acronym class="acronym">SQL</acronym>标准语义 (Tom)</p><p>前者的行为在<code class="literal">IS NULL</code>的简单情况下符合标准，但是如果任意行字段是非空的，
<code class="literal">IS NOT NULL</code>将返回真，而标准认为只有所有字段都是非空的时才应该返回真。</p></li><li class="listitem"><p>让<a class="link" href="sql-set-constraints.html" title="SET CONSTRAINTS"><code class="command">SET CONSTRAINT</code></a>
只影响一个约束 (Kris Jurka)</p><p>在以前的版本中，<code class="command">SET CONSTRAINT</code>用一个匹配的名字修改所有的约束。
在这个版本中，模式搜索路径只用于修改第一个匹配的约束。
也支持模式声明。这更加符合SQL标准。</p></li><li class="listitem"><p>因为安全原因，为表删除<code class="literal">RULE</code>权限 (Tom)</p><p>这个版本，只有表的所有者可以为该表创建或修改规则。为了向后兼容，
仍然接受<code class="command">GRANT</code>/<code class="command">REVOKE RULE</code>，但是它什么也不做。</p></li><li class="listitem"><p>数组比较的改进 (Tom)</p><p>现在也比较数组的维度。</p></li><li class="listitem"><p>修改<a class="link" href="functions-array.html" title="9.18. 数组函数和操作符">数组连接</a>，以匹配记录的行为 (Tom)</p><p>这改变了串联会修改数组下界的以前的行为。</p></li><li class="listitem"><p>让<span class="application">postmaster</span>和<a class="link" href="app-postgres.html" title="postgres"><span class="application">postgres</span></a>
的命令行选项相同 (Peter)</p><p>这允许主进程不使用<code class="literal">-o</code>就能传递参数到每个后端。请注意，
某些选项现在只能用作长格式的选项，因为与单字母的选项有冲突。</p></li><li class="listitem"><p>反对使用<span class="application">postmaster</span>符号连接 (Peter)</p><p><span class="application">postmaster</span>和<span class="application">postgres</span>命令现在动作相同，
行为由命令行选项决定。为了兼容性，保留了<span class="application">postmaster</span>符号连接，
但是实际上不需要了。</p></li><li class="listitem"><p>修改<a class="link" href="runtime-config-logging.html#GUC-LOG-DURATION"><code class="varname">log_duration</code></a>，
使其在查询没有输出的情况下也输出 (Tom)</p><p>在以前的版本中，<code class="varname">log_duration</code>只在查询出现在日志的前面时才输出。</p></li><li class="listitem"><p>让<a class="link" href="functions-formatting.html" title="9.8. 数据类型格式化函数"><code class="function">to_char(time)</code></a>
和<a class="link" href="functions-formatting.html" title="9.8. 数据类型格式化函数"><code class="function">to_char(interval)</code></a>
对待<code class="literal">HH</code>和<code class="literal">HH12</code>为12小时间隔</p><p>大多数应用应该使用<code class="literal">HH24</code>，除非它们想要12小时显示。</p></li><li class="listitem"><p>在从<a class="link" href="datatype-net-types.html#DATATYPE-INET" title="8.9.1. inet"><code class="type">INET</code></a>到
<a class="link" href="datatype-net-types.html#DATATYPE-INET" title="8.9.1. inet"><code class="type">CIDR</code></a>
的转换中有零个未标记的位 (Tom)</p><p>这确保了转换的值对于<code class="type">CIDR</code>实际有效。</p></li><li class="listitem"><p>删除<code class="varname">australian_timezones</code>配置变量 (Joachim Wieland)</p><p>为了配置时区缩写，这个变量被一个更通用的设备取代。</p></li><li class="listitem"><p>为嵌套的循环索引扫描改善开销估计 (Tom)</p><p>这可以消除设置不切实际的小的<a class="link" href="runtime-config-query.html#GUC-RANDOM-PAGE-COST"><code class="varname">random_page_cost</code></a>
值的需要。如果你已经使用了一个非常小的<code class="varname">random_page_cost</code>，请重新检查你的测试用例。</p></li><li class="listitem"><p>改变<code class="command">pg_dump</code> <code class="literal">-n</code>和<code class="literal">-t</code>选项的行为。 (Greg Sabino Mullane)</p><p>请查看<code class="command">pg_dump</code>手册页获取细节。</p></li><li class="listitem"><p>修改<a class="link" href="libpq.html" title="第 33 章 libpq - C 库"><span class="application">libpq</span></a> <code class="function">PQdsplen()</code>
以返回一个有用的值 (Martijn van Oosterhout)</p></li><li class="listitem"><p>声明<a class="link" href="libpq.html" title="第 33 章 libpq - C 库"><span class="application">libpq</span></a> <code class="function">PQgetssl()</code>
返回<code class="literal">void *</code>，而不是<code class="literal">SSL *</code> (Martijn van Oosterhout)</p><p>这允许应用不包括OpenSSL头使用函数。</p></li><li class="listitem"><p>为了版本兼容性检查，C语言可加载模块现在必须包括一个
<a class="link" href="xfunc-c.html#XFUNC-C-DYNLOAD" title="37.9.1. 动态载入"><code class="literal">PG_MODULE_MAGIC</code></a>
宏调用 (Martijn van Oosterhout)</p></li><li class="listitem"><p>为了安全起见，PL/PerlU函数使用的模块不再可用于PL/Perl函数 (Andrew)</p><div class="note"><h3 class="title">注意</h3><p>这也意味着数据在PL/Perl函数和PL/PerlU函数之间不再能够共享。
某些Perl安装没有用正确的允许多个解释器存在于一个进程中的标识编译。
在这种情况下，PL/Perl和PL/PerlU不能同时用于一个后端中。
解决办法是获得一个支持多个解释器的Perl安装。</p></div></li><li class="listitem"><p>在<code class="filename">contrib/xml2/</code>中，重命名<code class="function">xml_valid()</code>
为<code class="function">xml_is_well_formed()</code> (Tom)</p><p>为了向后兼容，将保留<code class="function">xml_valid()</code>，但是它的行为将在未来的版本中改变为模式检查。</p></li><li class="listitem"><p>删除<code class="filename">contrib/ora2pg/</code>，现在在<a class="ulink" href="http://www.samse.fr/GPL/ora2pg" target="_top">http://www.samse.fr/GPL/ora2pg</a>中</p></li><li class="listitem"><p>删除已经迁移到PgFoundry的贡献模块：<code class="filename">adddepend</code>, <code class="filename">dbase</code>, 
<code class="filename">dbmirror</code>, <code class="filename">fulltextindex</code>, <code class="filename">mac</code>, <code class="filename">userlock</code></p></li><li class="listitem"><p>删除废弃的贡献模块：<code class="filename">mSQL-interface</code>, <code class="filename">tips</code></p></li><li class="listitem"><p>删除<acronym class="acronym">QNX</acronym>和<acronym class="acronym">BEOS</acronym>端口 (Bruce)</p><p>这些端口不再有活跃的维护者。</p></li></ul></div></div><div class="sect2" id="idp80177904"><div class="titlepage"><div><div><h3 class="title">E.202.3. 修改列表</h3></div></div></div><p>下面你将看到<span class="productname">PostgreSQL</span> 8.2和以前的主版本之间详细的变化。</p><div class="sect3" id="idp80179408"><div class="titlepage"><div><div><h4 class="title">E.202.3.1. 性能提升</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>允许规划器在某些情况下重新排序<a class="link" href="queries-table-expressions.html#QUERIES-JOIN" title="7.2.1.1. 连接表">外连接</a> (Tom)</p><p>在以前的版本中，外连接总是以在查询中写入的顺序计算。这个修改允许查询优化器考虑重新排序外连接，
在它确定改变连接顺序而不改变查询的意思的情况下。这对于包含多个外连接或混合内部和外部连接的查询来说，
会产生一个可观的性能差异。</p></li><li class="listitem"><p>提高<a class="link" href="functions-comparisons.html" title="9.23. 行和数组比较"><code class="literal">IN</code> (表达式列表)</a>
子句的效率 (Tom)</p></li><li class="listitem"><p>提高排序速度和减少内存使用 (Simon, Tom)</p></li><li class="listitem"><p>提高子事务性能 (Alvaro, Itagaki Takahiro, Tom)</p></li><li class="listitem"><p>添加<code class="literal">FILLFACTOR</code>到<a class="link" href="sql-createtable.html" title="CREATE TABLE">表</a>和
<a class="link" href="sql-createindex.html" title="CREATE INDEX">索引</a>创建(ITAGAKI Takahiro)</p><p>这在每个表或索引页中留有额外的自由空间，允许随着数据的增长提高性能。
这对于维护集群来说特别有价值。</p></li><li class="listitem"><p>为<a class="link" href="runtime-config-resource.html#GUC-SHARED-BUFFERS"><code class="varname">shared_buffers</code></a>
和<code class="varname">max_fsm_pages</code>增加默认值 (Andrew)</p></li><li class="listitem"><p>通过打断锁管理器表为部分，提高锁的性能 (Tom)</p><p>这允许锁定粒度更细，减少争用。</p></li><li class="listitem"><p>减少序列扫描的锁定需求 (Qingqing Zhou)</p></li><li class="listitem"><p>减少数据库创建和销毁的锁定需求 (Tom)</p></li><li class="listitem"><p>为<a class="link" href="functions-matching.html#FUNCTIONS-LIKE" title="9.7.1. LIKE"><code class="literal">LIKE</code></a>,
<a class="link" href="functions-matching.html#FUNCTIONS-LIKE" title="9.7.1. LIKE"><code class="literal">ILIKE</code></a>和
<a class="link" href="functions-matching.html#FUNCTIONS-POSIX-REGEXP" title="9.7.3. POSIX正则表达式">正则表达式</a>操作改善优化器的选择性估计。</p></li><li class="listitem"><p>改善连接的规划，以<a class="link" href="ddl-inherit.html" title="5.9. 继承">继承的表</a>和
<a class="link" href="queries-union.html" title="7.4. 组合查询"><code class="literal">UNION ALL</code></a>视图 (Tom)</p></li><li class="listitem"><p>允许<a class="link" href="runtime-config-query.html#GUC-CONSTRAINT-EXCLUSION">约束排除</a>应用于
<a class="link" href="ddl-inherit.html" title="5.9. 继承">继承的</a><code class="command">UPDATE</code>和
<code class="command">DELETE</code>查询 (Tom)</p><p><code class="command">SELECT</code>早已遵循约束排除。</p></li><li class="listitem"><p>改善常量<code class="literal">WHERE</code>子句的规划，比如一个只依赖于从一个外部查询级别继承的变量的条件 (Tom)</p></li><li class="listitem"><p>协议级别未命名的预备语句是为每个<code class="literal">BIND</code>值组重新规划的 (Tom)</p><p>因为准确的参数值可以在计划中使用，所以提高了性能。</p></li><li class="listitem"><p>加速清理B-Tree索引 (Heikki Linnakangas, Tom)</p></li><li class="listitem"><p>避免在<a class="link" href="sql-vacuum.html" title="VACUUM"><code class="command">VACUUM</code></a>
期间额外的扫描没有索引的表 (Greg Stark)</p></li><li class="listitem"><p>提高多字段<a class="link" href="gist.html" title="第 62 章 GiST 索引"><acronym class="acronym">GiST</acronym></a>索引 (Oleg, Teodor)</p></li><li class="listitem"><p>在B-Tree页分裂之前删除死的索引条目 (Junji Teramoto)</p></li></ul></div></div><div class="sect3" id="idp80208960"><div class="titlepage"><div><div><h4 class="title">E.202.3.2. 服务器的变化</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>允许强制切换到一个新的事务日志文件 (Simon, Tom)</p><p>这对于保持热备份从服务器与主服务器同步是有价值的。事务日志文件切换现在在
<a class="link" href="functions-admin.html" title="9.26. 系统管理函数"><code class="function">pg_stop_backup()</code></a>
期间也自动发生。这确保了恢复所需要的所有事务日志文件可以立即归档。</p></li><li class="listitem"><p>添加<acronym class="acronym">WAL</acronym>信息函数 (Simon)</p><p>为从<a class="link" href="functions-admin.html" title="9.26. 系统管理函数"><code class="function">pg_stop_backup()</code></a>
和相关函数显示的十六进制<acronym class="acronym">WAL</acronym>位置中询问当前事务日志插入点和决定
<acronym class="acronym">WAL</acronym>文件名添加函数。</p></li><li class="listitem"><p>改善<acronym class="acronym">WAL</acronym>重放期间从一个崩溃中恢复 (Simon)</p><p>服务器现在在<acronym class="acronym">WAL</acronym>恢复期间定期的检查点，所以如果有一个崩溃，
未来的<acronym class="acronym">WAL</acronym>恢复被缩短。这样如果崩溃了，
就消除了对热备份服务器重放自基础备份以来的整个日志的需要。</p></li><li class="listitem"><p>改善长期的<acronym class="acronym">WAL</acronym>重放的可靠性 (Heikki, Simon, Tom)</p><p>以前，由于XID包围，向前推进超过20亿事务的尝试将不会工作。
这意味着热备服务器必须定期从干净的基础备份中重载。</p></li><li class="listitem"><p>添加<a class="link" href="runtime-config-wal.html#GUC-ARCHIVE-TIMEOUT"><code class="varname">archive_timeout</code></a>，
强制事务日志文件在给定的时间间隔切换 (Simon)</p><p>这为热备份服务器执行最大的复制延迟。</p></li><li class="listitem"><p>添加本地<a class="link" href="auth-methods.html#AUTH-LDAP" title="20.3.7. LDAP 认证"><acronym class="acronym">LDAP</acronym></a>认证 (Magnus Hagander)</p><p>这对于不支持<acronym class="acronym">PAM</acronym>的平台，比如Windows，尤其有用。</p></li><li class="listitem"><p>添加<a class="link" href="sql-grant.html#SQL-GRANT-DESCRIPTION-OBJECTS" title="在数据库对象上 GRANT"><code class="literal">GRANT
       CONNECT ON DATABASE</code></a> (Gevik Babakhani)</p><p>这给出了数据库访问的SQL级别控制。它作为一个额外的过滤器工作，紧接着现有的
<a class="link" href="auth-pg-hba-conf.html" title="20.1. pg_hba.conf文件"><code class="filename">pg_hba.conf</code></a>控制。</p></li><li class="listitem"><p>添加对<a class="link" href="ssl-tcp.html" title="18.9. 用 SSL 进行安全的 TCP/IP 连接"><acronym class="acronym">SSL</acronym>证书撤销列表</a> (<acronym class="acronym">CRL</acronym>)
文件的支持 (Libor Hohoš)</p><p>服务器和<span class="application">libpq</span>现在都能识别<acronym class="acronym">CRL</acronym>文件。</p></li><li class="listitem"><p><a class="link" href="gist.html" title="第 62 章 GiST 索引"><acronym class="acronym">GiST</acronym></a>索引现在是可集群的 (Teodor)</p></li><li class="listitem"><p>删除例程自动清理服务器日志条目 (Bruce)</p><p><a class="link" href="monitoring-stats.html#MONITORING-STATS-VIEWS-TABLE" title="表 28.2. 已收集统计信息的视图"><code class="literal">pg_stat_activity</code></a>
现在显示自动清理活动。</p></li><li class="listitem"><p>在单独的表而不是整个数据库中跟踪最大的XID寿命 (Alvaro)</p><p>这通过避免不必要的VACUUM,减少了阻止事务ID环绕中包括的开销。</p></li><li class="listitem"><p>添加最后的清理和分析时间戳字段到状态收集器 (Larry Rosenman)</p><p>这些值现在出现在
<a class="link" href="monitoring-stats.html#MONITORING-STATS-VIEWS-TABLE" title="表 28.2. 已收集统计信息的视图"><code class="literal">pg_stat_*_tables</code></a>系统视图中。</p></li><li class="listitem"><p>提高统计监测的性能，尤其是<code class="varname">stats_command_string</code> (Tom, Bruce)</p><p>这个版本缺省启用<code class="varname">stats_command_string</code>，现在它的开销是最小的。
这意味着<a class="link" href="monitoring-stats.html#MONITORING-STATS-VIEWS-TABLE" title="表 28.2. 已收集统计信息的视图"><code class="literal">pg_stat_activity</code></a>
现在缺省将显示所有活动的查询。</p></li><li class="listitem"><p>添加一个<code class="literal">waiting</code>字段到
<a class="link" href="monitoring-stats.html#MONITORING-STATS-VIEWS-TABLE" title="表 28.2. 已收集统计信息的视图"><code class="literal">pg_stat_activity</code></a> (Tom)</p><p>这允许<code class="structname">pg_stat_activity</code>显示所有包括在<span class="application">ps</span>显示中的信息。</p></li><li class="listitem"><p>添加配置参数<a class="link" href="runtime-config-logging.html#GUC-UPDATE-PROCESS-TITLE"><code class="varname">update_process_title</code></a>，
控制<span class="application">ps</span>的显示是否为每个命令都更新了 (Bruce)</p><p>在更新<span class="application">ps</span>显示昂贵的平台上，有必要把这个关掉，完全依赖于
<code class="structname">pg_stat_activity</code>显示状态信息。</p></li><li class="listitem"><p>允许在配置设置中指定单位 (Peter)</p><p>例如，你现在可以设置<a class="link" href="runtime-config-resource.html#GUC-SHARED-BUFFERS"><code class="varname">shared_buffers</code></a>
为<code class="literal">32MB</code>，而不是在心里转换大小。</p></li><li class="listitem"><p>在<code class="filename">postgresql.conf</code>中添加对<a class="link" href="config-setting.html" title="19.1. 设置参数">包含指令</a>
的支持 (Joachim Wieland)</p></li><li class="listitem"><p>改善协议级别预备/绑定/执行消息的记录 (Bruce, Tom)</p><p>这样的日志现在显示语句名字、绑定参数值和被执行查询的文本。另外，
当通过<code class="varname">log_min_error_statement</code>启用时，查询文本正确的包含在记录的错误消息中。</p></li><li class="listitem"><p>阻止<a class="link" href="runtime-config-resource.html#GUC-MAX-STACK-DEPTH"><code class="varname">max_stack_depth</code></a>
被设置为不安全的值</p><p>在我们可以决定实际内核堆栈深度限制的平台上（大多数是），确保<code class="varname">max_stack_depth</code>
的初始缺省值是安全的，并拒绝尝试设置它为不安全的大值。</p></li><li class="listitem"><p>在更多情况下的查询中启用突出显示错误位置 (Tom)</p><p>服务器现在能够为一些语义错误报告一个具体的错误位置（比如未识别的字段名），
而不是和以前一样只报告基本的语法错误。</p></li><li class="listitem"><p>修复<code class="command">VACUUM</code>中<span class="quote">“<span class="quote">未能重新找到父键</span>”</span>错误 (Tom)</p></li><li class="listitem"><p>在服务器重新启动期间清理<code class="filename">pg_internal.init</code>缓存文件 (Simon)</p><p>这避免了PITR恢复之后缓存文件可能包含陈旧数据的风险。</p></li><li class="listitem"><p>修复通过<code class="command">VACUUM</code>截断十亿字节范围的大关系时的竞态条件 (Tom)</p></li><li class="listitem"><p>修复行级别锁上导致不需要的死锁错误的bug (Tom)</p></li><li class="listitem"><p>修复影响几十亿字节哈希索引的错误 (Tom)</p></li><li class="listitem"><p>每个后端进程现在是它自己的进程组领导 (Tom)</p><p>这允许查询取消退出从一个后端或归档/恢复进程中调用的子进程。</p></li></ul></div></div><div class="sect3" id="idp80260848"><div class="titlepage"><div><div><h4 class="title">E.202.3.3. 查询的变化</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加<a class="link" href="sql-insert.html" title="INSERT"><code class="command">INSERT</code></a>/<a class="link" href="sql-update.html" title="UPDATE"><code class="command">UPDATE</code></a>/<a class="link" href="sql-delete.html" title="DELETE"><code class="command">DELETE</code></a>
       <code class="literal">RETURNING</code> (Jonah Harris, Tom)</p><p>这允许这些命令返回值，比如为一个新行计算序列键。在<code class="command">UPDATE</code>的情况下，
返回来自行的更新版本的值。</p></li><li class="listitem"><p>添加对多行<a class="link" href="queries-values.html" title="7.7. VALUES列表"><code class="literal">VALUES</code></a>子句的支持，
按照SQL标准 (Joe, Tom)</p><p>这允许<code class="command">INSERT</code>插入多行常量，或查询使用常量生成结果集。例如，
<code class="literal">INSERT ...  VALUES (...), (...),
       ....</code>, and <code class="literal">SELECT * FROM (VALUES (...), (...),
       ....) AS alias(f1, ...)</code>。</p></li><li class="listitem"><p>允许<a class="link" href="sql-update.html" title="UPDATE"><code class="command">UPDATE</code></a>
和<a class="link" href="sql-delete.html" title="DELETE"><code class="command">DELETE</code></a>
为目标表使用一个别名 (Atsushi Ogawa)</p><p>SQL标准不允许在它们的命令中使用别名，但是许多数据库系统为了标记方便，无论如何都允许一个。</p></li><li class="listitem"><p>允许<a class="link" href="sql-update.html" title="UPDATE"><code class="command">UPDATE</code></a>
在一个值的列表中设置多个字段值 (Susanne Ebrecht)</p><p>这基本上是一个按对分配字段和值的速记。语法是<code class="literal">UPDATE tab
       SET (<em class="replaceable"><code>column</code></em>, ...) = (<em class="replaceable"><code>val</code></em>, ...)</code>。</p></li><li class="listitem"><p>使行比较按照标准工作 (Tom)</p><p>格式&lt;, &lt;=, &gt;, &gt;=现在按字母顺序比较行，也就是，比较第一个元素，
如果相等则比较第二个元素，以此类推。以前它们在所有的元素上扩展成一个AND条件，
这既不是标准也不是非常有用。</p></li><li class="listitem"><p>添加<a class="link" href="sql-truncate.html" title="TRUNCATE"><code class="literal">CASCADE</code></a>选项到<code class="command">TRUNCATE</code> (Joachim Wieland)</p><p>这导致<code class="command">TRUNCATE</code>自动包括通过外键引用指定的表的所有表。
虽然方便，但是这是一个危险的工具—小心的使用它！</p></li><li class="listitem"><p>在同一个<a class="link" href="sql-insert.html" title="INSERT"><code class="literal">SELECT</code></a>命令中支持
<code class="literal">FOR UPDATE</code>和<code class="literal">FOR SHARE</code> (Tom)</p></li><li class="listitem"><p>添加<a class="link" href="functions-comparisons.html" title="9.23. 行和数组比较"><code class="literal">IS NOT DISTINCT FROM</code></a> (Pavel Stehule)</p><p>这个操作符类似于等于(<code class="literal">=</code>)，但是当左侧和右侧的操作数都是<code class="literal">NULL</code>时，
评估为真，当只有一侧为<code class="literal">NULL</code>时评估为假，而不是在这些情况下生成<code class="literal">NULL</code>。</p></li><li class="listitem"><p>改善<a class="link" href="queries-union.html" title="7.4. 组合查询"><code class="literal">UNION</code></a>/<code class="literal">INTERSECT</code>/<code class="literal">EXCEPT</code>
使用的长度输出 (Tom)</p><p>当所有对应的字段有相同的定义长度时，该长度用于结果，而不是一个通用的长度。</p></li><li class="listitem"><p>允许<a class="link" href="functions-matching.html#FUNCTIONS-LIKE" title="9.7.1. LIKE"><code class="literal">ILIKE</code></a>为多字节编码工作 (Tom)</p><p>内部的，<code class="literal">ILIKE</code>现在调用<code class="function">lower()</code>然后使用<code class="literal">LIKE</code>。
地区设定的正则表达式模式在这些编码中仍然不工作。</p></li><li class="listitem"><p>使<a class="link" href="runtime-config-compatible.html#GUC-STANDARD-CONFORMING-STRINGS"><code class="varname">standard_conforming_strings</code></a>
能变成<code class="literal">on</code> (Kevin Grittner)</p><p>这允许禁用字符串中的反斜杠转义，让<span class="productname">PostgreSQL</span>更加标准兼容。
为了向后兼容，缺省是<code class="literal">off</code>，但是未来的版本将改成缺省为<code class="literal">on</code>。</p></li><li class="listitem"><p>不要在子查询目标列表中平面化包含<code class="literal">volatile</code>函数的子查询 (Jaime Casanova)</p><p>这阻止了由于<code class="literal">volatile</code>函数（比如<code class="function">random()</code>或<code class="function">nextval()</code>）
的多次评估引起的意外行为。它可能导致在不需要标记为<code class="literal">volatile</code>
的函数面前性能退化。</p></li><li class="listitem"><p>添加系统视图<a class="link" href="view-pg-prepared-statements.html" title="51.76. pg_prepared_statements"><code class="literal">pg_prepared_statements</code></a>
和<a class="link" href="view-pg-cursors.html" title="51.68. pg_cursors"><code class="literal">pg_cursors</code></a>，
显示预备语句和打开的游标 (Joachim Wieland, Neil)</p><p>这在池连接设置中非常有用。</p></li><li class="listitem"><p>在<a class="link" href="sql-explain.html" title="EXPLAIN"><code class="command">EXPLAIN</code></a>和
<a class="link" href="sql-execute.html" title="EXECUTE"><code class="command">EXECUTE</code></a>
中支持入口参数 (Tom)</p><p>这允许，例如，<acronym class="acronym">JDBC</acronym> <code class="literal">?</code>参数在这些命令中工作。</p></li><li class="listitem"><p>如果<acronym class="acronym">SQL</acronym>级别的<a class="link" href="sql-prepare.html" title="PREPARE"><code class="command">PREPARE</code></a>
参数没有指定，那么从查询的内容中推断它们的类型 (Neil)</p><p>协议层<code class="command">PREPARE</code>早已这样做了。</p></li><li class="listitem"><p>允许<code class="literal">LIMIT</code>和<code class="literal">OFFSET</code>超过二十亿 (Dhanaraj M)</p></li></ul></div></div><div class="sect3" id="idp80320800"><div class="titlepage"><div><div><h4 class="title">E.202.3.4. 对象操作的变化</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加<code class="literal">TABLESPACE</code>子句到
<a class="link" href="sql-createtableas.html" title="CREATE TABLE AS"><code class="command">CREATE TABLE AS</code></a> (Neil)</p><p>这允许为新表指定表空间。</p></li><li class="listitem"><p>添加<code class="literal">ON COMMIT</code>子句到
<a class="link" href="sql-createtableas.html" title="CREATE TABLE AS"><code class="command">CREATE TABLE AS</code></a> (Neil)</p><p>这允许临时表在事务提交时被截断或删除。该表缺省的行为是保持到会话结束。</p></li><li class="listitem"><p>添加<code class="literal">INCLUDING CONSTRAINTS</code>到
<a class="link" href="sql-createtable.html" title="CREATE TABLE"><code class="command">CREATE TABLE LIKE</code></a> (Greg Stark)</p><p>这允许容易的拷贝<code class="literal">CHECK</code>约束到一个新表。</p></li><li class="listitem"><p>允许创建占位符（壳）<a class="link" href="sql-createtype.html" title="CREATE TYPE">类型</a> (Martijn van Oosterhout)</p><p>一个壳类型声明创建一个类型名，没有声明该类型的任何细节。
这使得壳类型是有用的，因为它允许更干净的声明类型的输入/输出函数，
它们在该类型被定义为<span class="quote">“<span class="quote">真的</span>”</span>之前必须存在。语法是
<code class="command">CREATE TYPE <em class="replaceable"><code>typename</code></em></code>。</p></li><li class="listitem"><p><a class="link" href="sql-createaggregate.html" title="CREATE AGGREGATE">聚合函数</a>
现在支持多个输入参数 (Sergey Koposov, Tom)</p></li><li class="listitem"><p>添加新的聚合创建<a class="link" href="sql-createaggregate.html" title="CREATE AGGREGATE">语法</a> (Tom)</p><p>新的语法是<code class="command">CREATE AGGREGATE <em class="replaceable"><code>aggname</code></em> 
(<em class="replaceable"><code>input_type</code></em>) (<em class="replaceable"><code>parameter_list</code></em>)</code>。
更自然的支持新的多参数聚合功能。仍然支持以前的语法。</p></li><li class="listitem"><p>添加<a class="link" href="sql-alterrole.html" title="ALTER ROLE"><code class="command">ALTER ROLE PASSWORD NULL</code></a>，
删除以前设置的角色密码 (Peter)</p></li><li class="listitem"><p>为许多对象类型添加<code class="command">DROP</code>对象<code class="literal">IF EXISTS</code> (Andrew)</p><p>这允许<code class="command">DROP</code>操作一个不存在的对象时不会生成错误。</p></li><li class="listitem"><p>添加<a class="link" href="sql-drop-owned.html" title="DROP OWNED"><code class="literal">DROP OWNED</code></a>，
删除一个角色拥有的所有对象 (Alvaro)</p></li><li class="listitem"><p>添加<a class="link" href="sql-reassign-owned.html" title="REASSIGN OWNED"><code class="literal">REASSIGN OWNED</code></a>，
重新分配一个角色拥有的所有对象 (Alvaro)</p><p>这个和上面的<code class="literal">DROP OWNED</code>，帮助删除角色。</p></li><li class="listitem"><p>添加<a class="link" href="sql-grant.html" title="GRANT"><code class="command">GRANT ON SEQUENCE</code></a>语法 (Bruce)</p><p>这是为了设置特定于序列的权限添加的。为了后向兼容，
仍然支持序列的<code class="literal">GRANT ON TABLE</code>。</p></li><li class="listitem"><p>为序列添加<a class="link" href="sql-grant.html" title="GRANT"><code class="literal">USAGE</code></a>权限，
只允许<code class="function">currval()</code>和<code class="function">nextval()</code>，不允许<code class="function">setval()</code> (Bruce)</p><p><code class="literal">USAGE</code>权限允许更精细的控制序列访问。<code class="literal">USAGE</code>
允许用户增加一个序列，但是阻止他们使用<code class="function">setval()</code>
设置该序列为任意值。</p></li><li class="listitem"><p>添加<a class="link" href="sql-altertable.html" title="ALTER TABLE"><code class="literal">ALTER TABLE [ NO ] INHERIT</code></a> (Greg Stark)</p><p>这允许继承动态调整，而不是只在表创建和销毁时。
这在使用继承实现表分区时是非常有价值的。</p></li><li class="listitem"><p>允许在全局对象上的<a class="link" href="sql-comment.html" title="COMMENT">注释</a>全局存储 (Kris Jurka)</p><p>以前，附加到数据库的注释存储在单独的数据库中，使得它们无效，
并且没有规定注释规则或表空间。这个修改添加了一个新的共享目录
<a class="link" href="catalog-pg-shdescription.html" title="51.48. pg_shdescription"><code class="structname">pg_shdescription</code></a>
并在数据库、角色和表空间上存储注释。</p></li></ul></div></div><div class="sect3" id="idp80361440"><div class="titlepage"><div><div><h4 class="title">E.202.3.5. 工具命令的变化</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加选项以允许索引创建时不阻塞并发的写入到表 (Greg Stark, Tom)</p><p>新的语法是<a class="link" href="sql-createindex.html" title="CREATE INDEX"><code class="command">CREATE INDEX CONCURRENTLY</code></a>。
缺省的行为在索引被创建时仍然阻塞表的修改。</p></li><li class="listitem"><p>提供<a class="link" href="functions-admin.html#FUNCTIONS-ADVISORY-LOCKS" title="9.26.10. 咨询锁函数">咨询锁</a>功能 (Abhijit Menon-Sen, Tom)</p><p>这是一个新的锁API，设计来替换曾经在/contrib/userlock中的那个。
userlock代码现在在pgfoundry上。</p></li><li class="listitem"><p>允许<a class="link" href="sql-copy.html" title="COPY"><code class="command">COPY</code></a>转储
<code class="command">SELECT</code>查询 (Zoltan Boszormenyi, Karel Zak)</p><p>这允许<code class="command">COPY</code>转储任意的<acronym class="acronym">SQL</acronym>查询。
语法是<code class="literal">COPY (SELECT ...) TO</code>。</p></li><li class="listitem"><p>让<a class="link" href="sql-copy.html" title="COPY"><code class="command">COPY</code></a>命令返回一个命令标签，
该标签包括拷贝的行数 (Volkan YAZICI)</p></li><li class="listitem"><p>允许<a class="link" href="sql-vacuum.html" title="VACUUM"><code class="command">VACUUM</code></a>终止行，
而不受其他并发<code class="command">VACUUM</code>操作的影响 (Hannu Krossing, Alvaro, Tom)</p></li><li class="listitem"><p>让<a class="link" href="app-initdb.html" title="initdb"><span class="application">initdb</span></a>
检测操作系统环境并相应的设置缺省<code class="varname">DateStyle</code> (Peter)</p><p>这使得安装的<code class="filename">postgresql.conf</code> <code class="varname">DateStyle</code>
值更有可能正是所需要的。</p></li><li class="listitem"><p>减少<span class="application">initdb</span>显示的进展消息的数量 (Tom)</p></li></ul></div></div><div class="sect3" id="idp80379168"><div class="titlepage"><div><div><h4 class="title">E.202.3.6. 日期/时间的变化</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>在<a class="link" href="datatype-datetime.html" title="8.5. 日期/时间类型"><code class="type">timestamp</code></a>
的输入值中允许完整的时区名 (Joachim Wieland)</p><p>例如，<code class="literal">'2006-05-24 21:11 America/New_York'::timestamptz</code>。</p></li><li class="listitem"><p>支持可配置的时区缩写 (Joachim Wieland)</p><p>所需的一组时区缩写可以通过配置参数
<a class="link" href="runtime-config-client.html#GUC-TIMEZONE-ABBREVIATIONS"><code class="varname">timezone_abbreviations</code></a>
选择。</p></li><li class="listitem"><p>添加<a class="link" href="view-pg-timezone-abbrevs.html" title="51.89. pg_timezone_abbrevs"><code class="varname">pg_timezone_abbrevs</code></a>
和<a class="link" href="view-pg-timezone-names.html" title="51.90. pg_timezone_names"><code class="varname">pg_timezone_names</code></a>
视图，显示支持的时区 (Magnus Hagander)</p></li><li class="listitem"><p>添加<a class="link" href="functions-datetime.html#FUNCTIONS-DATETIME-TABLE" title="表 9.30. 日期/时间函数"><code class="function">clock_timestamp()</code></a>、
<a class="link" href="functions-datetime.html#FUNCTIONS-DATETIME-TABLE" title="表 9.30. 日期/时间函数"><code class="function">statement_timestamp()</code></a>
和<a class="link" href="functions-datetime.html#FUNCTIONS-DATETIME-TABLE" title="表 9.30. 日期/时间函数"><code class="function">transaction_timestamp()</code></a>
(Bruce)</p><p><code class="function">clock_timestamp()</code>是当前挂钟的时间，<code class="function">statement_timestamp()</code>
是当前语句到达服务器的时间，<code class="function">transaction_timestamp()</code>
是<code class="function">now()</code>的一个别名。</p></li><li class="listitem"><p>允许<a class="link" href="functions-formatting.html" title="9.8. 数据类型格式化函数"><code class="function">to_char()</code></a>
打印本地化的月和日的名字 (Euler Taveira de Oliveira)</p></li><li class="listitem"><p>允许<a class="link" href="functions-formatting.html" title="9.8. 数据类型格式化函数"><code class="function">to_char(time)</code></a>
和<a class="link" href="functions-formatting.html" title="9.8. 数据类型格式化函数"><code class="function">to_char(interval)</code></a>
输出<acronym class="acronym">AM</acronym>/<acronym class="acronym">PM</acronym>规格 (Bruce)</p><p>间隔和时间是看做24小时周期的，例如<code class="literal">25 hours</code>被认为是<acronym class="acronym">AM</acronym>。</p></li><li class="listitem"><p>添加新的函数<a class="link" href="functions-datetime.html#FUNCTIONS-DATETIME-TABLE" title="表 9.30. 日期/时间函数"><code class="function">justify_interval()</code></a>，
调整间隔单位 (Mark Dilger)</p></li><li class="listitem"><p>允许时区偏移距离GMT达到14:59</p><p>Kiribati使用GMT+14，所以我们最好接受它。</p></li><li class="listitem"><p>间隔计算的改进 (Michael Glaesemann, Bruce)</p></li></ul></div></div><div class="sect3" id="idp80403584"><div class="titlepage"><div><div><h4 class="title">E.202.3.7. 其他数据类型和函数的变化</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>允许数组包含<code class="literal">NULL</code>元素 (Tom)</p></li><li class="listitem"><p>允许分配数组元素与现有的项不连续 (Tom)</p><p>介于中间的数组位置将用null填充。这是符合SQL标准的。</p></li><li class="listitem"><p>为数组子集比较新增内建的<a class="link" href="functions-array.html" title="9.18. 数组函数和操作符">操作符</a>
(<code class="literal">@&gt;</code>、<code class="literal">&lt;@</code>、<code class="literal">&amp;&amp;</code>) (Teodor, Tom)</p><p>这些操作符可以被使用<acronym class="acronym">GiST</acronym>或<acronym class="acronym">GIN</acronym>
索引的许多数据类型索引。</p></li><li class="listitem"><p>在<code class="type">INET</code>/<code class="type">CIDR</code>值上添加方便的算术
<a class="link" href="functions-net.html#CIDR-INET-OPERATORS-TABLE" title="表 9.36. cidr和inet操作符">操作</a> (Stephen R. van den Berg)</p><p>新增的操作符是<code class="literal">&amp;</code> (and)、<code class="literal">|</code> (or)、<code class="literal">~</code> (not)、
<code class="type">inet</code> <code class="literal">+</code> <code class="type">int8</code>、<code class="type">inet</code> <code class="literal">-</code> <code class="type">int8</code>
和<code class="type">inet</code> <code class="literal">-</code> <code class="type">inet</code>。</p></li><li class="listitem"><p>从SQL:2003添加新的<a class="link" href="functions-aggregate.html#FUNCTIONS-AGGREGATE-STATISTICS-TABLE" title="表 9.53. 用于统计的聚集函数">聚合函数</a>
(Neil)</p><p>新增的函数是<code class="function">var_pop()</code>、<code class="function">var_samp()</code>、
<code class="function">stddev_pop()</code>和<code class="function">stddev_samp()</code>。<code class="function">var_samp()</code>
和<code class="function">stddev_samp()</code>只是重命名现有的聚合<code class="function">variance()</code>
和<code class="function">stddev()</code>。后者的名字为了后向兼容仍然可用。</p></li><li class="listitem"><p>添加SQL:2003统计<a class="link" href="functions-aggregate.html#FUNCTIONS-AGGREGATE-STATISTICS-TABLE" title="表 9.53. 用于统计的聚集函数">聚合</a> 
(Sergey Koposov)</p><p>新增函数：<code class="function">regr_intercept()</code>、<code class="function">regr_slope()</code>、
<code class="function">regr_r2()</code>、<code class="function">corr()</code>、<code class="function">covar_samp()</code>、
<code class="function">covar_pop()</code>、<code class="function">regr_avgx()</code>、<code class="function">regr_avgy()</code>、
<code class="function">regr_sxy()</code>、<code class="function">regr_sxx()</code>、<code class="function">regr_syy()</code>、
<code class="function">regr_count()</code>。</p></li><li class="listitem"><p>允许<a class="link" href="sql-createdomain.html" title="CREATE DOMAIN">domains</a>基于其他的域 (Tom)</p></li><li class="listitem"><p>适当的加强域的<a class="link" href="ddl-constraints.html" title="5.3. 约束"><code class="literal">CHECK</code></a>约束 (Neil, Tom)</p><p>例如，声明返回域类型的用户定义函数的结果现在检查该域的约束。
这关闭了域实现中的一个重大漏洞。</p></li><li class="listitem"><p>修复转储重命名的<a class="link" href="datatype-numeric.html#DATATYPE-SERIAL" title="8.1.4. 序数类型"><code class="type">SERIAL</code></a>
字段的问题 (Tom)</p><p>该修复是通过明确的指定序列的<code class="literal">DEFAULT</code>和序列元素转储一个
<code class="type">SERIAL</code>，并且在重新加载时使用一个新的
<a class="link" href="sql-altersequence.html" title="ALTER SEQUENCE"><code class="command">ALTER SEQUENCE OWNED BY</code></a>
命令重新构造该<code class="type">SERIAL</code>的字段。这也允许删除一个<code class="type">SERIAL</code>字段声明。</p></li><li class="listitem"><p>添加一个服务器端休眠函数
<a class="link" href="functions-datetime.html#FUNCTIONS-DATETIME-DELAY" title="9.9.5. 延时执行"><code class="function">pg_sleep()</code></a>(Joachim Wieland)</p></li><li class="listitem"><p>为<a class="link" href="datatype-oid.html" title="8.18. 对象标识符类型"><code class="type">tid</code></a> (tuple id)
数据类型添加所有比较操作符 (Mark Kirkwood, Greg Stark, Tom)</p></li></ul></div></div><div class="sect3" id="idp80449104"><div class="titlepage"><div><div><h4 class="title">E.202.3.8. PL/pgSQL服务器端语言的变化</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加<code class="literal">TG_table_name</code>和<code class="literal">TG_table_schema</code>
到触发器参数 (Andrew)</p><p><code class="literal">TG_relname</code>现在已经废弃了。也为其他PL在触发器参数中做了类型的变化。</p></li><li class="listitem"><p>允许<code class="literal">FOR</code>语句返回标量值、记录和行类型 (Pavel Stehule)</p></li><li class="listitem"><p>添加一个<code class="literal">BY</code>子句到<code class="literal">FOR</code>循环，控制迭代增量 (Jaime Casanova)</p></li><li class="listitem"><p>添加<code class="literal">STRICT</code>到
<a class="link" href="plpgsql-statements.html#PLPGSQL-STATEMENTS-SQL-ONEROW" title="42.5.3. 执行一个有单一行结果的查询"><code class="command">SELECT INTO</code></a> (Matt Miller)</p><p>为了<span class="productname">Oracle PL/SQL</span>兼容性，如果多于或少于一行被<code class="command">SELECT</code>返回，
则<code class="literal">STRICT</code>模式抛出一个异常。</p></li></ul></div></div><div class="sect3" id="idp80460352"><div class="titlepage"><div><div><h4 class="title">E.202.3.9. PL/Perl服务器端语言的变化</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加<code class="literal">table_name</code>和<code class="literal">table_schema</code>到触发器参数 (Adam Sjøgren)</p></li><li class="listitem"><p>添加预备查询 (Dmitry Karasik)</p></li><li class="listitem"><p>让<code class="literal">$_TD</code>触发一个全局变量的数据 (Andrew)</p><p>在以前，这是一个词汇，引起意外的分享违规行为。</p></li><li class="listitem"><p>为了安全起见，在单独的解释器中运行PL/Perl和PL/PerlU (Andrew)</p><p>在序列中，它们再也不能分享数据和加载模块。另外，
如果Perl没有用必要的标识编译以允许多个解释器，那么在任何给出的后端进程中，
只可以使用这些语言中的一种。</p></li></ul></div></div><div class="sect3" id="idp80465632"><div class="titlepage"><div><div><h4 class="title">E.202.3.10. PL/Python服务器端语言的变化</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>命名的参数是作为普通变量传送的，和在<code class="literal">args[]</code>数组中一样 (Sven Suursoho)</p></li><li class="listitem"><p>添加<code class="literal">table_name</code>和<code class="literal">table_schema</code>到触发器参数 (Andrew)</p></li><li class="listitem"><p>允许返回复合类型和结果集 (Sven Suursoho)</p></li><li class="listitem"><p>作为<code class="literal">list</code>、<code class="literal">iterator</code>或<code class="literal">generator </code>
返回结果集 (Sven Suursoho)</p></li><li class="listitem"><p>允许函数返回<code class="literal">void</code> (Neil)</p></li><li class="listitem"><p>现在支持Python 2.5了 (Tom)</p></li></ul></div></div><div class="sect3" id="idp80474352"><div class="titlepage"><div><div><h4 class="title">E.202.3.11. <a class="link" href="app-psql.html" title="psql"><span class="application">psql</span></a> 的变化</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加新的命令<code class="literal">\password</code>，用客户端侧的口令加密修改角色口令 (Peter)</p></li><li class="listitem"><p>允许<code class="literal">\c</code>连接到一个新的主机和端口号 (David, Volkan YAZICI)</p></li><li class="listitem"><p>添加表空间显示到<code class="literal">\l+</code> (Philip Yarra)</p></li><li class="listitem"><p>改善<code class="literal">\df</code>斜线命令，包含函数的参数名和模式
(<code class="literal">OUT</code>或<code class="literal">INOUT</code>) (David Fetter)</p></li><li class="listitem"><p>支持二进制<code class="command">COPY</code> (Andreas Pflug)</p></li><li class="listitem"><p>添加选项在一个事务中运行整个会话 (Simon)</p><p>使用选项<code class="literal">-1</code>或<code class="literal">--single-transaction</code>。</p></li><li class="listitem"><p>支持使用一个游标按批次的自动检索<code class="command">SELECT</code>结果 (Chris Mair)</p><p>这是使用<code class="command">\set FETCH_COUNT <em class="replaceable"><code>n</code></em></code>启用的。
这个特性允许在<span class="application">psql</span>中检索大的结果集，
而不用尝试在内存中缓存整个结果集。</p></li><li class="listitem"><p>让多行值对齐在适当的字段内 (Martijn van Oosterhout)</p><p>包含换行符的字段值现在以更可读的方式显示。</p></li><li class="listitem"><p>多行语句保存为一个条目，而不是一次一行 (Sergey E. Koposov)</p><p>这使得向上箭头调回查询更加简单。（在Windows上是不可用的，
因为该平台使用操作系统中的本地命令行编辑。）</p></li><li class="listitem"><p>让行计数器是64位的，这样它可以处理行数超过二十亿的文件 (David Fetter)</p></li><li class="listitem"><p>为<code class="command">INSERT</code>/<code class="command">UPDATE</code>/<code class="command">DELETE RETURNING</code>
报告返回的数据库和命令状态标签 (Tom)</p></li></ul></div></div><div class="sect3" id="idp80493152"><div class="titlepage"><div><div><h4 class="title">E.202.3.12. <a class="link" href="app-pgdump.html" title="pg_dump"><span class="application">pg_dump</span></a> 的变化</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>允许对象的综合选择被<span class="application">pg_dump</span>包括或排除 (Greg Sabino Mullane)</p><p><span class="application">pg_dump</span>现在支持多个<code class="literal">-n</code>（模式）和<code class="literal">-t</code>
（表）选项，并且添加了<code class="literal">-N</code>和<code class="literal">-T</code>选项排除对象。
另外，这些开关的参数现在可以是通配符表达式，而不是单个对象名，
例如<code class="literal">-t 'foo*'</code>，并且一个模式可以是<code class="literal">-t</code>或<code class="literal">-T</code>
开关的一部分，比如<code class="literal">-t schema1.table1</code>。</p></li><li class="listitem"><p>添加<a class="link" href="app-pgrestore.html" title="pg_restore"><span class="application">pg_restore</span></a> 
<code class="literal">--no-data-for-failed-tables</code>选项，如果表创建失败则阻止加载数据
（也就是，该表早已存在） (Martin Pitt)</p></li><li class="listitem"><p>添加<a class="link" href="app-pgrestore.html" title="pg_restore"><span class="application">pg_restore</span></a>选项，
在单个事务中运行整个会话 (Simon)</p><p>使用选项<code class="literal">-1</code>或<code class="literal">--single-transaction</code>。</p></li></ul></div></div><div class="sect3" id="idp80508384"><div class="titlepage"><div><div><h4 class="title">E.202.3.13. <a class="link" href="libpq.html" title="第 33 章 libpq - C 库"><span class="application">libpq</span></a> 的变化</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加<a class="link" href="libpq-misc.html" title="33.11. 杂项函数"><code class="function">PQencryptPassword()</code></a>，
用来加密口令 (Tom)</p><p>这允许口令对于像<a class="link" href="sql-alterrole.html" title="ALTER ROLE"><code class="command">ALTER ROLE ... PASSWORD</code></a>
这样的命令是预先加密发送的。</p></li><li class="listitem"><p>添加函数<a class="link" href="libpq-threading.html" title="33.19. 在线程化程序中的行为"><code class="function">PQisthreadsafe()</code></a> (Bruce)</p><p>这允许应用查询该库的线程安装状态。</p></li><li class="listitem"><p>添加<a class="link" href="libpq-exec.html#LIBPQ-EXEC-MAIN" title="33.3.1. 主要函数"><code class="function">PQdescribePrepared()</code></a>、
<a class="link" href="libpq-exec.html#LIBPQ-EXEC-MAIN" title="33.3.1. 主要函数"><code class="function">PQdescribePortal()</code></a>
和相关的函数返回关于以前预备好的语句和打开的游标的信息 (Volkan YAZICI)</p></li><li class="listitem"><p>允许<a class="link" href="libpq-ldap.html" title="33.17. 连接参数的 LDAP 查找"><acronym class="acronym">LDAP</acronym></a>从
<a class="link" href="libpq-pgservice.html" title="33.16. 连接服务文件"><code class="filename">pg_service.conf</code></a>
中查找 (Laurenz Albe)</p></li><li class="listitem"><p>允许<a class="link" href="libpq-pgpass.html" title="33.15. 口令文件"><code class="filename">~/.pgpass</code></a>
中的主机名匹配缺省的套接字目录 (Bruce)</p><p>一个空的主机名继续匹配任何Unix套接字连接，
但是这个添加允许记录特定于机器上的几个主进程之一。</p></li></ul></div></div><div class="sect3" id="idp80523216"><div class="titlepage"><div><div><h4 class="title">E.202.3.14. <a class="link" href="ecpg.html" title="第 35 章 ECPG - C 中的嵌入式 SQL"><span class="application">ecpg</span></a> 的变化</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>允许<a class="link" href="sql-show.html" title="SHOW"><code class="command">SHOW</code></a>将它的结果放入一个变量中
(Joachim Wieland)</p></li><li class="listitem"><p>添加<a class="link" href="sql-copy.html" title="COPY"><code class="command">COPY TO STDOUT</code></a> (Joachim Wieland)</p></li><li class="listitem"><p>添加回归测试 (Joachim Wieland, Michael)</p></li><li class="listitem"><p>主要源代码清理 (Joachim Wieland, Michael)</p></li></ul></div></div><div class="sect3" id="idp80529056"><div class="titlepage"><div><div><h4 class="title">E.202.3.15. <span class="application">Windows</span> 端口</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>允许<acronym class="acronym">MSVC</acronym>编译<span class="productname">PostgreSQL</span>服务器 (Magnus, Hiroshi Saito)</p></li><li class="listitem"><p>为实用命令和<a class="link" href="app-pgdump.html" title="pg_dump"><span class="application">pg_dump</span></a>
添加<acronym class="acronym">MSVC</acronym>支持 (Hiroshi Saito)</p></li><li class="listitem"><p>为Windows代码页<code class="literal">1253</code>、<code class="literal">1254</code>、<code class="literal">1255</code>和
<code class="literal">1257</code>添加支持 (Kris Jurka)</p></li><li class="listitem"><p>在启动时删除权限，这样服务器可以从一个管理员账号启动 (Magnus)</p></li><li class="listitem"><p>稳定性修复 (Qingqing Zhou, Magnus)</p></li><li class="listitem"><p>添加本地信号灯实现 (Qingqing Zhou)</p><p>以前的代码模仿SysV信号灯。</p></li></ul></div></div><div class="sect3" id="idp80538832"><div class="titlepage"><div><div><h4 class="title">E.202.3.16. 源代码的变化</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加<a class="link" href="gin.html" title="第 64 章 GIN 索引"><acronym class="acronym">GIN</acronym></a> (Generalized Inverted iNdex)
索引访问方法 (Teodor, Oleg)</p></li><li class="listitem"><p>删除R-tree索引 (Tom)</p><p>Rtree已经使用<a class="link" href="gist.html" title="第 62 章 GiST 索引"><acronym class="acronym">GiST</acronym></a>重新实现了。
在其他差异中，这意味着rtree索引现在支持通过预写式日志(WAL)崩溃恢复。</p></li><li class="listitem"><p>减少库不必要的连接到后端 (Martijn van Oosterhout, Tom)</p></li><li class="listitem"><p>添加一个配置标志，允许libedit优先于<acronym class="acronym">GNU</acronym> readline (Bruce)</p><p>使用配置<a class="link" href="install-procedure.html#CONFIGURE" title="配置"><code class="literal">--with-libedit-preferred</code></a>。</p></li><li class="listitem"><p>允许安装到包含空格的目录 (Peter)</p></li><li class="listitem"><p>提高重新定位安装目录的能力 (Tom)</p></li><li class="listitem"><p>为使用<span class="productname">Solaris</span>编译器的<span class="productname">Solaris x86_64</span>
添加支持 (Pierre Girard, Theo Schlossnagle, Bruce)</p></li><li class="listitem"><p>添加<span class="application">DTrace</span>支持 (Robert Lor)</p></li><li class="listitem"><p>添加<code class="literal">PG_VERSION_NUM</code>，供想要使用&gt;和&lt;
比较测试后端C语言版本第三方应用程序使用 (Bruce)</p></li><li class="listitem"><p>添加<code class="literal">XLOG_BLCKSZ</code>，独立于<code class="literal">BLCKSZ</code> (Mark Wong)</p></li><li class="listitem"><p>添加<code class="literal">LWLOCK_STATS</code>定义，报告锁定活动 (Tom)</p></li><li class="listitem"><p>为未知的<span class="application">configure</span>选项发出警告 (Martijn van Oosterhout)</p></li><li class="listitem"><p>为<span class="quote">“<span class="quote">plugin</span>”</span>库添加服务器支持，可以用于附加任务，比如调试和性能测量 (Korry Douglas)</p><p>这由两个功能组成：一个允许单独加载的共享库沟通的<span class="quote">“<span class="quote">会合变量</span>”</span>的表，
和一个允许库被加载到特定会话而不明确与客户端应用合作的新的配置参数
<a class="link" href="runtime-config-client.html#GUC-LOCAL-PRELOAD-LIBRARIES"><code class="varname">local_preload_libraries</code></a>。
这允许外部插件实现像PL/pgSQL调试器这样的特性。</p></li><li class="listitem"><p>重命名现有的配置参数<code class="varname">preload_libraries</code>为
<a class="link" href="runtime-config-client.html#GUC-SHARED-PRELOAD-LIBRARIES"><code class="varname">shared_preload_libraries</code></a>
(Tom)</p><p>这样做是为了清楚的和<code class="varname">local_preload_libraries</code>比较。</p></li><li class="listitem"><p>添加新的配置参数<a class="link" href="runtime-config-preset.html#GUC-SERVER-VERSION-NUM"><code class="varname">server_version_num</code></a>
(Greg Sabino Mullane)</p><p>这类似于<code class="varname">server_version</code>，但是这是一个整数，例如<code class="literal">80200</code>。
这允许应用更容易的做版本检查。</p></li><li class="listitem"><p>添加配置参数<a class="link" href="runtime-config-query.html#GUC-SEQ-PAGE-COST"><code class="varname">seq_page_cost</code></a> (Tom)</p></li><li class="listitem"><p>重新实现<a class="link" href="regress.html" title="第 32 章 回归测试">回归测试</a>脚本为C程序 (Magnus, Tom)</p></li><li class="listitem"><p>允许可加载的模块分配共享内存和轻量级锁 (Marc Munro)</p></li><li class="listitem"><p>添加动态加载库的自动初始化和终结 (Ralf Engelschall, Tom)</p><p>如果库定义了这样的符号，则新增的<a class="link" href="xfunc-c.html#XFUNC-C-DYNLOAD" title="37.9.1. 动态载入">函数</a>
<code class="function">_PG_init()</code>和<code class="function">_PG_fini()</code>被调用。
因此我们不再需要在<code class="varname">shared_preload_libraries</code>
中指定一个初始化函数；我们可以假设库使用了<code class="function">_PG_init()</code>约定。</p></li><li class="listitem"><p>添加<a class="link" href="xfunc-c.html#XFUNC-C-DYNLOAD" title="37.9.1. 动态载入"><code class="literal">PG_MODULE_MAGIC</code></a>
标题块到所有共享的对象文件 (Martijn van Oosterhout)</p><p>该魔法模块阻止可加载对象文件和服务器间的版本错误匹配。</p></li><li class="listitem"><p>为AIX添加共享的库支持 (Laurenz Albe)</p></li><li class="listitem"><p>新增<a class="link" href="datatype-xml.html" title="8.13. XML类型"><acronym class="acronym">XML</acronym></a>文档章节 (Bruce)</p></li></ul></div></div><div class="sect3" id="idp80574736"><div class="titlepage"><div><div><h4 class="title">E.202.3.17. 贡献包的变化</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>主要tsearch2的改进 (Oleg, Teodor)</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>多字节编码支持，包括<acronym class="acronym">UTF8</acronym></p></li><li class="listitem"><p>查询重写的支持</p></li><li class="listitem"><p>改进排序功能</p></li><li class="listitem"><p>同义词字典支持</p></li><li class="listitem"><p>Ispell字典现在识别<span class="application">MySpell</span>格式，<span class="application">OpenOffice</span>使用它。</p></li><li class="listitem"><p><acronym class="acronym">GIN</acronym>支持</p></li></ul></div></li><li class="listitem"><p>添加包含<span class="application">Pgadmin</span>管理功能的adminpack模块 (Dave)</p><p>这些函数提供了没有在缺省的<span class="productname">PostgreSQL</span>
服务器中出现的额外的文件系统访问例程。</p></li><li class="listitem"><p>添加sslinfo模块 (Victor Wagner)</p><p>报告当前连接的<acronym class="acronym">SSL</acronym>证书的信息。</p></li><li class="listitem"><p>添加pgrowlocks模块 (Tatsuo)</p><p>这为特定的表显示了行锁信息。</p></li><li class="listitem"><p>添加hstore模块 (Oleg, Teodor)</p></li><li class="listitem"><p>添加isn模块，替换isbn_issn (Jeremy Kronuz)</p><p>这个新的实现支持<acronym class="acronym">EAN13</acronym>、<acronym class="acronym">UPC</acronym>、
<acronym class="acronym">ISBN</acronym> (books)、<acronym class="acronym">ISMN</acronym> (music)和<acronym class="acronym">ISSN</acronym> (serials)。</p></li><li class="listitem"><p>添加索引信息函数到pgstattuple (ITAGAKI Takahiro, Satoshi Nagayasu)</p></li><li class="listitem"><p>添加pg_freespacemap模块，显示自由空间映射信息 (Mark Kirkwood)</p></li><li class="listitem"><p>pgcrypto现在拥有所有计划的功能 (Marko Kreen)</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>在pgcrypto中包含iMath库，让公共秘钥加密函数总是可用。</p></li><li class="listitem"><p>添加在OpenBSD代码中丢失的SHA224算法。</p></li><li class="listitem"><p>在老的OpenSSL上为SHA224/256/384/512哈希激活内建代码，让这些算法总是可用。</p></li><li class="listitem"><p>新增函数gen_random_bytes()，返回密码强壮的随机性。对于生成加密秘钥是有用的。</p></li><li class="listitem"><p>删除digest_exists()、hmac_exists()和cipher_exists()函数。</p></li></ul></div></li><li class="listitem"><p>改进多维数据集模块 (Joshua Reich)</p><p>新增的函数是<code class="function">cube(float[])</code>、<code class="function">cube(float[], float[])</code>和
<code class="function">cube_subset(cube, int4[])</code>。</p></li><li class="listitem"><p>添加异步查询能力到dblink (Kai Londenberg, Joe Conway)</p></li><li class="listitem"><p>为数组子集比较新增操作符(<code class="literal">@&gt;</code>、
<code class="literal">&lt;@</code>、<code class="literal">&amp;&amp;</code>) (Tom)</p><p>各种贡献包已经为它们的数据类型有了这些操作符，但是命名并不一致。
我们现在添加了一致命名的数组子集比较操作符到内核代码和所有拥有这样功能的贡献包。
（老的名字保留有效，但是已经废弃了。）</p></li><li class="listitem"><p>为所有拥有安装脚本的贡献包添加卸载脚本 (David, Josh Drake)</p></li></ul></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-8-2-1.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="release.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="release-8-1-23.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">E.201. 版本 8.2.1 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> E.203. 版本 8.1.23</td></tr></table></div></body></html>
