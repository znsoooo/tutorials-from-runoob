<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>E.131. 版本 9.0</title><link rel="stylesheet" type="text/css" href="../../0/stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="release-9-0-1.html" title="E.130. 版本 9.0.1" /><link rel="next" href="release-8-4-22.html" title="E.132. 版本 8.4.22" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">E.131. 版本 9.0</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="release-9-0-1.html" title="E.130. 版本 9.0.1">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="release.html" title="附录 E. 版本说明">上一级</a></td><th width="60%" align="center">附录 E. 版本说明</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.1 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="release-8-4-22.html" title="E.132. 版本 8.4.22">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="RELEASE-9-0"><div class="titlepage"><div><div><h2 class="title" style="clear: both">E.131. 版本 9.0</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="release-9-0.html#idp75560160">E.131.1. 概述</a></span></dt><dt><span class="sect2"><a href="release-9-0.html#idp75593104">E.131.2. 迁移到版本 9.0</a></span></dt><dt><span class="sect2"><a href="release-9-0.html#idp75648224">E.131.3. 修改列表</a></span></dt></dl></div><p><strong>发布日期：. </strong>2010-09-20</p><div class="sect2" id="idp75560160"><div class="titlepage"><div><div><h3 class="title">E.131.1. 概述</h3></div></div></div><p>这个<span class="productname">PostgreSQL</span>版本添加了请求多年的特性，例如易于使用的复制，
大规模权限改变设施，和匿名代码块。而以前的主版本在这些范围是保守的，
这个版本显示了一个大胆的新的渴望提供的设施，新的和现有的<span class="productname">PostgreSQL</span>
用户将包含在内。这些都做到了，只是有少许的不兼容。主要的增强功能包括：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>内建复制基于日志传送。这个发展包括两个特点：流复制，允许持续归档(<acronym class="acronym">WAL</acronym>)
文件，在网络连接上流出到备用服务器；热备份，允许持续归档备用服务器以执行只读的查询。
有效效应是支持一个主服务器带有多个只读从服务器。</p></li><li class="listitem"><p>更简单的数据库对象权限管理。<a class="link" href="sql-grant.html" title="GRANT"><code class="command">GRANT</code>/<code class="command">REVOKE IN 
SCHEMA</code></a>支持在现有的对象上的大量的权限更改，而
<a class="link" href="sql-alterdefaultprivileges.html" title="ALTER DEFAULT PRIVILEGES"><code class="command">ALTER DEFAULT 
PRIVILEGES</code></a>允许控制将来创建的对象的权限。
大对象（BLOBs）现在也支持权限管理。</p></li><li class="listitem"><p>明显提高存储过程支持。<a class="link" href="sql-do.html" title="DO"><code class="command">DO</code></a>
语句支持ad-hoc或<span class="quote">“<span class="quote">anonymous</span>”</span>代码块。函数现在可以用命名的参数来调用。
<a class="link" href="plpgsql.html" title="第 42 章 PL/pgSQL - SQL过程语言">PL/pgSQL</a>现在是缺省安装的，
<a class="link" href="plperl.html" title="第 44 章 PL/Perl - Perl 过程语言">PL/Perl</a>和<a class="link" href="plpython.html" title="第 45 章 PL/Python - Python 过程语言">PL/Python</a>
已经从几个方面增强了，包括对Python3的支持。</p></li><li class="listitem"><p>全面支持<a class="link" href="install-windows.html" title="第 17 章 在Windows上从源代码安装">64位<span class="productname">Windows</span></a></p></li><li class="listitem"><p>更高级的报告查询，包括附加的窗口选项(<code class="literal">PRECEDING</code>和<code class="literal">FOLLOWING</code>)
和控制值以什么顺序供应给聚合函数的能力。</p></li><li class="listitem"><p>新增触发特征，包括SQL标准兼容<a class="link" href="sql-createtrigger.html" title="CREATE TRIGGER">每字段触发器</a>
和条件触发器执行。</p></li><li class="listitem"><p><a class="link" href="sql-createtable.html#SQL-CREATETABLE-COMPATIBILITY" title="兼容性">可延期的唯一约束</a>。
大量的更新到唯一键现在不带有欺骗是可能的了。</p></li><li class="listitem"><p><a class="link" href="ddl-constraints.html#DDL-CONSTRAINTS-EXCLUSION" title="5.3.6. 排他约束">排除约束</a>。
这些提供了一个唯一约束的广义版本，允许执行复杂的条件。</p></li><li class="listitem"><p>新增和加强的安全特性，包括RADIUS认证，LDAP认证改进，和一个新的贡献模块
<a class="link" href="passwordcheck.html" title="F.24. passwordcheck"><code class="filename">passwordcheck</code></a>测试密码强度。</p></li><li class="listitem"><p>新增高性能实现<a class="link" href="sql-listen.html" title="LISTEN"><code class="command">LISTEN</code></a>/
<a class="link" href="sql-notify.html" title="NOTIFY"><code class="command">NOTIFY</code></a>特性。
等待发生的事件现在存储在一个基于内存的队列中，而不是一个表中。
还有，<span class="quote">“<span class="quote">payload</span>”</span>字符串可以被每个事件发送，而不是和以前一样只能是一个事件名传送。</p></li><li class="listitem"><p>新增<a class="link" href="sql-vacuum.html" title="VACUUM"><code class="command">VACUUM FULL</code></a>的实现。
这个命令现在改写全部的表和索引，而不是移动个别的行到紧密空间。
它实质上在大多数情况下更快，并且不再导致索引膨胀。</p></li><li class="listitem"><p>新增贡献模块<a class="link" href="pgupgrade.html" title="pg_upgrade"><code class="filename">pg_upgrade</code></a>，
支持从8.3或8.4到9.0的就地升级。</p></li><li class="listitem"><p>对于特定类型的查询的多种性能增强，包括删除不需要的连接。
这帮助优化了一些自动生成的查询，比如由对象关系映射（ORMs）产生的那些。</p></li><li class="listitem"><p><a class="link" href="sql-explain.html" title="EXPLAIN"><code class="command">EXPLAIN</code></a>增强。
该输出现在可以用在JSON, XML, 或YAML格式中，
并且包括缓冲区利用和以前不可用的其他数据。</p></li><li class="listitem"><p><a class="link" href="hstore.html" title="F.17. hstore"><code class="filename">hstore</code></a>增强，包括新功能和更大的数据容量。</p></li></ul></div><p>以上的条目在下面的章节中有更详细的介绍。</p></div><div class="sect2" id="idp75593104"><div class="titlepage"><div><div><h3 class="title">E.131.2. 迁移到版本 9.0</h3></div></div></div><p>使用<span class="application">pg_dump</span>或使用<span class="application">pg_upgrade</span>
的转储/恢复，对于那些想要从任何以前的版本迁移数据的人来说是必须的。</p><p>版本9.0包含若干有选择的突破向后兼容的改变，为了支持新特性和编码质量改善。
特别的，使得PL/pgSQL、Point-In-Time Recovery (PITR)、或Warm Standby广泛应用的用户，
应该测试他们的应用，因为在这些地方有轻微的用户可见的改变。
观察下面的不兼容：</p><div class="sect3" id="idp75596368"><div class="titlepage"><div><div><h4 class="title">E.131.2.1. 服务器设置</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>删除服务器参数<code class="varname">add_missing_from</code>，该参数缺省为off已经很多年了 (Tom Lane)</p></li><li class="listitem"><p>删除服务器参数<code class="varname">regex_flavor</code>，该参数缺省为
<a class="link" href="functions-matching.html#POSIX-SYNTAX-DETAILS" title="9.7.3.1. 正则表达式细节"><code class="literal">advanced</code></a>已经很多年了 (Tom Lane)</p></li><li class="listitem"><p><a class="link" href="runtime-config-wal.html#GUC-ARCHIVE-MODE"><code class="varname">archive_mode</code></a>
现在只影响<a class="link" href="runtime-config-wal.html#GUC-ARCHIVE-COMMAND"><code class="varname">archive_command</code></a>；
一个新的设置，<a class="link" href="runtime-config-wal.html#GUC-WAL-LEVEL"><code class="varname">wal_level</code></a>，
影响预写式日志的内容 (Heikki Linnakangas)</p></li><li class="listitem"><p><a class="link" href="runtime-config-logging.html#GUC-LOG-TEMP-FILES"><code class="varname">log_temp_files</code></a>
现在使用缺省文件尺寸单位kilobytes (Robert Haas)</p></li></ul></div></div><div class="sect3" id="idp75604448"><div class="titlepage"><div><div><h4 class="title">E.131.2.2. 查询</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>当查询一个<a class="link" href="ddl-inherit.html" title="5.9. 继承">parent table</a>时，
不要在作为查询一部分扫描的子表上做任何单独的权限检查 (Peter Eisentraut)</p><p>SQL标准声明这个行为，并且它在实际上比以前在每个子表上和父表一样检查权限的行为更加方便。</p></li></ul></div></div><div class="sect3" id="idp75606864"><div class="titlepage"><div><div><h4 class="title">E.131.2.3. 数据类型</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="datatype-binary.html" title="8.4. 二进制数据类型"><code class="type">bytea</code></a>输出现在缺省以十六进制格式显示 (Peter Eisentraut)</p><p>服务器参数<a class="link" href="runtime-config-client.html#GUC-BYTEA-OUTPUT"><code class="varname">bytea_output</code></a>
可以用来选择传统的输出格式，如果为了兼容需要。</p></li><li class="listitem"><p>数组输入现在只考虑纯ASCII空白字符潜在的忽略；它将永不忽略非ASCII字符，
即使它们根据某些语言环境是空白 (Tom Lane)</p><p>这避免了根据服务器本地设置，数组值会被不同的解释的某些极端情况。</p></li><li class="listitem"><p>改善标准兼容<a class="link" href="functions-matching.html#FUNCTIONS-SIMILARTO-REGEXP" title="9.7.2. SIMILAR TO正则表达式"><code class="literal">SIMILAR TO</code></a>
模式和SQL风格<code class="function">substring()</code>模式 (Tom Lane)</p><p>这包括将<code class="literal">?</code>和<code class="literal">{...}</code>处理为模式元字符，
而它们以前只是简单的文字字符；这相当于在SQL:2008中添加的新特性。
还有，<code class="literal">^</code>和<code class="literal">$</code>现在视为简单的文字字符；
以前它们视为元字符，好像模式遵从POSIX而不是SQL规则。
还有，SQL标准的<code class="function">substring()</code>，使用圆括号以嵌套，
不再干扰子字符串的捕获。还有，括号表达式（字符类）的处理现在更加标准兼容了。</p></li><li class="listitem"><p>根据SQL标准，在为位字符串的3参数<a class="link" href="functions-string.html#FUNCTIONS-STRING-SQL" title="表 9.8. SQL字符串函数和操作符"><code class="function">substring()</code></a>
中拒绝负的长度值 (Tom Lane)</p></li><li class="listitem"><p>当减少分数秒精度时使<code class="function">date_trunc</code>截断而不是圆整 (Tom Lane)</p><p>代码对于基于整型的日期/时间总是这样动作。现在基于浮点数的日期/时间行为相似。</p></li></ul></div></div><div class="sect3" id="idp75620832"><div class="titlepage"><div><div><h4 class="title">E.131.2.4. 对象重命名</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>当一个子表从多个无关的父表中继承相同的字段时，在<code class="command">RENAME</code>
期间严格执行字段名的一致性 (KaiGai Kohei)</p></li><li class="listitem"><p>当基础表字段重命名时不再自动重命名索引和索引字段 (Tom Lane)</p><p>超级管理员仍然可以手动重命名这样的索引和字段。这个改变将需要更新JDBC驱动，
和可能的其他驱动，以便唯一索引在重命名之后正确的重组。</p></li><li class="listitem"><p><code class="command">CREATE OR REPLACE FUNCTION</code>可以不再改变函数参数声明的名字 (Pavel Stehule)</p><p>为了避免在命名的参数调用中创建歧义，不再允许在一个现有函数的声明中改变输入参数的别名
（尽管名字仍然可以分配给以前未命名的参数）。要那样做，你现在必须<code class="command">DROP</code>
并重新创建该函数。</p></li></ul></div></div><div class="sect3" id="idp75625920"><div class="titlepage"><div><div><h4 class="title">E.131.2.5. PL/pgSQL</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>如果变量名与查询中使用的字段名冲突，PL/pgSQL现在抛出一个错误 (Tom Lane)</p><p>以前的行为是绑定歧义名为PL/pgSQL变量优先于查询字段，这经常导致令人吃惊的错误行为。
抛出一个错误允许简单的检测引起歧义的情景。虽然建议函数遇到这种类型的错误时修改为移除该冲突，
但是如果需要，旧的行为可以被修复，通过配置参数<a class="link" href="plpgsql-implementation.html#PLPGSQL-VAR-SUBST" title="42.10.1. 变量替换"><code class="varname">plpgsql.variable_conflict</code></a>，
或通过每个函数的选项<code class="literal">#variable_conflict</code>。</p></li><li class="listitem"><p>PL/pgSQL不再允许匹配特定SQL保留字的变量名 (Tom Lane)</p><p>这是校正PL/pgSQL分析器更密切的匹配内核SQL分析器的一个后果。如果需要，
变量名可以用双引号引起来以避免这种限制。</p></li><li class="listitem"><p>PL/pgSQL现在要求复合结果的字段和基础类型一样匹配预期的类型修饰符 (Pavel Stehule, Tom Lane)</p><p>例如，如果结果类型的字段声明为<code class="literal">NUMERIC(30,2)</code>，那么它不再适用于在该字段中返回一个
其他精度的<code class="literal">NUMERIC</code>。以前的版本忽略了检查类型修饰符，
并且因此允许结果行实际上并不符合声明的限制。</p></li><li class="listitem"><p>PL/pgSQL现在对待选择到复合字段更加一致 (Tom Lane)</p><p>以前，像<code class="literal">SELECT ... INTO <em class="replaceable"><code>rec</code></em>.<em class="replaceable"><code>fld</code></em> FROM ...</code>
这样的声明被当做是标量赋值，即使记录字段<em class="replaceable"><code>fld</code></em>是复合类型。
现在，它被当做记录赋值，当<code class="literal">INTO</code>目标是一个复合类型的规则变量时也是一样的。
所以被赋予到字段的子字段的值应该被写为<code class="command">SELECT</code>列表的单独的列，
不是在以前版本中<code class="literal">ROW(...)</code>构造那样。</p><p>如果你需要一个在9.0和以前版本中都能运行的方式来做这点，你可以像这样来写：
<code class="literal"><em class="replaceable"><code>rec</code></em>.<em class="replaceable"><code>fld</code></em> := ROW(...) FROM ...</code>。</p></li><li class="listitem"><p>删除PL/pgSQL的<code class="literal">RENAME</code>声明 (Tom Lane)</p><p>取代<code class="literal">RENAME</code>，使用<a class="link" href="plpgsql-declarations.html#PLPGSQL-DECLARATION-ALIAS" title="42.3.2. ALIAS"><code class="literal">ALIAS</code></a>，
现在可以为任意变量创建一个别名，不只是和以前一样的美元符号参数名称(如<code class="literal">$1</code>)。</p></li></ul></div></div><div class="sect3" id="idp75644528"><div class="titlepage"><div><div><h4 class="title">E.131.2.6. 其他的不兼容</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>不赞成使用<code class="literal">=&gt;</code>作为一个操作符名称 (Robert Haas)</p><p>将来版本的<span class="productname">PostgreSQL</span>可能完全拒绝这种操作符名，
为了支持命名函数参数的SQL标准符号。目前，仍然是允许的，
但是定义这样的一个操作符时会发出警告。</p></li><li class="listitem"><p>删除对没有64位整数数据类型工作的平台的支持 (Tom Lane)</p><p>认为所有仍然支持的平台有64位整数数据类型工作。</p></li></ul></div></div></div><div class="sect2" id="idp75648224"><div class="titlepage"><div><div><h3 class="title">E.131.3. 修改列表</h3></div></div></div><p>版本9.0有一个前所未有的新主版本特性的数量，超过200个增强、
改善、新增命令、新增函数和其他修改。</p><div class="sect3" id="idp75649056"><div class="titlepage"><div><div><h4 class="title">E.131.3.1. 服务器</h4></div></div></div><div class="sect4" id="idp75649472"><div class="titlepage"><div><div><h5 class="title">E.131.3.1.1. 连续存档和流复制</h5></div></div></div><p>PostgreSQL的现有备用服务器性能已经扩展为支持在备用服务器上只读查询和大大减少主从服务器之间的延迟。
对于很多用户，这将是流复制的一个有用和低管理的形式，要么为了高可用性，要么为了水平伸缩性。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>允许备用服务器接受只读查询 (Simon Riggs, Heikki Linnakangas)</p><p>这个特性称为热备份。有新的<code class="filename">postgresql.conf</code>和<code class="filename">recovery.conf</code>
设置控制这个特性，还有大量的<a class="link" href="hot-standby.html" title="26.5. 热备">文档</a></p></li><li class="listitem"><p>允许预写式日志(<acronym class="acronym">WAL</acronym>)数据流到备用服务器 (Fujii Masao, Heikki Linnakangas)</p><p>这个特性称为流复制。以前的<acronym class="acronym">WAL</acronym>数据只能以整个<acronym class="acronym">WAL</acronym>
文件（通常每个16百万字节）为基本单位被送到备用服务器。
流复制消除低效，并且允许在主服务器上的更新以非常小的延迟传送到备用服务器上。
有新的<code class="filename">postgresql.conf</code>和<code class="filename">recovery.conf</code>设置控制这个特性，
还有大量的<a class="link" href="warm-standby.html#STREAMING-REPLICATION" title="26.2.5. 流复制">文档</a>。</p></li><li class="listitem"><p>添加<a class="link" href="functions-admin.html#FUNCTIONS-RECOVERY-INFO-TABLE" title="表 9.80. 恢复信息函数"><code class="function">pg_last_xlog_receive_location()</code></a>
和<code class="function">pg_last_xlog_replay_location()</code>，可以用来监控备用服务器的
<acronym class="acronym">WAL</acronym>活动 (Simon Riggs, Fujii Masao, Heikki Linnakangas)</p></li></ul></div></div><div class="sect4" id="idp75661472"><div class="titlepage"><div><div><h5 class="title">E.131.3.1.2. 性能</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>允许通过<a class="link" href="sql-altertablespace.html" title="ALTER TABLESPACE"><code class="command">ALTER TABLESPACE ... SET/RESET</code></a>
为连续的和随机的页面成本估算(<code class="varname">seq_page_cost</code>/<code class="varname">random_page_cost</code>)
设置每个表空间的值 (Robert Haas)</p></li><li class="listitem"><p>提高性能和连接查询中的EvalPlanQual再核查 (Tom Lane)</p><p>包含连接的<code class="command">UPDATE</code>, <code class="command">DELETE</code>, 和 <code class="command">SELECT FOR UPDATE/SHARE</code>
查询现在在遇到最近更新的行时表现的更好。</p></li><li class="listitem"><p>当表早些时候在同一个事务中被创建或截断时，改善
<a class="link" href="sql-truncate.html" title="TRUNCATE"><code class="command">TRUNCATE</code></a>的性能 (Tom Lane)</p></li><li class="listitem"><p>提高找到继承子表的性能 (Tom Lane)</p></li></ul></div></div><div class="sect4" id="idp75669824"><div class="titlepage"><div><div><h5 class="title">E.131.3.1.3. 优化</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>删除不需要的<a class="link" href="queries-table-expressions.html#QUERIES-JOIN" title="7.2.1.1. 连接表">外连接</a> (Robert Haas)</p><p>内侧的外连接是唯一的，并且不被连接的上级引用，因此现在删除了。
这将加速许多自动生成的查询，如那些通过对象关系映射(ORMs)创建的查询。 </p></li><li class="listitem"><p>允许<code class="literal">IS NOT NULL</code>限制使用索引 (Tom Lane)</p><p>这对于在包含许多空值的索引中发现<code class="function">MAX()</code>/<code class="function">MIN()</code>
值是尤其有用的。</p></li><li class="listitem"><p>改善优化器为<code class="literal">DISTINCT</code>选择何时使用物化节点，何时使用排序和散列 (Tom Lane)</p></li><li class="listitem"><p>改善优化器为包含<code class="type">boolean</code> <code class="literal">&lt;&gt;</code>操作符的表达式的等价性检测 (Tom Lane)</p></li></ul></div></div><div class="sect4" id="idp75677776"><div class="titlepage"><div><div><h5 class="title">E.131.3.1.4. <a class="link" href="geqo.html" title="第 59 章 遗传查询优化器">GEQO</a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>每次GEQO规划一个查询时使用相同的随机种子 (Andres Freund)</p><p>Genetic Query Optimizer (GEQO)仍然选择随机规划，它现在总是为相同的查询选择相同的随机规划，
从而给出更加一致的性能。可以修改<a class="link" href="runtime-config-query.html#GUC-GEQO-SEED"><code class="varname">geqo_seed</code></a>
试验可选择的规划。</p></li><li class="listitem"><p>改善GEQO规划选择 (Tom Lane)</p><p>这避免了少有的错误<span class="quote">“<span class="quote">failed to make a valid plan</span>”</span>，
并且应该提升了规划速度。</p></li></ul></div></div><div class="sect4" id="idp75682160"><div class="titlepage"><div><div><h5 class="title">E.131.3.1.5. 优化器统计信息</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>改善<a class="link" href="sql-analyze.html" title="ANALYZE"><code class="command">ANALYZE</code></a>以支持继承树统计信息 (Tom Lane)</p><p>这对于分区表特别有用。不过，当子表改变时autovacuum目前还没有自动重新分析父表。</p></li><li class="listitem"><p>当需要重新分析时，改善<a class="link" href="routine-vacuuming.html" title="24.1. 日常清理">autovacuum</a>
的检测 (Tom Lane)</p></li><li class="listitem"><p>改善优化器对于大于/小于比较的估计 (Tom Lane)</p><p>当查阅对于大于/小于比较的统计信息时，如果比较值是直方图的第一个或最后一个，
使用一个索引（如果可用）抓全当前实际字段的最小或最大值。
这大大的提高了估算接近数据范围结尾的比较值的精确度，
尤其是当范围由于新数据的添加而持续变化时。</p></li><li class="listitem"><p>允许不同值数量统计的设置使用<a class="link" href="sql-altertable.html" title="ALTER TABLE"><code class="command">ALTER TABLE</code></a> (Robert Haas)</p><p>这允许用户重载一个字段的不同值的估计数量或百分比。这个统计通常通过<code class="command">ANALYZE</code>
计算，但是估计可能会差些，尤其是在有非常多的行的表上。</p></li></ul></div></div><div class="sect4" id="idp75690400"><div class="titlepage"><div><div><h5 class="title">E.131.3.1.6. 认证</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加对<a class="link" href="auth-methods.html#AUTH-RADIUS" title="20.3.8. RADIUS 认证"><acronym class="acronym">RADIUS</acronym></a> 
(Remote Authentication Dial In User Service)认证的支持 (Magnus Hagander)</p></li><li class="listitem"><p>允许<a class="link" href="auth-methods.html#AUTH-LDAP" title="20.3.7. LDAP 认证"><acronym class="acronym">LDAP</acronym></a>(Lightweight Directory Access Protocol)
认证在<span class="quote">“<span class="quote">search/bind</span>”</span>模式下操作 (Robert Fleming, Magnus Hagander)</p><p>这允许用户先查找，然后系统使用<acronym class="acronym">DN</acronym> (Distinguished Name)
返回给那个用户。</p></li><li class="listitem"><p>添加<a class="link" href="auth-pg-hba-conf.html" title="20.1. pg_hba.conf文件"><code class="literal">samehost</code></a>
和<code class="literal">samenet</code>指定到<code class="filename">pg_hba.conf</code> (Stef Walter)</p><p>这些分别匹配服务器的<acronym class="acronym">IP</acronym>地址和子网地址。</p></li><li class="listitem"><p>传递信任的SSL根证书名字到客户端，这样客户端可以返回一个合适的客户端证书 (Craig Ringer)</p></li></ul></div></div><div class="sect4" id="idp75699616"><div class="titlepage"><div><div><h5 class="title">E.131.3.1.7. 监控</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加客户端设置<a class="link" href="libpq-connect.html#LIBPQ-CONNECT-APPLICATION-NAME">应用名</a>
的能力，在<code class="structname">pg_stat_activity</code>中显示 (Dave Page)</p><p>这允许管理员表现数据流量和通过源应用寻找故障问题。</p></li><li class="listitem"><p>添加SQLSTATE选项(<code class="literal">%e</code>)到
<a class="link" href="runtime-config-logging.html#GUC-LOG-LINE-PREFIX"><code class="varname">log_line_prefix</code></a> (Guillaume Smet)</p><p>这允许用户通过错误代码数量编制错误和消息的统计数据。</p></li><li class="listitem"><p>以<acronym class="acronym">UTF16</acronym>编码写入Windows事件记录 (Itagaki Takahiro)</p><p>现在在Windows上的PostgreSQL记录消息支持多种语言。</p></li></ul></div></div><div class="sect4" id="idp75705904"><div class="titlepage"><div><div><h5 class="title">E.131.3.1.8. 统计计数器</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加<a class="link" href="monitoring-stats.html#MONITORING-STATS-FUNCS-TABLE" title="表 28.19. 额外统计函数"><code class="function">pg_stat_reset_shared('bgwriter')</code></a>
为后端写入重置集群范围的共享统计数据 (Greg Smith)</p></li><li class="listitem"><p>添加
<a class="link" href="monitoring-stats.html#MONITORING-STATS-FUNCS-TABLE" title="表 28.19. 额外统计函数"><code class="function">pg_stat_reset_single_table_counters()</code></a>
和<code class="function">pg_stat_reset_single_function_counters()</code>，
允许为单独的表和函数重置统计计数器(Magnus Hagander)</p></li></ul></div></div><div class="sect4" id="idp75710784"><div class="titlepage"><div><div><h5 class="title">E.131.3.1.9. 服务器设置</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>允许配置参数的设置基于<a class="link" href="sql-alterrole.html" title="ALTER ROLE">database/role combinations</a>
 (Alvaro Herrera)</p><p>以前，只有每个数据库和每个角色的设置是可能的，组合是不行的。
所有角色和数据库设置现在存储在新的<code class="structname">pg_db_role_setting</code>
系统目录中。新的<span class="application">psql</span>命令<code class="literal">\drds</code>显示了这些设置。
遗留系统视图<code class="structname">pg_roles</code>, <code class="structname">pg_shadow</code>, 和 <code class="structname">pg_user</code>
不显示组合设置，并且因此不再完全的代表一个用户或数据库的配置。</p></li><li class="listitem"><p>添加服务器参数<a class="link" href="runtime-config-connection.html#GUC-BONJOUR"><code class="varname">bonjour</code></a>，
控制启用Bonjour的服务器是否通过<span class="productname">Bonjour</span>通知它自己 (Tom Lane)</p><p>缺省为off，意味着它不做通知。
这允许包装程序分配启用Bonjour的建立时不用担心个别用户可能不想要这个特性。</p></li><li class="listitem"><p>添加服务器参数<a class="link" href="runtime-config-query.html#GUC-ENABLE-MATERIAL"><code class="varname">enable_material</code></a>，
控制在优化器中物化节点的使用 (Robert Haas)</p><p>缺省为on。为off时，优化器将不是纯粹的为性能原因添加物化节点，
尽管他们在为了正确性的需要时仍然被使用。</p></li><li class="listitem"><p>修改服务器参数<a class="link" href="runtime-config-logging.html#GUC-LOG-TEMP-FILES"><code class="varname">log_temp_files</code></a>
使用千字节为缺省文件大小单位 (Robert Haas)</p><p>以前，如果没有声明单位，这种设置解释为字节计。</p></li><li class="listitem"><p>当<code class="filename">postgresql.conf</code>重新加载时日志参数值的变化 (Peter Eisentraut)</p><p>这使得管理员和安保员审计数据库设置的修改，并且也非常方便检查
<code class="filename">postgresql.conf</code>编辑的效果。</p></li><li class="listitem"><p>正确执行自定义服务器参数的超级用户权限 (Tom Lane)</p><p>非超级用户不能再为服务器目前不知道的参数发出<code class="command">ALTER ROLE</code>/<code class="command">DATABASE SET</code>
这允许服务器正确的检查仅超级用户的参数只有通过超级用户设置。以前，
允许<code class="literal">SET</code>并且在会话开始的时候忽略，
使得仅超级用户的自定义参数比其应该有的作用要小的多。</p></li></ul></div></div></div><div class="sect3" id="idp75728256"><div class="titlepage"><div><div><h4 class="title">E.131.3.2. 查询</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>在应用<code class="literal">LIMIT</code>之后执行<a class="link" href="sql-select.html#SQL-FOR-UPDATE-SHARE" title="锁定子句"><code class="command">SELECT FOR UPDATE</code>/<code class="literal">SHARE</code></a>处理，
这样返回的行数总是可预见的 (Tom Lane)</p><p>以前，并发事务所做的改变会导致<code class="command">SELECT FOR UPDATE</code>
返回的行数出乎意料的少于它的<code class="literal">LIMIT</code>声明的行数。
<code class="literal">FOR UPDATE</code>和<code class="literal">ORDER BY</code>的组合也会产生令人惊讶的结果，
但是可以通过在子句中放置<code class="literal">FOR UPDATE</code>来纠正。</p></li><li class="listitem"><p>允许传统的和SQL标准的<a class="link" href="sql-select.html#SQL-LIMIT" title="LIMIT 子句"><code class="literal">LIMIT</code>/<code class="literal">OFFSET</code></a>
语法混合 (Tom Lane)</p></li><li class="listitem"><p>在<a class="link" href="sql-select.html#SQL-WINDOW" title="WINDOW 子句">窗口函数</a>中扩展支持的框架选项 (Hitoshi Harada)</p><p>框架现在可以以<code class="literal">CURRENT ROW</code>开始，并且现在支持
<code class="literal">ROWS <em class="replaceable"><code>n</code></em> PRECEDING</code>/<code class="literal">FOLLOWING</code>选项。</p></li><li class="listitem"><p>使得<code class="command">SELECT INTO</code>和<code class="command">CREATE TABLE AS</code>
在它们的命令标签中返回行计数到客户端 (Boszormenyi Zoltan)</p><p>这可以节省到客户端的整个往返，允许结果计数和页码的计算不带有附加的<code class="command">COUNT</code>查询。</p></li></ul></div><div class="sect4" id="idp75745680"><div class="titlepage"><div><div><h5 class="title">E.131.3.2.1. Unicode 字符串</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>在<a class="link" href="sql-syntax-lexical.html#SQL-SYNTAX-STRINGS-UESCAPE" title="4.1.2.3. 带有 Unicode 转义的字符串常量"><code class="literal">U&amp;</code></a>
字符串和标识符中支持Unicode代理对（段16位表现） (Peter Eisentraut)</p></li><li class="listitem"><p>在<a class="link" href="sql-syntax-lexical.html#SQL-SYNTAX-STRINGS-ESCAPE" title="4.1.2.2. C风格转义的字符串常量"><code class="literal">E'...'</code></a>
字符串中支持Unicode转义 (Marko Kreen)</p></li></ul></div></div></div><div class="sect3" id="idp75749888"><div class="titlepage"><div><div><h4 class="title">E.131.3.3. 对象操作</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>通过定义冲刷到磁盘加速<a class="link" href="sql-createdatabase.html" title="CREATE DATABASE"><code class="command">CREATE DATABASE</code></a>
(Andres Freund, Greg Stark)</p></li><li class="listitem"><p>只允许<a class="link" href="sql-comment.html" title="COMMENT">注释</a>在表、视图和复合类型的字段上，
不允许在其他关系类型如索引和<acronym class="acronym">TOAST</acronym>表上 (Tom Lane)</p></li><li class="listitem"><p>允许<a class="link" href="sql-createtype.html#SQL-CREATETYPE-ENUM" title="枚举类型">枚举类型</a>
的创建不包含值 (Bruce Momjian)</p></li><li class="listitem"><p>使有存储类型<code class="literal">MAIN</code>的字段的值保留在主堆页上，
除了不适合在一个页面上的行 (Kevin Grittner)</p><p>以前，<code class="literal">MAIN</code>值被迫离开到<acronym class="acronym">TOAST</acronym>表，
直到行的大小小于页面大小的四分之一。</p></li></ul></div><div class="sect4" id="idp75758000"><div class="titlepage"><div><div><h5 class="title">E.131.3.3.1. <code class="command">ALTER TABLE</code></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>为<code class="literal">ALTER TABLE DROP COLUMN</code>和<code class="literal">ALTER TABLE DROP CONSTRAINT </code>
实现了<code class="literal">IF EXISTS</code> (Andres Freund)</p></li><li class="listitem"><p>允许<code class="command">ALTER TABLE</code>命令重写表以跳过<acronym class="acronym">WAL</acronym>记录 (Itagaki Takahiro)</p><p>这样的操作要么生成一个该表的新的拷贝，要么回滚，所以可以跳过<acronym class="acronym">WAL</acronym>归档，
除非运行在连续归档模式。这样减少了I/O开支，并且提高了性能。</p></li><li class="listitem"><p>修复不是表的所有者执行<code class="literal">ALTER TABLE <em class="replaceable"><code>table</code></em> ADD COLUMN
 <em class="replaceable"><code>col</code></em> serial</code>时的失败 (Tom Lane)</p></li></ul></div></div><div class="sect4" id="idp75766000"><div class="titlepage"><div><div><h5 class="title">E.131.3.3.2. <a class="link" href="sql-createtable.html" title="CREATE TABLE"><code class="command">CREATE TABLE</code></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加在<code class="command">CREATE TABLE ... LIKE</code>命令中拷贝<code class="literal">COMMENTS</code>
和<code class="literal">STORAGE</code>字符串的支持 (Itagaki Takahiro)</p></li><li class="listitem"><p>添加拷贝<code class="command">CREATE TABLE ... LIKE</code>命令中所有属性的快捷方式 (Itagaki Takahiro)</p></li><li class="listitem"><p>添加SQL标准的<code class="literal">CREATE TABLE ... OF <em class="replaceable"><code>type</code></em></code>命令 (Peter Eisentraut)</p><p>这允许表的创建匹配一个现有的复合类型。附加约束和默认值可以在该命令中指定。</p></li></ul></div></div><div class="sect4" id="idp75773040"><div class="titlepage"><div><div><h5 class="title">E.131.3.3.3. 约束</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加<a class="link" href="sql-createtable.html#SQL-CREATETABLE-COMPATIBILITY" title="兼容性">可推迟的唯一约束</a> (Dean Rasheed)</p><p>这允许大量的更新，如<code class="literal">UPDATE tab SET col = col + 1</code>，
可靠的运行在有唯一索引或标记为主键的字段上。如果约束被指定为<code class="literal">DEFERRABLE</code>，
那么它将在语句的最后被检查，而不是在每行被更新之后。该约束检查也可以被推迟到当前事务的结尾，
允许这样的更新在多个SQL命令中传播。</p></li><li class="listitem"><p>增加了<a class="link" href="ddl-constraints.html#DDL-CONSTRAINTS-EXCLUSION" title="5.3.6. 排他约束">排除约束</a> (Jeff Davis)</p><p>排除约束通过允许任意的比较操作符（不只是相等）概括唯一约束。
它们是用<a class="link" href="sql-createtable.html#SQL-CREATETABLE-EXCLUDE"><code class="command">CREATE TABLE CONSTRAINT ... EXCLUDE</code></a>子句创建的。
排除约束最常见的使用是声明字段记录不能重复，而不只是简单的不能相等。
这对于时间阶段和其他范围还有数组是有用的。
这个特性为许多日程、时间管理和科学应用加强了数据完整性的检查。</p></li><li class="listitem"><p>改善唯一约束违反的错误消息以报告导致该失败的值 (Itagaki Takahiro)</p><p>例如，唯一约束违反现在可以报告<code class="literal">Key (x)=(2) already exists</code>。</p></li></ul></div></div><div class="sect4" id="idp75781600"><div class="titlepage"><div><div><h5 class="title">E.131.3.3.4. 对象权限</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加使用新的<a class="link" href="sql-grant.html" title="GRANT"><code class="command">GRANT</code>/<code class="command">REVOKE IN SCHEMA</code></a>
子句在整个模式中改变大量权限的能力 (Petr Jelinek)</p><p>这简化了对象权限的管理，并且使得应用数据安全更容易的利用数据库角色。</p></li><li class="listitem"><p>添加<a class="link" href="sql-alterdefaultprivileges.html" title="ALTER DEFAULT PRIVILEGES"><code class="command">ALTER DEFAULT PRIVILEGES</code></a>
命令以控制稍后创建的对象的权限 (Petr Jelinek)</p><p>这大大的简化了复杂数据库应用中对象权限的分配。可以为表、视图、序列和函数设置缺省权限。
缺省可以在每个模式的基础上或者数据库范围内分配。</p></li><li class="listitem"><p>添加用<code class="command">GRANT</code>/<code class="command">REVOKE</code>控制大对象(BLOB)权限的能力 (KaiGai Kohei)</p><p>以前，任意数据库用户可以读取或者修改任何大对象。
现在可以赋予和撤销每个大对象的读取和写入权限，
并且追踪大对象的所有者关系。</p></li></ul></div></div></div><div class="sect3" id="idp75789568"><div class="titlepage"><div><div><h4 class="title">E.131.3.4. 实用操作</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>使得<a class="link" href="sql-listen.html" title="LISTEN"><code class="command">LISTEN</code></a>/
<a class="link" href="sql-notify.html" title="NOTIFY"><code class="command">NOTIFY</code></a>
存储在一个内存序列中等待事件，而不是在一个系统表中 (Joachim Wieland)</p><p>这在保留事务支持和保证交付的现有特性时大幅度的提升了性能。</p></li><li class="listitem"><p>允许<a class="link" href="sql-notify.html" title="NOTIFY"><code class="command">NOTIFY</code></a>
传送一个可选的<span class="quote">“<span class="quote">payload</span>”</span>字符串到监听器 (Joachim Wieland)</p><p>这大大的提升了<code class="command">LISTEN</code>/<code class="command">NOTIFY</code>作为一个通用的事件队列系统的有用性。</p></li><li class="listitem"><p>允许在所有的数据库系统目录上<a class="link" href="sql-cluster.html" title="CLUSTER"><code class="command">CLUSTER</code></a> (Tom Lane)</p><p>共享的目录仍然不能集群。</p></li></ul></div><div class="sect4" id="idp75799344"><div class="titlepage"><div><div><h5 class="title">E.131.3.4.1. <a class="link" href="sql-copy.html" title="COPY"><code class="command">COPY</code></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>接受<code class="literal">COPY ... CSV FORCE QUOTE *</code> (Itagaki Takahiro)</p><p>现在<code class="literal">*</code>在<code class="literal">FORCE QUOTE</code>子句中可以用作<span class="quote">“<span class="quote">所有字段</span>”</span>的简写。</p></li><li class="listitem"><p>添加新的<code class="command">COPY</code>语法，允许选项在圆括号内部指定 (Robert Haas, Emmanuel Cecchet)</p><p>这允许未来的<code class="command">COPY</code>选项有更大的灵活性。仍然支持旧的语法，
但是只对已经存在的选项。</p></li></ul></div></div><div class="sect4" id="idp75806384"><div class="titlepage"><div><div><h5 class="title">E.131.3.4.2. <a class="link" href="sql-explain.html" title="EXPLAIN"><code class="command">EXPLAIN</code></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>允许<code class="command">EXPLAIN</code>以<acronym class="acronym">XML</acronym>、<acronym class="acronym">JSON</acronym>或<acronym class="acronym">YAML</acronym>
格式输出(Robert Haas, Greg Sabino Mullane)</p><p>新的输出格式是容易机器可读的，支持分析<code class="command">EXPLAIN</code>输出的新工具的发展。</p></li><li class="listitem"><p>添加新的<code class="literal">BUFFERS</code>选项报告<code class="command">EXPLAIN ANALYZE</code>
期间查询缓冲区的使用 (Itagaki Takahiro)</p><p>这允许为单个查询更好的查询分析。缓冲区的使用不再在
<a class="link" href="runtime-config-statistics.html#RUNTIME-CONFIG-STATISTICS-MONITOR" title="19.9.2. 统计监控">log_statement_stats</a>
和相关设置的输出中报告。</p></li><li class="listitem"><p>添加散列使用信息到<code class="command">EXPLAIN</code>输出 (Robert Haas)</p></li><li class="listitem"><p>添加新的<code class="command">EXPLAIN</code>语法，允许选项在圆括号内部指定 (Robert Haas)</p><p>这允许未来的<code class="command">EXPLAIN</code>选项有更大的灵活性。仍然支持旧的语法，
但是只对已经存在的选项。</p></li></ul></div></div><div class="sect4" id="idp75818144"><div class="titlepage"><div><div><h5 class="title">E.131.3.4.3. <a class="link" href="sql-vacuum.html" title="VACUUM"><code class="command">VACUUM</code></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>改变<code class="command">VACUUM FULL</code>重写整个表和重建它的索引，
而不是围绕紧致的空间移动个别的行 (Itagaki Takahiro, Tom Lane)</p><p>以前的方法通常较慢，并且导致索引膨胀。请注意，
新的方法将在<code class="command">VACUUM FULL</code>期间瞬间使用更多磁盘空间；
可能是正常被该表和它的索引占用的空间的两倍。</p></li><li class="listitem"><p>添加新的<code class="command">VACUUM</code>语法，允许选项在圆括号内部指定 (Itagaki Takahiro)</p><p>这允许未来的<code class="command">VACUUM</code>选项有更大的灵活性。仍然支持旧的语法，
但是只对已经存在的选项。</p></li></ul></div></div><div class="sect4" id="idp75824288"><div class="titlepage"><div><div><h5 class="title">E.131.3.4.4. 索引</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>允许索引在<a class="link" href="sql-createindex.html" title="CREATE INDEX"><code class="command">CREATE INDEX</code></a>
中通过省略索引名自动命名 (Tom Lane)</p></li><li class="listitem"><p>缺省的，多字段索引现在以所有它们的字段命名；
索引表达式字段现在基于它们的表达式命名 (Tom Lane)</p></li><li class="listitem"><p>重建共享系统目录索引现在是完全事务性并且崩溃安全了 (Tom Lane)</p><p>以前，重建共享索引只允许在单机模式，并且在操作期间崩溃会使索引在一个比之前更糟糕的状态。</p></li><li class="listitem"><p>为<acronym class="acronym">GiST</acronym>添加<code class="literal">point_ops</code>运算符类 (Teodor Sigaev)</p><p>这个特性许可<acronym class="acronym">GiST</acronym>索引<code class="type">point</code>字段。
该索引可以用于查询的几个类型，如<em class="replaceable"><code>point</code></em> <code class="literal">&lt;@</code> <em class="replaceable"><code>polygon</code></em>
（点在多边形中）。这应该使得许多<span class="productname">PostGIS</span>查询快很多。</p></li><li class="listitem"><p>为<acronym class="acronym">GIN</acronym>索引创建使用红黑二叉树 (Teodor Sigaev)</p><p>红黑树是自动平衡的。避免了非随机的输入顺序情况下的减速。</p></li></ul></div></div></div><div class="sect3" id="idp75834368"><div class="titlepage"><div><div><h4 class="title">E.131.3.5. 数据类型</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>允许<a class="link" href="datatype-binary.html" title="8.4. 二进制数据类型"><code class="type">bytea</code></a>
值以十六进制符号书写 (Peter Eisentraut)</p><p>服务器参数<a class="link" href="runtime-config-client.html#GUC-BYTEA-OUTPUT"><code class="varname">bytea_output</code></a>
控制十六进制还是传统格式用于<code class="type">bytea</code>输出。当连接到
<span class="productname">PostgreSQL</span> 9.0或更新的服务器时，Libpq的
<code class="function">PQescapeByteaConn()</code>函数自动使用十六进制格式。
不过，9.0以前的libpq版本将不能为更新的服务器处理十六进制格式。</p><p>新的十六进制格式将直接兼容更多使用二进制数据的应用，允许它们存储和检索，
而不用额外的转换。它比传统的格式的读取和写入也要快得多。</p></li><li class="listitem"><p>允许服务器参数<a class="link" href="runtime-config-client.html#GUC-EXTRA-FLOAT-DIGITS">extra_float_digits</a>
增加到<code class="literal">3</code> (Tom Lane)</p><p>以前<code class="varname">extra_float_digits</code>的最大值设置是<code class="literal">2</code>。
在某些情况下，需要3位数准确的转储和恢复<code class="type">float4</code>值。
<span class="application">pg_dump</span>现在在从允许设置为3的服务器转储时将使用3的设置。</p></li><li class="listitem"><p>加强<code class="type">int2vector</code>值的输入检查 (Caleb Welton)</p></li></ul></div><div class="sect4" id="idp75845712"><div class="titlepage"><div><div><h5 class="title">E.131.3.5.1. <a class="link" href="textsearch.html" title="第 12 章 全文搜索">全文检索</a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>在<code class="literal">同义词</code>字典中添加前缀支持 (Teodor Sigaev)</p></li><li class="listitem"><p>添加<em class="firstterm">过滤</em>字典 (Teodor Sigaev)</p><p>过滤字典允许符号被修改后传送到随后的字典。</p></li><li class="listitem"><p>在邮件地址符号中允许下划线 (Teodor Sigaev)</p></li><li class="listitem"><p>为解析<acronym class="acronym">URL</acronym>符号使用更符合标准的规则 (Tom Lane)</p></li></ul></div></div></div><div class="sect3" id="idp75850448"><div class="titlepage"><div><div><h4 class="title">E.131.3.6. 函数</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>允许函数调用提供参数名，并且匹配它们到函数定义中命名的参数 (Pavel Stehule)</p><p>例如，如果一个函数定义为接受参数<code class="literal">a</code>和<code class="literal">b</code>，
它可以用<code class="literal">func(a := 7, b := 12)</code>或<code class="literal">func(b := 12, a := 7)</code>调用。</p></li><li class="listitem"><p>支持本地特定的<a class="link" href="functions-matching.html#FUNCTIONS-POSIX-REGEXP" title="9.7.3. POSIX正则表达式">正则表达式</a>
处理<acronym class="acronym">UTF-8</acronym>服务器编码 (Tom Lane)</p><p>本地特定的正则表达式功能包括大小写敏感匹配和本地特定的字符类。
以前，这些特性只在数据库使用一个单字节服务器编码（如LATIN1）时，
可以为非<acronym class="acronym">ASCII</acronym>字符正确的工作。它们将仍然在多字节编码下错误行为，
除了<acronym class="acronym">UTF-8</acronym>。</p></li><li class="listitem"><p>在<a class="link" href="functions-formatting.html" title="9.8. 数据类型格式化函数"><code class="function">to_char()</code></a>
(<a class="link" href="functions-formatting.html#FUNCTIONS-FORMATTING-NUMERIC-TABLE" title="表 9.26. 用于数字格式化的模板模式"><code class="literal">EEEE</code>规范</a>)
中添加对科学计数法的支持 (Pavel Stehule, Brendan Jurd)</p></li><li class="listitem"><p>使得<code class="function">to_char()</code>遵守<a class="link" href="functions-formatting.html#FUNCTIONS-FORMATTING-DATETIMEMOD-TABLE" title="表 9.25. 用于日期/时间格式化的模板模式修饰语"><code class="literal">FM</code></a>（填充模式）按照<code class="literal">Y</code>、<code class="literal">YY</code>
和<code class="literal">YYY</code>规格 (Bruce Momjian, Tom Lane)</p><p>它早已遵从<code class="literal">YYYY</code>。</p></li><li class="listitem"><p>修复<code class="function">to_char()</code>在<span class="productname">Windows</span>
上以正确的编码输出本地化的数值和货币字符串 (Hiroshi Inoue, Itagaki Takahiro, Bruce Momjian)</p></li><li class="listitem"><p>为多边形正确计算<a class="link" href="functions-geometry.html#FUNCTIONS-GEOMETRY-OP-TABLE" title="表 9.33. 几何操作符"><span class="quote">“<span class="quote">重叠</span>”</span></a>
和<span class="quote">“<span class="quote">包含</span>”</span> (Teodor Sigaev)</p><p>多边形<code class="literal">&amp;&amp;</code>(重叠)运算符以前选中只是为了查看两个多边形的边界框是否重叠。
现在它做一个更正确的检查。多边形<code class="literal">@&gt;</code>和<code class="literal">&lt;@</code>（包含/包含于）
运算符以前选中是为了查看一个多边形顶点是否都包含在另一个中；
这对于一些非凸多边形会错误的报告<span class="quote">“<span class="quote">true</span>”</span>。
现在它们检查一个多边形的所有线段都包含在另一个中。</p></li></ul></div><div class="sect4" id="idp75873808"><div class="titlepage"><div><div><h5 class="title">E.131.3.6.1. 聚合</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>允许聚合函数使用
<a class="link" href="sql-expressions.html#SYNTAX-AGGREGATES" title="4.2.7. 聚合表达式"><code class="literal">ORDER BY</code></a> (Andrew Gierth)</p><p>例如，现在支持：<code class="literal">array_agg(a ORDER BY b)</code>。
这对于输入值顺序很重要的聚合是有用的，并且消除了使用非标准的子查询确定顺序的需要。</p></li><li class="listitem"><p>多参数聚合函数现在可以使用<code class="literal">DISTINCT</code> (Andrew Gierth)</p></li><li class="listitem"><p>添加<a class="link" href="functions-aggregate.html#FUNCTIONS-AGGREGATE-TABLE" title="表 9.52. 通用聚集函数"><code class="function">string_agg()</code></a>
函数，组合值到一个字符串 (Pavel Stehule)</p></li><li class="listitem"><p>用<code class="literal">DISTINCT</code>调用的聚合函数，如果聚合转换函数没有被标记为<code class="literal">STRICT</code>，
那么现在传递NULL值 (Andrew Gierth)</p><p>例如，<code class="literal">agg(DISTINCT x)</code>可能传递一个NULL <code class="literal">x</code>值到<code class="function">agg()</code>。
这和非<code class="literal">DISTINCT</code>情况的行为更加一致。</p></li></ul></div></div><div class="sect4" id="idp75885120"><div class="titlepage"><div><div><h5 class="title">E.131.3.6.2. 位字符串</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>为<code class="type">bit</code>字符串添加<a class="link" href="functions-binarystring.html#FUNCTIONS-BINARYSTRING-OTHER" title="表 9.12. 其他二进制串函数"><code class="function">get_bit()</code></a>
和<code class="function">set_bit()</code>函数，为<code class="type">bytea</code>映射这两个函数 (Leonardo F)</p></li><li class="listitem"><p>为<code class="type">bit</code>字符串和<code class="type">bytea</code>实现<a class="link" href="functions-string.html#FUNCTIONS-STRING-SQL" title="表 9.8. SQL字符串函数和操作符"><code class="function">OVERLAY()</code></a>（替换） (Leonardo F)</p></li></ul></div></div><div class="sect4" id="idp75891472"><div class="titlepage"><div><div><h5 class="title">E.131.3.6.3. 对象信息函数</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加<a class="link" href="functions-admin.html#FUNCTIONS-ADMIN-DBSIZE" title="表 9.84. 数据库对象尺寸函数"><code class="function">pg_table_size()</code></a>
和<code class="function">pg_indexes_size()</code>，提供一个更加用户友好的界面到
<code class="function">pg_relation_size()</code>函数 (Bernd Helmle)</p></li><li class="listitem"><p>为序列权限检查添加<a class="link" href="functions-info.html#FUNCTIONS-INFO-ACCESS-TABLE" title="表 9.61. 访问权限查询函数"><code class="function">has_sequence_privilege()</code></a> (Abhijit Menon-Sen)</p></li><li class="listitem"><p>更新<a class="link" href="information-schema.html" title="第 36 章 信息模式">information_schema</a>
视图以符合SQL:2008 (Peter Eisentraut)</p></li><li class="listitem"><p>使得<code class="literal">information_schema</code>视图为<code class="type">char</code>和<code class="type">varchar</code>
字段正确的显示最大的八位字节长度 (Peter Eisentraut)</p></li><li class="listitem"><p>加速<code class="literal">information_schema</code>权限视图 (Joachim Wieland)</p></li></ul></div></div><div class="sect4" id="idp75901472"><div class="titlepage"><div><div><h5 class="title">E.131.3.6.4. 函数和触发器创建</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>支持使用<a class="link" href="sql-do.html" title="DO"><code class="command">DO</code></a>
声明执行匿名代码块 (Petr Jelinek, Joshua Tolley, Hannu Valtonen)</p><p>这允许服务器端代码的执行不需要创建和删除临时函数定义。
代码可以以任意用户有权限定义函数的语言执行。</p></li><li class="listitem"><p>实现服从SQL标准的<a class="link" href="sql-createtrigger.html" title="CREATE TRIGGER">每字段触发</a> (Itagaki Takahiro)</p><p>这样的触发器只有在指定的字段受到查询的影响时触发，如：
出现在<code class="command">UPDATE</code>的<code class="literal">SET</code>列表中。</p></li><li class="listitem"><p>添加<code class="literal">WHEN</code>子句到<a class="link" href="sql-createtrigger.html" title="CREATE TRIGGER"><code class="command">CREATE TRIGGER</code></a>，
允许控制触发器是否触发 (Itagaki Takahiro)</p><p>虽然相同类型的检查总是可以在触发器内部执行，但是在外部的<code class="literal">WHEN</code>
子句中做检查会有性能优势。</p></li></ul></div></div></div><div class="sect3" id="idp75910784"><div class="titlepage"><div><div><h4 class="title">E.131.3.7. 服务器端语言</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加<code class="literal">OR REPLACE</code>子句到
<a class="link" href="sql-createlanguage.html" title="CREATE LANGUAGE"><code class="command">CREATE LANGUAGE</code></a> (Tom Lane)</p><p>这对于可选择的安装一个并非早已存在的语言是有帮助的，
并且对于现在PL/pgSQL是默认安装的尤其有帮助。</p></li></ul></div><div class="sect4" id="idp75914112"><div class="titlepage"><div><div><h5 class="title">E.131.3.7.1. <a class="link" href="plpgsql.html" title="第 42 章 PL/pgSQL - SQL过程语言">PL/pgSQL</a>服务器端语言</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>缺省安装PL/pgSQL (Bruce Momjian)</p><p>如果管理员担心启用它会有安全或性能问题，该语言仍然可以从个别的数据库中删除。</p></li><li class="listitem"><p>改善PL/pgSQL变量名与函数的查询中使用的标识符冲突时的处理 (Tom Lane)</p><p>缺省行为是有冲突时抛出一个错误，以便避免意外的行为。这个可以修改，
通过配置参数<a class="link" href="plpgsql-implementation.html#PLPGSQL-VAR-SUBST" title="42.10.1. 变量替换"><code class="varname">plpgsql.variable_conflict</code></a>
或者每个函数的选项<code class="literal">#variable_conflict</code>，允许使用变量或者查询提供的字段。
在任何情况下，PL/pgSQL将不再尝试替换不符合语法规范的变量。</p></li><li class="listitem"><p>使PL/pgSQL使用主要的词法分析程序，而不是它自己的版本 (Tom Lane)</p><p>这确保了精确的追踪主系统的细节行为，如字符串转义。一些用户变量细节，
如考虑保留在PL/pgSQL中的关键字的设置，已经因此而改变了。</p></li><li class="listitem"><p>避免为无效的记录引用抛出不必要的错误 (Tom Lane)</p><p>现在只有引用实际抓取到时才抛出一个错误，而不是每当到达封闭的表达式时。
例如，许多人尝试在触发器中这样做：
</p><pre class="programlisting">if TG_OP = 'INSERT' and NEW.col1 = ... then</pre><p>
现在这实际上将如预期一样工作。</p></li><li class="listitem"><p>提高PL/pgSQL处理包含了删除字段的行类型的能力 (Pavel Stehule)</p></li><li class="listitem"><p>允许输入参数在PL/pgSQL函数内部分配值 (Steve Prentice)</p><p>以前，输入参数被当做声明了<code class="literal">CONST</code>来看，所以函数的代码不能改变它们的值。
这个限制已被删除，以简化函数从其他没有利用该等价限制的DBMSes中移植。
输入参数现在像本地变量初始化为传入的值一样动作。</p></li><li class="listitem"><p>改进PL/pgSQL中的错误位置报告 (Tom Lane)</p></li><li class="listitem"><p>在PL/pgSQL中添加<em class="replaceable"><code>count</code></em>和<code class="literal">ALL</code>选项到
<code class="command">MOVE FORWARD</code>/<code class="literal">BACKWARD</code> (Pavel Stehule)</p></li><li class="listitem"><p>允许PL/pgSQL的<code class="literal">WHERE CURRENT OF</code>使用游标变量 (Tom Lane)</p></li><li class="listitem"><p>允许PL/pgSQL的<code class="command">OPEN <em class="replaceable"><code>cursor</code></em> FOR EXECUTE</code>
使用参数 (Pavel Stehule, Itagaki Takahiro)</p><p>这用一个新的<code class="literal">USING</code>子句完成了。</p></li></ul></div></div><div class="sect4" id="idp75930944"><div class="titlepage"><div><div><h5 class="title">E.131.3.7.2. <a class="link" href="plperl.html" title="第 44 章 PL/Perl - Perl 过程语言">PL/Perl</a>服务器端语言</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加新的PL/Perl函数：<a class="link" href="plperl-builtins.html#PLPERL-UTILITY-FUNCTIONS" title="44.3.2. PL/Perl 中的工具函数"><code class="function">quote_literal()</code></a>,
       <code class="function">quote_nullable()</code>, <code class="function">quote_ident()</code>,
       <code class="function">encode_bytea()</code>, <code class="function">decode_bytea()</code>,
       <code class="function">looks_like_number()</code>,
       <code class="function">encode_array_literal()</code>,
       <code class="function">encode_array_constructor()</code> (Tim Bunce)</p></li><li class="listitem"><p>添加服务器参数<a class="link" href="plperl-under-the-hood.html#GUC-PLPERL-ON-INIT"><code class="varname">plperl.on_init</code></a>，
指定一个PL/Perl初始化函数 (Tim Bunce)</p><p><a class="link" href="plperl-under-the-hood.html#GUC-PLPERL-ON-PLPERL-INIT"><code class="varname">plperl.on_plperl_init</code></a>
和<a class="link" href="plperl-under-the-hood.html#GUC-PLPERL-ON-PLPERL-INIT"><code class="varname">plperl.on_plperlu_init</code></a>
都可以用于初始化，分别针对信任的和不信任的语言。</p></li><li class="listitem"><p>在PL/Perl中支持<code class="command">END</code>块 (Tim Bunce)</p><p><code class="command">END</code>块目前不允许数据库访问。</p></li><li class="listitem"><p>在PL/Perl中允许<code class="command">use strict</code> (Tim Bunce)</p><p>Perl <code class="literal">strict</code>检查也可以用新的服务器参数
<a class="link" href="plperl-under-the-hood.html#GUC-PLPERL-USE-STRICT"><code class="varname">plperl.use_strict</code></a>
来全局启用。</p></li><li class="listitem"><p>在PL/Perl中允许<code class="command">require</code> (Tim Bunce)</p><p>这主要是测试看看该模块是否加载上了，如果没有，产生一个错误。
不允许加载管理员没有通过初始化参数预加载的模块。</p></li><li class="listitem"><p>如果使用了Perl版本5.10或更新，则在PL/Perl中允许<code class="command">use feature</code> (Tim Bunce)</p></li><li class="listitem"><p>验证了PL/Perl返回值在服务器编码中可用 (Andrew Dunstan)</p></li></ul></div></div><div class="sect4" id="idp75951184"><div class="titlepage"><div><div><h5 class="title">E.131.3.7.3. <a class="link" href="plpython.html" title="第 45 章 PL/Python - Python 过程语言">PL/Python</a> 服务器端语言</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>在PL/Python中添加Unicode支持 (Peter Eisentraut)</p><p>如果需要，字符串自动转换从/到服务器编码。</p></li><li class="listitem"><p>在PL/Python中改善<code class="type">bytea</code>支持 (Caleb Welton)</p><p>传递到PL/Python中的<code class="type">Bytea</code>值现在表示为二进制，
而不是PostgreSQL <code class="type">bytea</code>文本格式。包含空字节的<code class="type">Bytea</code>
值现在也从PL/Python中适当的输出。也改善了布尔值、整数值和浮点值的传送。</p></li><li class="listitem"><p>在PL/Python中支持<a class="link" href="plpython-data.html#PLPYTHON-ARRAYS" title="45.3.3. 数组、列表">arrays</a>作为参数并且返回值 (Peter Eisentraut)</p></li><li class="listitem"><p>改善SQL域的映射为Python类型 (Peter Eisentraut)</p></li><li class="listitem"><p>添加<span class="application">Python</span> 3支持到PL/Python (Peter Eisentraut)</p><p>新的服务器端语言称作<a class="link" href="plpython-python23.html" title="45.1. Python 2 vs. Python 3"><code class="literal">plpython3u</code></a>。
不能用于<span class="application">Python</span> 2服务器端语言的相同会话中。</p></li><li class="listitem"><p>改善PL/Python中的错误位置和异常报告 (Peter Eisentraut)</p></li></ul></div></div></div><div class="sect3" id="idp75961792"><div class="titlepage"><div><div><h4 class="title">E.131.3.8. 客户应用程序</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加<code class="option">--analyze-only</code>选项到<a class="link" href="app-vacuumdb.html" title="vacuumdb"><code class="command">vacuumdb</code></a>，
不带有清理的分析 (Bruce Momjian)</p></li></ul></div><div class="sect4" id="idp75964464"><div class="titlepage"><div><div><h5 class="title">E.131.3.8.1. <a class="link" href="app-psql.html" title="psql"><span class="application">psql</span></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加支持引用/转义<span class="application">psql</span> <a class="link" href="app-psql.html#APP-PSQL-VARIABLES" title="变量">变量</a>
的值作为SQL字符串或标识符 (Pavel Stehule, Robert Haas)</p><p>例如，<code class="literal">:'var'</code>将产生值<code class="literal">var</code>，引用并适当的转义为字符串常量，
而<code class="literal">:"var"</code>将产生它的值，引用并且转义为一个标识符。</p></li><li class="listitem"><p>在通过<span class="application">psql</span>读取的脚本文件中，
忽略前导的UTF-8编码的Unicode字节顺序标记 (Itagaki Takahiro)</p><p>这在客户端编码是<acronym class="acronym">UTF-8</acronym>的时候启用。它改善了与某些编辑器的兼容性，
主要是在Windows上，坚持插入这样的标记的那些。</p></li><li class="listitem"><p>修复<code class="command">psql --file -</code>以适当的遵从
<a class="link" href="app-psql.html#R1-APP-PSQL-3" title="选项"><code class="option">--single-transaction</code></a> (Bruce Momjian)</p></li><li class="listitem"><p>当两个<span class="application">psql</span>会话并行运行时，避免<span class="application">psql</span>
的命令行历史重写 (Tom Lane)</p></li><li class="listitem"><p>改善<span class="application">psql</span>的选项卡实现支持 (Itagaki Takahiro)</p></li><li class="listitem"><p>当启用<code class="literal">\timing</code>时显示它的输出，不管<span class="quote">“<span class="quote">quiet</span>”</span>模式 (Peter Eisentraut)</p></li></ul></div><div class="sect5" id="idp75979440"><div class="titlepage"><div><div><h6 class="title">E.131.3.8.1.1. <span class="application">psql</span> 显示</h6></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>改善<span class="application">psql</span>中封装字段的显示 (Roger Leigh)</p><p>这个行为现在是缺省的。以前的格式通过使用<code class="command">\pset linestyle old-ascii</code>可用。</p></li><li class="listitem"><p>允许<span class="application">psql</span>通过<code class="command">\pset linestyle unicode</code>
使用喜好的Unicode线条特性 (Roger Leigh)</p></li></ul></div></div><div class="sect5" id="idp75984704"><div class="titlepage"><div><div><h6 class="title">E.131.3.8.1.2. <span class="application">psql</span> <a class="link" href="app-psql.html#APP-PSQL-META-COMMANDS" title="元命令"><code class="command">\d</code></a> 命令</h6></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>使<code class="command">\d</code>显示从指定父表继承而来的子表 (Damien Clochard)</p><p><code class="command">\d</code>只显示子表的数量，而<code class="command">\d+</code>显示所有子表的名字。</p></li><li class="listitem"><p>在<code class="command">\d index_name</code>中显示索引字段的定义 (Khee Chin)</p><p>定义对于表达式索引是有用的。</p></li><li class="listitem"><p>只在<code class="command">\d+</code>中显示视图的定义查询，在<code class="command">\d</code>中不显示 (Peter Eisentraut)</p><p>总是包括认为过度冗长的查询。</p></li></ul></div></div></div><div class="sect4" id="idp75993296"><div class="titlepage"><div><div><h5 class="title">E.131.3.8.2. <a class="link" href="app-pgdump.html" title="pg_dump"><span class="application">pg_dump</span></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>使<span class="application">pg_dump</span>/<span class="application">pg_restore</span>
<a class="link" href="app-pgdump.html#PG-DUMP-OPTIONS" title="选项"><code class="option">--clean</code></a>
总是删除大对象 (Itagaki Takahiro)</p></li><li class="listitem"><p>修复<span class="application">pg_dump</span>，使其在启用<code class="literal">standard_conforming_strings</code>
时适当的转储大对象 (Tom Lane)</p><p>当转储到一个归档文件，并且然后从<span class="application">pg_restore</span>生成脚本输出时，
以前的编码可能会失败。</p></li><li class="listitem"><p><span class="application">pg_restore</span>现在在生成脚本输出时以十六进制格式发出大对象数据 (Tom Lane)</p><p>如果该脚本然后输入到一个9.0以前的服务器，那么这可能会导致兼容性问题。
要绕开这个问题，直接恢复到该服务器。</p></li><li class="listitem"><p>允许<span class="application">pg_dump</span>转储附加到复合类型字段的注释 (Taro Minowa (Higepon))</p></li><li class="listitem"><p>使<span class="application">pg_dump</span> <a class="link" href="app-pgdump.html#PG-DUMP-OPTIONS" title="选项"><code class="option">--verbose</code></a>
在文本输出模式输出<span class="application">pg_dump</span>和服务器版本 (Jim Cox, Tom Lane)</p><p>这些在自定义输出模式中早已提供。</p></li><li class="listitem"><p><span class="application">pg_restore</span>现在抱怨是否在开关和选项文件名后面残存任何命令行参数 (Tom Lane)</p><p>以前，它默默地无视任何这样的参数。</p></li></ul></div></div><div class="sect4" id="idp76007920"><div class="titlepage"><div><div><h5 class="title">E.131.3.8.3. <a class="link" href="app-pg-ctl.html" title="pg_ctl"><span class="application">pg_ctl</span></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>在系统重新启动该期间允许使用<span class="application">pg_ctl</span>
安全的启动<span class="application">postmaster</span> (Tom Lane)</p><p>以前，<span class="application">pg_ctl</span>的父进程错误的认为是基于旧的<span class="application">postmaster</span>
锁文件运行<span class="application">postmaster</span>，导致瞬间的不能启动数据库。</p></li><li class="listitem"><p>给予<span class="application">pg_ctl</span>初始化数据库的能力（通过调用<span class="application">initdb</span>） (Zdenek Kotala)</p></li></ul></div></div></div><div class="sect3" id="idp76015696"><div class="titlepage"><div><div><h4 class="title">E.131.3.9. <span class="application">开发工具</span></h4></div></div></div><div class="sect4" id="idp76016512"><div class="titlepage"><div><div><h5 class="title">E.131.3.9.1. <a class="link" href="libpq.html" title="第 33 章 libpq - C 库"><span class="application">libpq</span></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加新的<span class="application">libpq</span>函数
<a class="link" href="libpq-connect.html" title="33.1. 数据库连接控制函数"><code class="function">PQconnectdbParams()</code></a>
和<code class="function">PQconnectStartParams()</code> (Guillaume Lelarge)</p><p>这些函数类似于<code class="function">PQconnectdb()</code>和<code class="function">PQconnectStart()</code>，
除了它们接受连接选项的数组以null结尾，而不是请求在一个字符串中提供所有选项。</p></li><li class="listitem"><p>添加<span class="application">libpq</span>函数
<a class="link" href="libpq-exec.html#LIBPQ-EXEC-ESCAPE-STRING" title="33.3.4. 用于包含在 SQL 命令中的转移字符串"><code class="function">PQescapeLiteral()</code></a>
和<code class="function">PQescapeIdentifier()</code> (Robert Haas)</p><p>这些函数返回适当引用和转义的SQL字符串字面值和标识符。
调用者不需要预先分配字符串结果，如<code class="function">PQescapeStringConn()</code>要求。</p></li><li class="listitem"><p>添加每用户服务文件的支持(<a class="link" href="libpq-pgservice.html" title="33.16. 连接服务文件"><code class="filename">.pg_service.conf</code></a>)，
在站点范围的服务文件之前检查 (Peter Eisentraut)</p></li><li class="listitem"><p>如果不能找到指定的<span class="application">libpq</span>服务，那么适当的报告一个错误 (Peter Eisentraut)</p></li><li class="listitem"><p>在libpq中添加<a class="link" href="libpq-connect.html#LIBPQ-KEEPALIVES">TCP keepalive 设置</a> 
(Tollef Fog Heen, Fujii Masao, Robert Haas)</p><p>Keepalive设置早已在TCP连接的服务器端支持。</p></li><li class="listitem"><p>在提供可替代方式的平台上，避免额外的系统调用在<span class="application">libpq</span>
中阻塞或疏通<code class="literal">SIGPIPE</code> (Jeremy Kerr)</p></li><li class="listitem"><p>当<a class="link" href="libpq-pgpass.html" title="33.15. 口令文件"><code class="filename">.pgpass</code></a>提供的口令未通过时，
在错误消息中提到口令的来源 (Bruce Momjian)</p></li><li class="listitem"><p>加载所有客户端认证文件中给出的SSL认证 (Tom Lane)</p><p>改善了对间接签署的SSL认证的支持。</p></li></ul></div></div><div class="sect4" id="idp76036336"><div class="titlepage"><div><div><h5 class="title">E.131.3.9.2. <a class="link" href="ecpg.html" title="第 35 章 ECPG - C 中的嵌入式 SQL"><span class="application">ecpg</span></a></h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加<a class="link" href="ecpg-descriptors.html" title="35.7. 使用描述符区域"><acronym class="acronym">SQLDA</acronym></a>
（SQL Descriptor Area）支持到 <span class="application">ecpg</span> (Boszormenyi Zoltan)</p></li><li class="listitem"><p>添加<a class="link" href="ecpg-descriptors.html" title="35.7. 使用描述符区域"><code class="command">DESCRIBE</code> <code class="literal">OUTPUT</code> ]</a>
声明到<span class="application">ecpg</span> (Boszormenyi Zoltan)</p></li><li class="listitem"><p>添加一个<a class="link" href="ecpg-library.html" title="35.11. 库函数">ECPGtransactionStatus</a>
函数以返回当前事务状态 (Bernd Helmle)</p></li><li class="listitem"><p>在<span class="application">ecpg</span> Informix兼容模式中添加<code class="literal">string</code>数据类型 (Boszormenyi Zoltan)</p></li><li class="listitem"><p>允许<span class="application">ecpg</span>没有限制的使用<code class="literal">new</code>和<code class="literal">old</code>
变量名 (Michael Meskes)</p></li><li class="listitem"><p>允许<span class="application">ecpg</span>在<code class="function">free()</code>中使用变量名 (Michael Meskes)</p></li><li class="listitem"><p>使<code class="function">ecpg_dynamic_type()</code>为非SQL3数据类型返回零 (Michael Meskes)</p><p>以前，它返回该数据类型OID的负值。然而，这可能会与有效类型的OID混淆。</p></li><li class="listitem"><p>在早已有64位<code class="type">long</code>类型的平台上支持<code class="type">long long</code>类型 (Michael Meskes)</p></li></ul></div><div class="sect5" id="idp76053664"><div class="titlepage"><div><div><h6 class="title">E.131.3.9.2.1. <span class="application">ecpg</span> 游标</h6></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>在<span class="application">ecpg</span>的原始模式中添加超出范围游标支持 (Boszormenyi Zoltan)</p><p>当调用了<code class="command">OPEN</code>时，这允许<code class="command">DECLARE</code>使用范围之外的变量。
这个工具早已存在于<span class="application">ecpg</span>的Informix兼容模式中。</p></li><li class="listitem"><p>在<span class="application">ecpg</span>中允许动态游标名 (Boszormenyi Zoltan)</p></li><li class="listitem"><p>允许<span class="application">ecpg</span>在<code class="command">FETCH</code>和<code class="command">MOVE</code>中使用噪声字
<code class="literal">FROM</code>和<code class="literal">IN</code> (Boszormenyi Zoltan)</p></li></ul></div></div></div></div><div class="sect3" id="idp76063616"><div class="titlepage"><div><div><h4 class="title">E.131.3.10. 构建选项</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>默认启用客户端线程安全性 (Bruce Momjian)</p><p>线程安全性选项可以用<a class="link" href="install-procedure.html#CONFIGURE" title="配置"><code class="literal">configure</code></a>
<code class="option">--disable-thread-safety</code>禁用。</p></li><li class="listitem"><p>添加控制Linux内存不足杀手的支持 (Alex Hunsaker, Tom Lane)</p><p>现在<code class="filename">/proc/self/oom_adj</code>允许禁用<span class="productname">Linux</span>
内存不足（<acronym class="acronym">OOM</acronym>）杀手，推荐为postmaster禁用OOM杀手。
然后为postmaster的子进程重新启用OOM杀手就能满足需要了。
新的编译阶段选项<a class="link" href="kernel-resources.html#LINUX-MEMORY-OVERCOMMIT" title="18.4.4. Linux 内存过量使用"><code class="literal">LINUX_OOM_ADJ</code></a>
允许为子进程重新启用杀手。</p></li></ul></div><div class="sect4" id="idp76070608"><div class="titlepage"><div><div><h5 class="title">E.131.3.10.1. Makefiles</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>新增<code class="filename">Makefile</code>指标<a class="link" href="install-procedure.html#BUILD" title="编译"><code class="literal">world</code></a>、
<code class="literal">install-world</code>和<code class="literal">installcheck-world</code> (Andrew Dunstan)</p><p>这类似于现有的<code class="literal">all</code>、<code class="literal">install</code>和<code class="literal">installcheck</code>指标，
但是它们也构建<acronym class="acronym">HTML</acronym>文档，构建并测试<code class="filename">contrib</code>，
和测试服务器端语言和<span class="application">ecpg</span>。</p></li><li class="listitem"><p>添加数据和文档安装位置控制到<acronym class="acronym">PGXS</acronym> Makefiles (Mark Cave-Ayland)</p></li><li class="listitem"><p>添加Makefile规则，作为一个<acronym class="acronym">HTML</acronym>文件或者作为一个纯文本文件构建
<span class="productname">PostgreSQL</span>文档 (Peter Eisentraut, Bruce Momjian)</p></li></ul></div></div><div class="sect4" id="idp76081888"><div class="titlepage"><div><div><h5 class="title">E.131.3.10.2. Windows</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>支持在<a class="link" href="install-windows.html" title="第 17 章 在Windows上从源代码安装">64位<span class="productname">Windows</span></a>
上编译和在64位模式中运行 (Tsutomu Yamada, Magnus Hagander)</p><p>这允许<span class="productname">Windows</span>上大的共享内存大小。</p></li><li class="listitem"><p>支持服务器构建使用<a class="link" href="install-windows-full.html" title="17.1. 使用Visual C++或Microsoft Windows SDK构建"><span class="productname">Visual Studio 2008</span></a> (Magnus Hagander)</p></li></ul></div></div></div><div class="sect3" id="idp76087184"><div class="titlepage"><div><div><h4 class="title">E.131.3.11. 源代码</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>在子目录树中发布预建的文档，而不是作为发布的原始码中的tar归档文件 (Peter Eisentraut)</p><p>例如，预建的<acronym class="acronym">HTML</acronym>文档现在在<code class="filename">doc/src/sgml/html/</code>中；
手册页同样的方式打包。</p></li><li class="listitem"><p>使服务器的词法分析器可重入 (Tom Lane)</p><p>PL/pgSQL使用词法分析器需要这点。</p></li><li class="listitem"><p>提升内存分配的速度 (Tom Lane, Greg Stark)</p></li><li class="listitem"><p>用户定义的约束触发器现在在<code class="structname">pg_constraint</code>和
<code class="structname">pg_trigger</code>中都有记录了 (Tom Lane)</p><p>因为这个改变，<code class="structname">pg_constraint</code>.<code class="structfield">pgconstrname</code>
现在是多余的，并且已经删除了。</p></li><li class="listitem"><p>添加系统目录字段<code class="structname">pg_constraint</code>.<code class="structfield">conindid</code>
和<code class="structname">pg_trigger</code>.<code class="structfield">tgconstrindid</code>，
以便更好的为约束执行记录索引的使用 (Tom Lane)</p></li><li class="listitem"><p>允许使用单个操作系统信号传递多个条件到后端 (Fujii Masao)</p><p>这允许添加新的特性，不用管平台特定的信号条件的个数的约束。</p></li><li class="listitem"><p>提高源代码的测试覆盖率，包括<code class="filename">contrib</code>、PL/Python和PL/Perl 
(Peter Eisentraut, Andrew Dunstan)</p></li><li class="listitem"><p>删除系统表引导对平面文件的使用 (Tom Lane, Alvaro Herrera)</p><p>这提高了使用许多规则和数据库时的性能，并且消除了一些可能的故障条件。</p></li><li class="listitem"><p>为<span class="quote">“<span class="quote">引导</span>”</span>目录自动生成<code class="structname">pg_attribute</code>的初始内容 (John Naylor)</p><p>这大大的简化了到这些目录的更改。</p></li><li class="listitem"><p>分裂<code class="command">INSERT</code>/<code class="command">UPDATE</code>/<code class="command">DELETE</code>操作
<code class="filename">execMain.c</code>的进程 (Marko Tiikkaja)</p><p>现在在单独的ModifyTable节点中执行更新。这个更改对于未来的发展是必要的基础。</p></li><li class="listitem"><p>简化<span class="application">psql</span>的SQL帮助文本的翻译 (Peter Eisentraut)</p></li><li class="listitem"><p>减少某些文件名的长度，以便在发布的原始码中的所有文件路径都小于100个字符 (Tom Lane)</p><p>一些解压程序在长的文件路径上有问题。</p></li><li class="listitem"><p>添加新的<a class="link" href="errcodes-appendix.html#ERRCODES-TABLE" title="表 A.1. PostgreSQL错误代码"><code class="literal">ERRCODE_INVALID_PASSWORD</code></a> 
<code class="literal">SQLSTATE</code>错误代码 (Bruce Momjian)</p></li><li class="listitem"><p>经过作者的许可，删除少量剩余的个人源码版权声明 (Bruce Momjian)</p><p>个人版权声明是无关紧要的，但是社区偶尔不得不回答关于他们的问题。 </p></li><li class="listitem"><p>添加新的关于在非持久模式中运行<span class="productname">PostgreSQL</span>以提升性能的文档
<a class="link" href="non-durability.html" title="14.5. 非持久设置">章节</a> (Bruce Momjian)</p></li><li class="listitem"><p>重新构造<acronym class="acronym">HTML</acronym>文档<code class="filename">Makefile</code>规则，
以使它们的依赖性检查正确的工作，避免不必要的重建 (Peter Eisentraut)</p></li><li class="listitem"><p>为手册页的建立使用<span class="productname">DocBook</span> <acronym class="acronym">XSL</acronym>样式表，
而不是<span class="productname">Docbook2X</span> (Peter Eisentraut)</p><p>这改变了建立手册页需要的工具集。</p></li><li class="listitem"><p>改善PL/Perl代码结构 (Tim Bunce)</p></li><li class="listitem"><p>改进PL/Perl中的错误环境报告 (Alexey Klyukin)</p></li></ul></div><div class="sect4" id="idp76116304"><div class="titlepage"><div><div><h5 class="title">E.131.3.11.1. 新构建的需求</h5></div></div></div><p>请注意，从发布的原始码建立时没有应用这些需求，
因为原始码包括用于建立的这些程序的文件。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>需要<span class="application">Autoconf</span> 2.63建立<span class="application">configure</span> (Peter Eisentraut)</p></li><li class="listitem"><p>需要<span class="application">Flex</span> 2.5.31或更新版本从<acronym class="acronym">CVS</acronym>检查建立 (Tom Lane)</p></li><li class="listitem"><p>需要<span class="application">Perl</span>版本5.8或更新版本从<acronym class="acronym">CVS</acronym>检查建立 (John Naylor, Andrew Dunstan)</p></li></ul></div></div><div class="sect4" id="idp76122288"><div class="titlepage"><div><div><h5 class="title">E.131.3.11.2. 移植性</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>为<span class="application">Bonjour</span>使用更现代的<acronym class="acronym">API</acronym> (Tom Lane)</p><p>Bonjour支持现在需要<span class="productname">macOS</span> 10.3或更新版本。
老的API已经被Apple弃用了。</p></li><li class="listitem"><p>为<span class="productname">SuperH</span>体系结构添加自旋锁支持 (Nobuhiro Iwamatsu)</p></li><li class="listitem"><p>如果支持，则允许非<span class="application">GCC</span>编译器使用内联函数 (Kurt Harriman)</p></li><li class="listitem"><p>删除对没有运行64位整数数据类型的平台的支持 (Tom Lane)</p></li><li class="listitem"><p>调整<code class="literal">LDFLAGS</code>的使用，使其在平台间更加的一致 (Tom Lane)</p><p><code class="literal">LDFLAGS</code>现在用于连接可执行文件和共享库，我们在连接可执行文件时添加
<code class="literal">LDFLAGS_EX</code>，在连接共享库时添加<code class="literal">LDFLAGS_SL</code>。</p></li></ul></div></div><div class="sect4" id="idp76131888"><div class="titlepage"><div><div><h5 class="title">E.131.3.11.3. 服务器编程</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>使后端头文件安全的包含在<span class="productname">C++</span>中 (Kurt Harriman, Peter Eisentraut)</p><p>这些改变删除关键字冲突，这些冲突在以前使得<span class="productname">C++</span>在后端代码中使用困难。
不过，在为后端功能使用<span class="productname">C++</span>时，仍然有其他复杂性。
在适当的地方仍然需要<code class="literal">extern "C" { }</code>，内存管理和错误处理仍然是有问题的。</p></li><li class="listitem"><p>添加<a class="link" href="xaggr.html" title="37.10. 用户定义的聚集"><code class="function">AggCheckCallContext()</code></a>，
用于检测是否一个<span class="productname">C</span>函数被作为一个聚合调用 (Hitoshi Harada)</p></li><li class="listitem"><p>为<code class="function">SearchSysCache()</code>和相关的函数修改调用规范，
以避免硬线连接缓存键的最大数量 (Robert Haas)</p><p>现有的调用目前仍然可以工作，但是如果没有转变到新的风格，预计会在9.1或更新的版本中打断。</p></li><li class="listitem"><p>需要调用<code class="function">fastgetattr()</code>和<code class="function">heap_getattr()</code>
后端宏命令，以提供非NULL第四参数 (Robert Haas)</p></li><li class="listitem"><p>自定义typanalyze函数应该不再依赖于<code class="structname">VacAttrStats</code>.<code class="structfield">attr</code>
确定他们将要传送的数据的类型 (Tom Lane)</p><p>变为允许收集索引字段上的统计信息，该索引字段的存储类型不同于底层字段的数据类型。
有新的字段告诉我们被分析的实际的数据类型。</p></li></ul></div></div><div class="sect4" id="idp76143968"><div class="titlepage"><div><div><h5 class="title">E.131.3.11.4. 服务器 Hook</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加解析器hook处理ColumnRef和ParamRef节点 (Tom Lane)</p></li><li class="listitem"><p>添加处理实用程序hook，这样可加载的模块可以控制实用程序命令 (Itagaki Takahiro)</p></li></ul></div></div><div class="sect4" id="idp76145488"><div class="titlepage"><div><div><h5 class="title">E.131.3.11.5. 二进制升级支持</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加<a class="link" href="pgupgrade.html" title="pg_upgrade"><code class="filename">contrib/pg_upgrade</code></a>
支持在线升级 (Bruce Momjian)</p><p>这避免了升级到一个新的PostgreSQL主版本时转储/重载数据库的需要，
因此，通过数量级减少了停机时间。支持从PostgreSQL 8.3或8.4升级到9.0。</p></li><li class="listitem"><p>添加支持在二进制升级期间保存关系
<a class="link" href="catalog-pg-class.html" title="51.11. pg_class"><code class="structname">relfilenode</code></a>
值 (Bruce Momjian)</p></li><li class="listitem"><p>添加支持在二进制升级期间保存<code class="structname">pg_type</code>和<code class="structname">pg_enum</code> OIDs (Bruce Momjian)</p></li><li class="listitem"><p>移动表空间中的数据文件到<span class="productname">PostgreSQL</span>版本特定的子目录中 (Bruce Momjian)</p><p>这简化了二进制升级。</p></li></ul></div></div></div><div class="sect3" id="idp76152448"><div class="titlepage"><div><div><h4 class="title">E.131.3.12. 普通发布版</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>添加多线程选项(<code class="option">-j</code>)到
<a class="link" href="pgbench.html" title="pgbench"><code class="filename">contrib/pgbench</code></a> (Itagaki Takahiro)</p><p>这允许pgbench使用多个<acronym class="acronym">CPU</acronym>，降低pgbench本省成为测试障碍的风险。</p></li><li class="listitem"><p>添加<code class="command">\shell</code>和<code class="command">\setshell</code>元命令到
<a class="link" href="pgbench.html" title="pgbench"><code class="filename">contrib/pgbench</code></a> (Michael Paquier)</p></li><li class="listitem"><p>为<a class="link" href="dict-xsyn.html" title="F.13. dict_xsyn"><code class="filename">contrib/dict_xsyn</code></a>
新增特性 (Sergey Karpov)</p><p>新选项是<code class="literal">matchorig</code>，<code class="literal">matchsynonyms</code>和<code class="literal">keepsynonyms</code>。</p></li><li class="listitem"><p>添加全文本字典<a class="link" href="unaccent.html" title="F.44. unaccent"><code class="filename">contrib/unaccent</code></a> (Teodor Sigaev)</p><p>这个过滤的字典删除了字母的重（zhong）读，
使得多种语言上的全文本搜索更加简单。</p></li><li class="listitem"><p>添加<a class="link" href="contrib-dblink-get-notify.html" title="dblink_get_notify"><code class="function">dblink_get_notify()</code></a>
到<code class="filename">contrib/dblink</code> (Marcus Kempe)</p><p>这允许<span class="productname">dblink</span>中的异步通知。</p></li><li class="listitem"><p>改善<code class="filename">contrib/dblink</code>处理删除了的字段 (Tom Lane)</p><p>这影响了<a class="link" href="contrib-dblink-build-sql-insert.html" title="dblink_build_sql_insert"><code class="function">dblink_build_sql_insert()</code></a>
和相关的函数。这些函数现在根据逻辑而不是物理字段编号来编号字段。</p></li><li class="listitem"><p>大大的增加了<a class="link" href="hstore.html" title="F.17. hstore"><code class="filename">contrib/hstore</code></a>
的数据长度限制，并且增加了B-tree和哈希支持，所以在<code class="type">hstore</code>
字段上<code class="literal">GROUP BY</code>和<code class="literal">DISTINCT</code>操作成为可能 (Andrew Gierth)</p><p>也添加了新的函数和操作符。这些改进使得<code class="type">hstore</code>
一个功能完整键值存储嵌入到<span class="productname">PostgreSQL</span>中。</p></li><li class="listitem"><p>添加<a class="link" href="passwordcheck.html" title="F.24. passwordcheck"><code class="filename">contrib/passwordcheck</code></a>，
支持场地特定密码强度政策 (Laurenz Albe)</p><p>这个模块的源代码应该被修改为实现场地特定密码政策。</p></li><li class="listitem"><p>添加<a class="link" href="pgarchivecleanup.html" title="pg_archivecleanup"><code class="filename">contrib/pg_archivecleanup</code></a>
工具 (Simon Riggs)</p><p>目的是用于<code class="literal">archive_cleanup_command</code>服务器参数，
以删除不再需要的归档文件。</p></li><li class="listitem"><p>添加查询文本到<a class="link" href="auto-explain.html" title="F.4. auto_explain"><code class="filename">contrib/auto_explain</code></a>
输出 (Andrew Dunstan)</p></li><li class="listitem"><p>添加缓冲区访问计数到<a class="link" href="pgstatstatements.html" title="F.30. pg_stat_statements"><code class="filename">contrib/pg_stat_statements</code></a>
(Itagaki Takahiro)</p></li><li class="listitem"><p>更新<a class="link" href="server-start.html" title="18.3. 启动数据库服务器"><code class="filename">contrib/start-scripts/linux</code></a>，
以使用<code class="filename">/proc/self/oom_adj</code>禁用<a class="link" href="kernel-resources.html#LINUX-MEMORY-OVERCOMMIT" title="18.4.4. Linux 内存过量使用"><span class="productname">Linux</span>内存溢出</a> (<acronym class="acronym">OOM</acronym>)杀手 (Alex Hunsaker, Tom Lane)</p></li></ul></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-9-0-1.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="release.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="release-8-4-22.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">E.130. 版本 9.0.1 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> E.132. 版本 8.4.22</td></tr></table></div></body></html>
