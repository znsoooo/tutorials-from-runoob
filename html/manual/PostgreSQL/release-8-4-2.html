<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>E.152. 版本8.4.2</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="release-8-4-3.html" title="E.151. 版本8.4.3" /><link rel="next" href="release-8-4-1.html" title="E.153. 版本8.4.1" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">E.152. 版本8.4.2</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="release-8-4-3.html" title="E.151. 版本8.4.3">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="release.html" title="附录 E. 版本说明">上一级</a></td><th width="60%" align="center">附录 E. 版本说明</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.1 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="release-8-4-1.html" title="E.153. 版本8.4.1">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="RELEASE-8-4-2"><div class="titlepage"><div><div><h2 class="title" style="clear: both">E.152. 版本8.4.2</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="release-8-4-2.html#idp77176048">E.152.1. 迁移到版本8.4.2</a></span></dt><dt><span class="sect2"><a href="release-8-4-2.html#idp77177696">E.152.2. 变化</a></span></dt></dl></div><p><strong>发布日期：. </strong>2009-12-14</p><p>     该发布包含来自8.4.1的各种修复。关于8.4主要发布中的新特性信息，
 参阅<a class="xref" href="release-8-4.html" title="E.154. 版本8.4">第 E.154 节</a>。</p><div class="sect2" id="idp77176048"><div class="titlepage"><div><div><h3 class="title">E.152.1. 迁移到版本8.4.2</h3></div></div></div><p>    运行8.4.X不需要备份/恢复。然而，如果有任何散列索引，在更新到8.4.2之后你应该
<code class="command">REINDEX</code>它们，以修复可能受损。</p></div><div class="sect2" id="idp77177696"><div class="titlepage"><div><div><h3 class="title">E.152.2. 变化</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>   防止通过索引函数改变会话局部状态引起的间接安全威胁(Gurjeet Singh, Tom)</p><p>    这一变化防止不变的索引函数打断超级用户会话(CVE-2009-4136)。</p></li><li class="listitem"><p>    拒绝在普通名字（CN）字段中包含嵌入的空字节的SSL证书(Magnus)</p><p>    这避免在SSL认证期间来自服务器或者客户端名字的证书的意外匹配(CVE-2009-4034)。</p></li><li class="listitem"><p>    修复散列索引损坏(Tom)</p><p>
     该8.4变化使得散列索引保持通过散列值未能更新大量分裂和紧缩程序以保持排序的项。
所以这些操作的任何应用程序可能导致索引的永久性损坏，在这个意义上，
搜索可能无法找到存在的项。为了处理这个，推荐你已安装此更新后<code class="literal">REINDEX</code>任何散列索引。
</p></li><li class="listitem"><p>    修复后台启动时缓存初始化期间可能崩溃(Tom)</p></li><li class="listitem"><p>    避免空的同义词词典崩溃(Tom)</p></li><li class="listitem"><p>    避免在不安全时间中断<code class="literal">VACUUM</code>信号(Alvaro)</p><p>      如果已经坚定元组动作之后取消了<code class="literal">VACUUM FULL</code>，该修复阻止PANIC。
  如果在截断该表之后中断普通的<code class="literal">VACUUM</code>，阻止瞬态错误。?
     </p></li><li class="listitem"><p>    由于在哈希表大小计算中整数溢出，修复可能崩溃(Tom)</p><p>    这可能发生大的规划器评估哈希连接结果。</p></li><li class="listitem"><p>    如果在内部依赖对象上尝试<code class="literal">DROP</code>，修复崩溃(Tom)</p></li><li class="listitem"><p>    修复<code class="type">inet</code>/<code class="type">cidr</code>比较中稀少崩溃现象(Chris Mikkelson)</p></li><li class="listitem"><p>    确保不忽略通过预备事务持有的共享元组级别锁(Heikki)</p></li><li class="listitem"><p>     修复用于在子事务中访问的游标临时文件的提早删除(Heikki) </p></li><li class="listitem"><p>     当旋转到新的CSV日志文件时，修复syslogger处理中内存泄露(Tom)</p></li><li class="listitem"><p>      当重新解析<code class="filename">pg_hba.conf</code>的时候，修复postmaster中的内存泄露(Tom)</p></li><li class="listitem"><p>    修复Windows权限下降逻辑(Jesse Morris)</p><p>    这修复了数据库在Windows上启动失败的一些情况，
通常带有误导性错误消息比如<span class="quote">“<span class="quote">不能定位匹配postgres可执行程序</span>”</span>。</p></li><li class="listitem"><p>    使得在主查询中<code class="literal">FOR UPDATE/SHARE</code>不扩大到<code class="literal">WITH</code>查询中(Tom)</p><p>  比如，在
</p><pre class="programlisting">WITH w AS (SELECT * FROM foo) SELECT * FROM w, bar ... FOR UPDATE</pre><p>

  <code class="literal">FOR UPDATE</code>将影响<code class="literal">bar</code>而不是<code class="literal">foo</code>。
  这比原来8.4操作更有用而且更加一致，  
  尝试扩散<code class="literal">FOR UPDATE</code>到<code class="literal">WITH</code>查询中，
  但是却总是失败，因为匹配实现限制。它也遵循设计规则，如果主查询独立，执行<code class="literal">WITH</code>查询。

     </p></li><li class="listitem"><p>     修复在另外一个中使用<code class="literal">WITH RECURSIVE</code>查询的错误(Tom)</p></li><li class="listitem"><p>    修复散列索引的并发错误(Tom)</p><p>    并发插入可能导致索引扫描瞬时报告错误结果。</p></li><li class="listitem"><p>     当分割取决于索引的非首列时，修复GiST索引页分割错误逻辑(Paul Ramsey)</p></li><li class="listitem"><p>     修复为多列GIN索引使用<code class="literal">fastupdate</code>激活的错误搜索结果(Teodor)</p></li><li class="listitem"><p>    修复GIN索引WAL项创建中的错误(Tom)</p><p>     当<code class="varname">full_page_writes</code>为on的时候，这些错误被隐藏，但是如果在下一个检查点之前发生崩溃，
 那么关闭WAL回放错误是一定的。</p></li><li class="listitem"><p>    如果在检查点结尾回收或者删除旧的WAL文件失败，不要出错误(Heikki)</p><p>     更好地将这个问题作为非致命性的并且允许完成检查点。未来的检查点将重试取消。
 这样的问题没有预期的正常运行，但通过错误设计Windows杀毒和备份软件造成的。</p></li><li class="listitem"><p>    确保Windows上WAL文件不再被重复归档(Heikki)</p><p>    如果其他过程干扰不再需要的文件的删除，这可能发生另外一种情况。</p></li><li class="listitem"><p>    修复PAM密码处理更加鲁棒性(Tom)</p><p>    上面的代码伴随着Linux <code class="literal">pam_krb5</code> PAM模块与作为域控制器的Microsoft动态目录结合而失败。
    它可能还有其他问题，因为它采用关于PAM堆栈传递给它什么参数的不合理假设。  </p></li><li class="listitem"><p>    提高GSSAPI和SSPI认证方法中最大认证令牌(Kerberos ticket)大小(Ian Turner)</p><p>    当为Unix Kerberos 实现有足够多的旧的2000字节限制时，
通过Windows 域控制器发出标签可以更大。</p></li><li class="listitem"><p>    确保域约束在<code class="literal">ARRAY[...]::domain</code>结构中被强制，其中域不在数值类型中(Heikki)</p></li><li class="listitem"><p>    
修复为涉及复合类型列作为外键的情况中的外键逻辑(Tom)</p></li><li class="listitem"><p>    确保游标的快照在被创建后不被修改(Alvaro)</p><p>     如果在同一事务中后续操作修改数据，这可能导致游标传递错误结果，应该返回游标。</p></li><li class="listitem"><p>    修复<code class="literal">CREATE TABLE</code>以正确合并来自不同继承父表的缺省表达式(Tom)</p><p>   这用于运行，但在8.4中被损坏。</p></li><li class="listitem"><p>    重新启用序列访问统计收集(Akira Kurosawa)</p><p>   这用于运行，但在8.3中被损坏。</p></li><li class="listitem"><p>    修复<code class="literal">CREATE OR REPLACE FUNCTION</code>中所有依赖的处理(Tom)</p></li><li class="listitem"><p>    修复<code class="literal">WHERE</code><em class="replaceable"><code>x</code></em>=<em class="replaceable"><code>x</code></em>条件的错误处理(Tom)</p><p>     在某些情况下，可以作为冗余忽略，但是它们不是—
 它们等价于<em class="replaceable"><code>x</code></em> <code class="literal">IS NOT NULL</code>。</p></li><li class="listitem"><p>    当为文本相同易变表达式使用哈希聚合实现<code class="literal">DISTINCT</code>的时候，
     修复不正确规划结构(Tom)</p></li><li class="listitem"><p>     修复易变<code class="literal">SELECT DISTINCT ON</code>表达式的断言错误(Tom)</p></li><li class="listitem"><p>     修复<code class="function">ts_stat()</code>而在空的<code class="type">tsvector</code>值上不失败(Tom)</p></li><li class="listitem"><p>   使得文本搜索解析器接受XML属性中下划线(Peter)</p></li><li class="listitem"><p>    修复<code class="type">xml</code>二进制输入中编码处理(Heikki)</p><p>     如果XML头没有指定编码，我们现在假设缺省UTF-8；先前处理是不一致的。</p></li><li class="listitem"><p>     修复从<code class="literal">plperlu</code>调用<code class="literal">plperl</code>的错误，反之亦然(Tom)</p><p>     从内部函数退出的错误可能导致崩溃，由于该错误为外部函数重新选择正确的Perl解释器。</p></li><li class="listitem"><p>     当重新定义PL/Perl函数的时候，修复会话存在期内存泄露(Tom)</p></li><li class="listitem"><p>    当通过集合返回PL/Perl函数返回时，确保Perl数组正确转换为<span class="productname">PostgreSQL</span>数组(Andrew Dunstan, Abhijit Menon-Sen)</p><p>    这些正常运行都为了非集合返回函数。</p></li><li class="listitem"><p>    修复PL/Python中异常处理的罕见崩溃(Peter)</p></li><li class="listitem"><p>    修复<code class="literal">DECLARE CURSOR</code>语句中注释的<span class="application">ecpg</span>问题(Michael)</p></li><li class="listitem"><p>    修复<span class="application">ecpg</span>不把最近添加的关键字作为保留字(Tom)</p><p>     这影响了关键字<code class="literal">CALLED</code>, <code class="literal">CATALOG</code>,
      <code class="literal">DEFINER</code>, <code class="literal">ENUM</code>, <code class="literal">FOLLOWING</code>,
      <code class="literal">INVOKER</code>, <code class="literal">OPTIONS</code>, <code class="literal">PARTITION</code>,
      <code class="literal">PRECEDING</code>, <code class="literal">RANGE</code>, <code class="literal">SECURITY</code>,
      <code class="literal">SERVER</code>, <code class="literal">UNBOUNDED</code>和<code class="literal">WRAPPER</code>。</p></li><li class="listitem"><p>    重新允许<span class="application">psql</span>的<code class="literal">\df</code>函数名字参数中的正则表达式特殊字符(Tom)</p></li><li class="listitem"><p>     在<code class="filename">contrib/fuzzystrmatch</code>中，纠正非缺省成本<code class="function">levenshtein</code>距离计算(Marcin Mank)</p></li><li class="listitem"><p>   在<code class="filename">contrib/pg_standby</code>中，禁用Windows上带有信号触发器转移(Fujii Masao)</p><p>    这没有什么有用的，因为Windows没有Unix风格讯号，但是最近变化确实崩溃。</p></li><li class="listitem"><p>    将<code class="literal">FREEZE</code> and <code class="literal">VERBOSE</code>选项以正确顺序放置在<code class="filename">contrib/vacuumdb</code>产生的
<code class="literal">VACUUM</code>命令中(Heikki)</p></li><li class="listitem"><p>     当<code class="filename">contrib/dblink</code>遇到错误的时候，修复链接的可能泄露(Tatsuhito Kasahara)</p></li><li class="listitem"><p>     确保<span class="application">psql</span>的flex模块与正确系统标题定义一起被编译(Tom)</p><p>   这将修复平台上的编译错误，其中<code class="literal">--enable-largefile</code>在产生代码中导致的
   不兼容变化。</p></li><li class="listitem"><p>      使得postmaster忽略任何连接请求包中的<code class="literal">application_name</code>参数，
  以优化与未来libpq版本的兼容(Tom)</p></li><li class="listitem"><p>     更新时区缩写文件以匹配当前实际情况(Joachim Wieland)</p><p>   这包含添加<code class="literal">IDT</code>到缺省时区缩写设置。</p></li><li class="listitem"><p>     为了Antarctica, Argentina, Bangladesh, Fiji,
      Novokuznetsk, Pakistan, Palestine, Samoa, Syria中DST变化规律更新时区数据文件到
  <span class="application">tzdata</span>发布2009s。也为了Hong Kong历史纠正。</p></li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-8-4-3.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="release.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="release-8-4-1.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">E.151. 版本8.4.3 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> E.153. 版本8.4.1</td></tr></table></div></body></html>
