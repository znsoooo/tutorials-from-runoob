<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>E.149. 版本8.4.5</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="release-8-4-6.html" title="E.148. 版本8.4.6" /><link rel="next" href="release-8-4-4.html" title="E.150. 版本8.4.4" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">E.149. 版本8.4.5</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="release-8-4-6.html" title="E.148. 版本8.4.6">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="release.html" title="附录 E. 版本说明">上一级</a></td><th width="60%" align="center">附录 E. 版本说明</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.1 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="release-8-4-4.html" title="E.150. 版本8.4.4">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="RELEASE-8-4-5"><div class="titlepage"><div><div><h2 class="title" style="clear: both">E.149. 版本8.4.5</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="release-8-4-5.html#idp76969776">E.149.1. 迁移到版本8.4.5</a></span></dt><dt><span class="sect2"><a href="release-8-4-5.html#idp76971344">E.149.2. 变化</a></span></dt></dl></div><p><strong>发布日期：. </strong>2010-10-04</p><p>    该发布包含来自8.4.4中的各种修复。
关于8.4主要版本的新功能的各种信息，参阅<a class="xref" href="release-8-4.html" title="E.154. 版本8.4">第 E.154 节</a>。
</p><div class="sect2" id="idp76969776"><div class="titlepage"><div><div><h3 class="title">E.149.1. 迁移到版本8.4.5</h3></div></div></div><p>      运行8.4.X不需要备份/恢复。然而，如果你从8.4.2的早期版本升级，
  参阅<a class="xref" href="release-8-4-2.html" title="E.152. 版本8.4.2">第 E.152 节</a>。</p></div><div class="sect2" id="idp76971344"><div class="titlepage"><div><div><h3 class="title">E.149.2. 变化</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>     为每个调用PL/Perl和PL/Tcl中SQL userid使用独立解释器(Tom Lane)</p><p>
    这种变化可以防止通过颠覆随后在同一会话中另一个SQL用户身份下执行的Perl或Tcl代码造成的安全问题
（例如，在<code class="literal">SECURITY DEFINER</code>函数中）。
大多数的脚本语言提供了可以执行的众多方法，
如重新定义标准函数或目标函数运算符。没有这种变化的话，任何拥有Perl或Tcl语言使用权的SQL用户
可以执行拥有目标函数所有者的SQL权限应该做的事情。 
  </p><p>     这种变化的成本是在Perl和Tcl函数之间沟通意图变得更加困难。
 为了提供一个逃生出口，PL/PerlU和PL/TclU函数继续每个会话中仅仅使用一个解释器。
     这没有考虑安全问题，因为在数据库超级用户的信任级别上执行所有这些函数。</p><p>     可能声称提供可信执行程序的第三方程序语言有类似的安全问题。
     我们建议你依赖安全关键用途联系任何PL的作者。      </p><p>     我们应该感谢Tim Bunce提出这个问题(CVE-2010-3433)。</p></li><li class="listitem"><p>     防止<code class="function">pg_get_expr()</code>中可能的事故，
 通过禁止适合与不是一个系统目录列之一的参数一起使用。(Heikki Linnakangas, Tom Lane) </p></li><li class="listitem"><p>    处理退出代码128(<code class="literal">ERROR_WAIT_NO_CHILDREN</code>)作为Windows上非致命的(Magnus Hagander)</p><p>     在高负荷的情况下，Windows进程在使用错误码启动过程失败。
之前postmaster把这个看作恐慌条件并且重新启动整个数据库，但这似乎是反应过度。
</p></li><li class="listitem"><p>    修复占位符赋值不正确位置(Tom Lane)</p><p>    当它们本应是空的时候，这个错误可能导致查询输出非空。
在该情况下，输出列表非严格的表达式下外部连接的内部是一个子选择。</p></li><li class="listitem"><p>     修复<code class="literal">UNION ALL</code>成员关系可能的重复扫描(Tom Lane)</p></li><li class="listitem"><p>      修复<span class="quote">“<span class="quote">不能处理非计划子查询</span>”</span>错误(Tom Lane)</p><p>     当包含连接别名参考的子查询扩展到含有另一个子选择的表达式中时，发生这种情况。</p></li><li class="listitem"><p>    修复引用视图或出现在嵌套子查询中的子选择的整列变量的不当处理(Tom Lane)      </p></li><li class="listitem"><p>     修复交叉类型<code class="literal">IN</code>比较的处理不当(Tom Lane)</p><p>    如果规划器试图实现使用分类然后唯一的完全连接计划的<code class="literal">IN</code>连接。 </p></li><li class="listitem"><p>  修复统计<code class="type">tsvector</code>列的<code class="command">ANALYZE</code>的计算(Jan Urbanski)</p><p>     最初代码可以产生不正确统计，导致之后错误规划选择。</p></li><li class="listitem"><p>    优化通过<code class="function">array_agg()</code>，
<code class="function">string_agg()</code>和类似聚合函数使用的内存的规划器估计(Hitoshi Harada)</p><p>    以往过低估计可以导致内存不足错误，由于哈希聚合规划不恰当的选择。</p></li><li class="listitem"><p> 
      修复标记缓存计划是短暂的错误(Tom Lane)</p><p>    当<code class="command">CREATE INDEX CONCURRENTLY</code>在进展中作为一个参考表，如果已准备好一个规划，
一旦索引是现成的，它应该重新被规划。这是不会发生的。</p></li><li class="listitem"><p>在一些偶然报道btree失败的案例中减少PANIC到ERROR，
并提供产生错误消息中的额外的细节。</p><p>    这可以优化使用错误索引的系统的鲁棒性。</p></li><li class="listitem"><p>     修复GIN索引部分匹配查询的错误搜索逻辑(Tom Lane)</p><p>    涉及一些GIN索引条件的AND/OR组合情况不总是给出正确答案，
有时候比必要情况慢的多。</p></li><li class="listitem"><p>     防止autovacuum进程中show_session_authorization()的崩溃(Tom Lane)</p></li><li class="listitem"><p>    并不是所有返回行都是同一rowtype的地方防范函数返回集合记录(Tom Lane)</p></li><li class="listitem"><p>     修复在子事务回滚期间待定触发器事件列表的可能损坏(Tom Lane)</p><p>    这可能导致崩溃或者错误触发触发器。</p></li><li class="listitem"><p>     当散列按引用传递函数结果时，修复可能错误(Tao Ma, Tom Lane)</p></li><li class="listitem"><p>      优化join列中NULL的合并连接处理(Tom Lane)</p><p>     如果排序顺序是NULL排序高，那么合并连接可以完全停止到达第一个NULL。</p></li><li class="listitem"><p>    当写入它们时，注意fsync锁文件内容（<code class="filename">postmaster.pid</code>和socket锁文件）(Tom Lane)</p><p>      如果在postmaster启动之后不久该机器崩溃，那么该忽略可能导致损坏的锁文件内容。
  反过来又可以防止后续尝试启动postmaster，直到手动删除锁定文件。</p></li><li class="listitem"><p>    当分配XID给严重嵌套子事务时，避免递归(Andres Freund, Robert Haas)</p><p>    如果有有限的堆栈空间，初始编码可能导致崩溃。</p></li><li class="listitem"><p>     避免在walwriter过程中保持开放旧的WAL段(Magnus Hagander, Heikki Linnakangas)</p><p>    先前编码可以防止删除不再需要部分。</p></li><li class="listitem"><p>      修复<code class="varname">log_line_prefix</code>'s <code class="literal">%i</code>转义，这在
  后台启动早期时会产生垃圾(Tom Lane)</p></li><li class="listitem"><p>      避免为TOAST表部分指定的关系选项的曲解(Itagaki Takahiro)</p><p>     特别是，<code class="literal">fillfactor</code>会被读为零，
 如果任何其他reloption已经为该表设置，导致严重的膨胀。</p></li><li class="listitem"><p>     修复<code class="command">ALTER TABLE ... ADD CONSTRAINT</code>中继承计数跟踪(Robert Haas)</p></li><li class="listitem"><p>    当启用归档时，修复<code class="command">ALTER TABLE ... SET TABLESPACE</code>中可能的数据损坏(Jeff Davis)</p></li><li class="listitem"><p>    允许<code class="command">CREATE DATABASE</code>和<code class="command">ALTER DATABASE ... SET TABLESPACE</code>
被查询取消中断(Guillaume Lelarge)</p></li><li class="listitem"><p>    改善<code class="command">CREATE INDEX</code>对被推荐索引表达式是否可以改变的检测(Tom Lane)</p></li><li class="listitem"><p>     修复<code class="command">REASSIGN OWNED</code>以处理算子类和族(Asko Tiidumaa)</p></li><li class="listitem"><p>     当比较两个空的<code class="type">tsquery</code>值的时候，修复可能的核心转储(Tom Lane)</p></li><li class="listitem"><p>     修复模式中包含<code class="literal">%</code>伴随<code class="literal">_</code>的<code class="literal">LIKE</code>的处理(Tom Lane)</p><p>    我们之前已经修复，但是仍存在一些不正确处理的情况。</p></li><li class="listitem"><p>    重新允许Julian日期输入追溯到0001-01-01 AD (Tom Lane)</p><p>    在8.4之前输入比如<code class="literal">'J100000'::date</code>，但是通过添加的错误检查无意打破。</p></li><li class="listitem"><p>    如果在遍历游标的<code class="literal">FOR</code>循环中关闭游标，修复PL/pgSQL抛出一个错误，不会崩溃。    </p></li><li class="listitem"><p>     在PL/Python中，抵御来自<code class="function">PyCObject_AsVoidPtr</code>和<code class="function">PyCObject_FromVoidPtr</code>
 的空指针结果(Peter Eisentraut)</p></li><li class="listitem"><p>    在<span class="application">libpq</span>中，当指定<code class="literal">host</code>和<code class="literal">hostaddr</code>的时候，修复
完整SSL证书验证。</p></li><li class="listitem"><p>     使得psql将<code class="command">DISCARD ALL</code>看做在自动提交关闭模式中不应该封装在事务块中的命令(Itagaki Takahiro)</p></li><li class="listitem"><p>    修复SQL/MED对象<span class="application">pg_dump</span>的处理中的一些问题(Tom Lane)</p><p>    值得注意的是，如果通过非超级用户执行，<span class="application">pg_dump</span>总是失败，
它并不打算这样。</p></li><li class="listitem"><p>    优化非可查找归档文件的<span class="application">pg_dump</span>和<span class="application">pg_restore</span>的处理(Tom Lane, Robert Haas)</p><p>    对于并行转储的正常运作很重要。</p></li><li class="listitem"><p>     提高并行pg_restore处理选择性转储(<code class="literal">-L</code> option)的能力(Tom Lane)</p><p>   如果<code class="literal">-L</code>文件命令非缺省转储顺序，那么原代码可能失败。</p></li><li class="listitem"><p>    修复<span class="application">ecpg</span>正确处理来自<code class="literal">RETURNING</code>子句的数据(Michael Meskes)</p></li><li class="listitem"><p>     修复<span class="application">ecpg</span>中的一些内存泄露(Zoltan Boszormenyi)</p></li><li class="listitem"><p>      优化包含已删除列的表的<code class="filename">contrib/dblink</code>的处理(Tom Lane)</p></li><li class="listitem"><p>     修复<code class="filename">contrib/dblink</code>中<span class="quote">“<span class="quote">重复连接名</span>”</span>错误之后的连接泄露(Itagaki Takahiro)</p></li><li class="listitem"><p>     修复<code class="filename">contrib/dblink</code>以正确处理超过62字节的连接名(Itagaki Takahiro)</p></li><li class="listitem"><p>    添加<code class="function">hstore(text, text)</code>函数到<code class="filename">contrib/hstore</code> (Robert Haas)</p><p>     
     该函数是为了现在不使用的<code class="literal">=&gt;</code>操作符的推荐替代者。 
它后面打补丁，以便适应未来代码可用于旧的服务器版本。 
请注意，该补丁仅仅在安装<code class="filename">contrib/hstore</code>或
重新安装在一个特定的数据库中有效。
用户可能更愿意手动执行<code class="command">CREATE FUNCTION</code>命令来代替。</p></li><li class="listitem"><p>     更新基础设施建设和文档以反映来自CVS到Git的源代码存储库的移动(Magnus Hagander and others)</p></li><li class="listitem"><p>    为了Egypt和Palestine中DST变化规律更新时区数据文件到<span class="application">tzdata</span>发布2010l；
也是出于Finland的历史修正。</p><p>    这种变化还为两个Micronesian时区添加了新的名字：Pacific/Chuuk目前优于Pacific/Truk（并且首选缩写是CHUT而不是TRUT）
并且Pacific/Pohnpei优于Pacific/Ponape。</p></li><li class="listitem"><p>    使得Windows的<span class="quote">“<span class="quote">N. Central Asia Standard Time</span>”</span>时区映射到Asia/Novosibirsk，而不是Asia/Almaty (Magnus Hagander)</p><p>     Microsoft改变来自KB976098的时区更新中的该区域的DST操作。
 Asia/Novosibirsk是对于新操作的更好匹配。</p></li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-8-4-6.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="release.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="release-8-4-4.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">E.148. 版本8.4.6 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> E.150. 版本8.4.4</td></tr></table></div></body></html>
