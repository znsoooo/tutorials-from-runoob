<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>E.127. 版本 9.0.4</title><link rel="stylesheet" type="text/css" href="../../0/stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="release-9-0-5.html" title="E.126. 版本 9.0.5" /><link rel="next" href="release-9-0-3.html" title="E.128. 版本 9.0.3" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">E.127. 版本 9.0.4</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="release-9-0-5.html" title="E.126. 版本 9.0.5">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="release.html" title="附录 E. 版本说明">上一级</a></td><th width="60%" align="center">附录 E. 版本说明</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10.1 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="release-9-0-3.html" title="E.128. 版本 9.0.3">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="RELEASE-9-0-4"><div class="titlepage"><div><div><h2 class="title" style="clear: both">E.127. 版本 9.0.4</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="release-9-0-4.html#idp75397392">E.127.1. 迁移到版本 9.0.4</a></span></dt><dt><span class="sect2"><a href="release-9-0-4.html#idp75401584">E.127.2. 修改刘表</a></span></dt></dl></div><p><strong>发布日期：. </strong>2011-04-18</p><p>这个版本包含各种自9.0.3以来的修复。要想获取9.0主版本的新特性信息，
请参阅<a class="xref" href="release-9-0.html" title="E.131. 版本 9.0">第 E.131 节</a>。</p><div class="sect2" id="idp75397392"><div class="titlepage"><div><div><h3 class="title">E.127.1. 迁移到版本 9.0.4</h3></div></div></div><p>运行9.0.X版本的用户不需要转储/恢复。</p><p>不过，如果您的安装是通过运行<span class="application">pg_upgrade</span>从一个先前的主版本升级而来，
您应该采取措施防止由于<span class="application">pg_upgrade</span>中一个现在修复的bug引起可能的数据丢失。
建议的解决方案是在所有的TOAST表上运行<code class="command">VACUUM FREEZE</code>。
更多信息可以参考<a class="ulink" href="http://wiki.postgresql.org/wiki/20110408pg_upgrade_fix" target="_top">    http://wiki.postgresql.org/wiki/20110408pg_upgrade_fix</a>。</p></div><div class="sect2" id="idp75401584"><div class="titlepage"><div><div><h3 class="title">E.127.2. 修改刘表</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>修复<span class="application">pg_upgrade</span>对TOAST表的处理 (Bruce Momjian)</p><p>在<span class="application">pg_upgrade</span>期间，TOAST表的<code class="structname">pg_class</code>.<code class="structfield">relfrozenxid</code>
值没有正确的拷贝到新的安装中。这可能稍后导致他们仍然需要在TOAST表中验证元组时，
<code class="literal">pg_clog</code>文件被丢弃，导致<span class="quote">“<span class="quote">could not access status of transaction</span>”</span>失败。</p><p>这个错误造成了用<span class="application">pg_upgrade</span>升级的安装的数据丢失的重大风险。
这个补丁纠正了将来使用<span class="application">pg_upgrade</span>的问题，
但是没有本质上解决已经用错误版本的<span class="application">pg_upgrade</span>处理过的安装中的问题。</p></li><li class="listitem"><p>废止错误的<span class="quote">“<span class="quote">PD_ALL_VISIBLE flag was incorrectly set</span>”</span>警告 (Heikki Linnakangas)</p><p><code class="command">VACUUM</code>有时会发出这个警告，实际上是有效的。</p></li><li class="listitem"><p>为热备份冲突情况使用更好的SQLSTATE错误代码 (Tatsuo Ishii and Simon Riggs)</p><p>所有可重试的冲突错误现在有一段错误代码表明重试是可能的。另外，
由于数据库在master上删除引起的会话关闭现在报告为<code class="literal">ERRCODE_DATABASE_DROPPED</code>，
而不是<code class="literal">ERRCODE_ADMIN_SHUTDOWN</code>，所以连接池能正确的处理该情形。</p></li><li class="listitem"><p>防止间歇性挂在启动进程和后端写进程的交互中 (Simon Riggs)</p><p>这影响在非热备份情况下的恢复。</p></li><li class="listitem"><p>不允许包括复合类型本身 (Tom Lane)</p><p>这阻止了在服务器中处理复合类型时会无限递归的情形。当可能有一些这样的机构的使用时，
它们似乎不能足够令人信服的证明所需要的努力，以确保它总是安全的工作。</p></li><li class="listitem"><p>在目录缓存初始化期间避免潜在的死锁 (Nikhil Sontakke)</p><p>在某些情况下，缓存加载代码在锁住索引的目录之前会在系统索引上请求共享锁。
这可能会死锁对进程试图请求其他独占锁，更标准的顺序。</p></li><li class="listitem"><p>修复当有并发更新到目标元组时<code class="literal">BEFORE ROW UPDATE</code>触发器处理中的悬空指针问题 (Tom Lane)</p><p>观察到这个错误在试图做<code class="literal">UPDATE RETURNING ctid</code>时，
会导致间歇性的 <span class="quote">“<span class="quote">cannot extract system attribute from virtual tuple</span>”</span>失败。
有一个非常小的概率会发生更严重的错误，如为更新的元组生成不正确的索引条目。</p></li><li class="listitem"><p>当等待一个表的延迟触发的事件时，不允许<code class="command">DROP TABLE</code> (Tom Lane)</p><p>以前的<code class="command">DROP</code>会通过，导致触发器最终触发时的
<span class="quote">“<span class="quote">could not open relation with OID nnn</span>”</span>错误。</p></li><li class="listitem"><p>在<code class="filename">pg_hba.conf</code>中允许<span class="quote">“<span class="quote">replication</span>”</span>作为一个用户名 (Andrew Dunstan)</p><p><span class="quote">“<span class="quote">replication</span>”</span>在数据库名字字段中是特殊的，但是它在用户名字段中被错误的认为也是特殊的。</p></li><li class="listitem"><p>阻止GEQO最优化期间由WHERE条件常量错误触发的崩溃 (Tom Lane)</p></li><li class="listitem"><p>改善规划者处理半连接和反连接的情况 (Tom Lane)</p></li><li class="listitem"><p>修复子SELECT中<code class="literal">SELECT FOR UPDATE</code>的处理 (Tom Lane)</p><p>这个错误通常导致<span class="quote">“<span class="quote">cannot extract system attribute from virtual tuple</span>”</span>错误。</p></li><li class="listitem"><p>修复文本搜索的选择性估计以计算NULL (Jesper Krogh)</p></li><li class="listitem"><p>修复get_actual_variable_range()以支持通过索引指导插件假设的索引注入 (Gurjeet Singh)</p></li><li class="listitem"><p>修复包含数组分片的PL/Python内存泄露 (Daniel Popowich)</p></li><li class="listitem"><p>当用户的根目录不可用时允许<span class="application">libpq</span>的SSL成功初始化 (Tom Lane)</p><p>如果是SSL模式，那么根证书文件不是必须的，也就不需要失败。
这个改变恢复到9.0之前版本的行为。</p></li><li class="listitem"><p>修复<span class="application">libpq</span>为在<code class="function">conninfo_array_parse</code>
中检测到的错误返回有用的错误消息 (Joseph Adams)</p><p>打字错误导致库返回NULL给应用，而不是包含错误消息的<code class="structname">PGconn</code>构成。</p></li><li class="listitem"><p>修复<span class="application">ecpg</span>预处理器对浮点数常量的处理 (Heikki Linnakangas)</p></li><li class="listitem"><p>修复并发的<span class="application">pg_restore</span>以正确的处理POST_DATA条目上的注释 (Arnd Hannemann)</p></li><li class="listitem"><p>修复<span class="application">pg_restore</span>以处理TOC文件中较长的行（超过 1KB） (Tom Lane)</p></li><li class="listitem"><p>针对由过度热情的编译器优化和被零除引起的崩溃投入更多的保障 (Aurelien Jarno)</p></li><li class="listitem"><p>支持在MIPS上的FreeBSD和OpenBSD中使用dlopen() (Tom Lane)</p><p>有一个硬链接假设这个系统功能在这些系统的MIPS硬件上不可用。
那么使用一个编译时测试，因为最近的版本有这个功能。</p></li><li class="listitem"><p>修复HP-UX上的编译错误 (Heikki Linnakangas)</p></li><li class="listitem"><p>避免在启动过程中非常早的尝试写入Windows控制台时的崩溃 (Rushabh Lathia)</p></li><li class="listitem"><p>支持为Windows用MinGW 64位编译器建立 (Andrew Dunstan)</p></li><li class="listitem"><p>修复Windows上<span class="application">libintl</span>的版本不兼容问题 (Hiroshi Inoue)</p></li><li class="listitem"><p>修复<span class="application">xcopy</span>在Windows生成脚本中的使用，以在Windows 7下正确的运转 (Andrew Dunstan)</p><p>这只影响生成脚本，不影响安装或使用。</p></li><li class="listitem"><p>修复在Cygwin上被<span class="application">pg_regress</span>使用的路径分隔符 (Andrew Dunstan)</p></li><li class="listitem"><p>更新时区数据文件到<span class="application">tzdata</span>版本2011f，因为DST规律在以下地区发生了改变：
Chile, Cuba, Falkland Islands, Morocco, Samoa, 和 Turkey；还有South Australia, Alaska,
和 Hawaii的历史修正。</p></li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release-9-0-5.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="release.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="release-9-0-3.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">E.126. 版本 9.0.5 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> E.128. 版本 9.0.3</td></tr></table></div></body></html>
