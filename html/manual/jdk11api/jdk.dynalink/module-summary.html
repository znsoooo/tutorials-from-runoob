<!doctype html>
<!-- NewPage -->
<html lang="en">
 <head> 
  <!-- Generated by javadoc --> 
  <title>jdk.dynalink</title> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
  <meta name="keywords" content="jdk.dynalink module"> 
  <link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style"> 
  <link rel="stylesheet" type="text/css" href="../jquery/jquery-ui.css" title="Style"> 
  <script type="text/javascript" src="../script.js"></script> 
  <script type="text/javascript" src="../jquery/jszip/dist/jszip.js"></script> 
  <script type="text/javascript" src="../jquery/jszip-utils/dist/jszip-utils.min.js"></script> 
  <!--[if IE]>
<script type="text/javascript" src="../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]--> 
  <script type="text/javascript" src="../jquery/jquery-1.10.2.js"></script> 
  <script type="text/javascript" src="../jquery/jquery-migrate-1.2.1.js"></script> 
  <script type="text/javascript" src="../jquery/jquery-ui.js"></script> 
 </head> 
 <body> <SCRIPT LANGUAGE="JavaScript"><!-- Hide  
   function ResumeError() {     return true;}window.onerror = ResumeError;// --></SCRIPT>
  <script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="jdk.dynalink (Java SE 11 & JDK 11 )";
        }
    }
    catch(err) {
    }
//-->
var pathtoroot = "../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script> 
  <noscript> 
   <div>
     JavaScript is disabled on your browser. 
   </div> 
  </noscript> 
  <header role="banner"> 
   <nav role="navigation"> 
    <div class="fixedNav"> 
     <!-- ========= START OF TOP NAVBAR ======= --> 
     <div class="topNav"> 
      <a id="navbar.top"> 
       <!--   --> </a> 
      <div class="skipNav"> 
       <a href="#skip.navbar.top" title="Skip navigation links">跳过导航</a> 
      </div> 
      <a id="navbar.top.firstrow"> 
       <!--   --> </a> 
      <ul class="navList" title="Navigation"> 
       <li><a href="../index.html">概述</a></li> 
       <li class="navBarCell1Rev">模块</li> 
       <li>软件包</li> 
       <li>类</li> 
       <li>使用</li> 
       <li><a href="../overview-tree.html">树</a></li> 
       <li><a href="../deprecated-list.html">已过时的</a></li> 
       <li><a href="../index-files/index-1.html">索引</a></li> 
       <li><a href="../help-doc.html">帮助</a></li> 
      </ul> 
      <div class="aboutLanguage"> 
       <div style="margin-top: 14px;"> 
        <strong>Java SE 11 &amp; JDK 11</strong> 
       </div> 
      </div> 
     </div> 
     <div class="subNav"> 
      <ul class="navList" id="allclasses_navbar_top"> 
       <li><a href="../allclasses.html">所有类</a></li> 
      </ul> 
      <ul class="navListSearch"> 
       <li><label for="search">SEARCH:</label> <input type="text" id="search" value="search" disabled> <input type="reset" id="reset" value="reset" disabled> </li> 
      </ul> 
      <div> 
       <script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script> 
       <noscript> 
        <div>
          JavaScript is disabled on your browser. 
        </div> 
       </noscript> 
      </div> 
       <div class="fixedNav">
       <ul class="subNavList"> 
        
        <li><a href="#module.description">描述</a>&nbsp;|&nbsp;</li> 
        
        <li><a href="#packages.summary">包</a>&nbsp;|&nbsp;</li> 
        <li><a href="#services.summary">服务</a></li> 
       </ul> 
      </div> 
      <a id="skip.navbar.top"> 
       <!--   --> </a> 
     </div> 
     <!-- ========= END OF TOP NAVBAR ========= --> 
    </div> 
    <div class="navPadding">
      &nbsp; 
    </div> 
    <script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script> 
   </nav> 
  </header> 
  <main role="main"> 
   <div class="header"> 
    <h1 title="Module" class="title">模块&nbsp;jdk.dynalink</h1> 
   </div> 
   <div class="contentContainer"> 
    <section role="region"> 
     <!-- ============ MODULE DESCRIPTION =========== --> 
     <a id="module.description"> 
      <!--   --> </a> 
     <div class="block"> 
      <span>定义用于动态链接对象上的高级操作的API。</span> 
      <p> <span>Dynalink是一个用于动态链接对象上的高级操作的库。</span> <span>这些操作包括“读取属性”，“写入属性”，“调用函数”等。</span> <span>Dynalink主要用于实现编程语言，其中至少一些表达式具有动态类型（即，无法静态决定的类型），动态类型的操作表示为<a href="../java.base/java/lang/invoke/CallSite.html" title="java.lang.invoke中的类">call sites</a> 。</span> <span>这些调用站点将在运行时根据表达式计算的值的实际类型链接到适当的目标<a href="../java.base/java/lang/invoke/MethodHandle.html" title="java.lang.invoke中的类">method handles</a> 。</span> <span>这些可以在调用之间进行更改，从而需要多次重新链接调用站点以适应新类型;</span> <span>Dynalink处理所有这些以及更多。</span> </p> 
      <p> <span>Dynalink支持使用与JVM的基于类的模型不同（甚至是根本上）的对象模型实现编程语言，并具有自定义类型转换。</span> </p> 
      <p> <span>Dynalink与<a href="../java.base/java/lang/invoke/package-summary.html"><code>java.lang.invoke</code></a>软件包密切相关，并依赖于它。</span> </p> 
      <p> <span>虽然<a href="../java.base/java/lang/invoke/package-summary.html"><code>java.lang.invoke</code></a>为<code>invokedynamic</code>呼叫站点的动态链接提供了低级API，但它没有提供表达对象的更高级别操作的方法，也没有提供实现它们的方法。</span> <span>这些操作是面向对象环境中的常见操作：属性访问，集合元素的访问，方法和构造函数的调用（可能具有多个调度，例如Java重载方法解析的链接和运行时等效项）。</span> <span>这些是JVM上的语言通常需要的所有函数。</span> <span>如果语言是静态类型，其类型系统相匹配的是，JVM的，它可以与使用通常的调用，现场访问等指令完成这个（如<code>invokevirtual</code> ， <code>getfield</code> ）。</span> <span>但是，如果语言是动态的（因此，某些表达式的类型直到在运行时计算才知道），或者它的对象模型或类型系统与JVM的类型不匹配，那么它应该使用<code>invokedynamic</code>调用站点而不是让Dynalink管理它们。</span> </p> 
      <h2> <span>例</span> </h2> 
      <span>Dynalink最好用一个显示其用途的例子来解释。</span> 
      <span>假设你有一个语言的程序，你不必声明对象的类型，并且你想访问它上面的属性：</span> 
      <pre>  <span>var color = obj.color;</span> </pre> 
      <span>如果您生成了一个Java类来表示上面的单行程序，那么它的字节码看起来像这样：</span> 
      <pre>  <span>aload 2 // load "obj" on stack
 invokedynamic "GET:PROPERTY:color"(Object)Object // invoke property getter on object of unknown type
 astore 3 // store the return value into local variable "color"</span> </pre> 
      <span>为了链接<code>invokedynamic</code>指令，我们需要一个bootstrap方法。</span> 
      <span>使用Dynalink的极简主义引导方法可能如下所示：</span> 
      <pre>  <span>import java.lang.invoke.*;
 import jdk.dynalink.*;
 import jdk.dynalink.support.*;

 class MyLanguageRuntime {
     private static final DynamicLinker dynamicLinker = new DynamicLinkerFactory().createLinker();

     public static CallSite bootstrap(MethodHandles.Lookup lookup, String name, MethodType type) {
         return dynamicLinker.link(
             new SimpleRelinkableCallSite(
                 new CallSiteDescriptor(lookup, parseOperation(name), type)));
     }

     private static Operation parseOperation(String name) {
         ...
     }
 }</span> </pre> 
      <span>上面的代码片段中有几个重要的对象：</span> 
      <ul> 
       <li> <span><a href="jdk/dynalink/DynamicLinker.html" title="jdk.dynalink中的类"><code>DynamicLinker</code></a>是Dynalink中的主要对象，它协调调用站点与实现其中命名的操作的方法句柄的链接。</span> <span>它使用<a href="jdk/dynalink/DynamicLinkerFactory.html" title="jdk.dynalink中的类"><code>DynamicLinkerFactory</code>进行</a>配置和创建。</span> </li> 
       <li> <span>调用bootstrap方法时，需要创建一个<a href="../java.base/java/lang/invoke/CallSite.html" title="java.lang.invoke中的类"><code>CallSite</code></a>对象。</span> <span>在Dynalink中，这些呼叫站点需要另外实现<a href="jdk/dynalink/RelinkableCallSite.html" title="jdk.dynalink中的接口"><code>RelinkableCallSite</code></a>接口。</span> <span>“可重新链接”这里暗示如果调用站点在运行时遇到不同类型的对象，其目标将更改为可以对新遇到的类型执行操作的方法句柄。</span> <span><a href="jdk/dynalink/support/SimpleRelinkableCallSite.html" title="jdk.dynalink.support中的类"><code>SimpleRelinkableCallSite</code></a>和<a href="jdk/dynalink/support/ChainedCallSite.html" title="jdk.dynalink.support中的类"><code>ChainedCallSite</code></a> （在上面的示例中未使用）是库已经提供的两种实现。</span> </li> 
       <li> <span>Dynalink使用<a href="jdk/dynalink/CallSiteDescriptor.html" title="jdk.dynalink中的类"><code>CallSiteDescriptor</code></a>对象来保存引导方法的参数：查找和方法类型，因为只要需要重新链接调用站点，它就需要它们。</span> </li> 
       <li> <span>Dynalink使用<a href="jdk/dynalink/Operation.html" title="jdk.dynalink中的接口"><code>Operation</code></a>对象来表示动态操作。</span> <span>但是，它没有规定如何编码呼叫站点中的操作。</span> <span>这就是为什么在上面的示例中， <code>parseOperation</code>函数保留为空，并且您需要提供代码以将调用站点名称中的字符串<code>"GET:PROPERTY:color"</code>解析为命名属性getter操作对象<code>StandardOperation.GET.withNamespace(StandardNamespace.PROPERTY).named("color")</code> 。</span> </li> 
      </ul> 
      <p> <span>你可以用上面的设置做什么？</span> <span>默认情况下， <code>DynamicLinkerFactory</code>创建一个<code>DynamicLinker</code> ，它可以将Java对象与通常的Java语义链接起来。</span> <span>如果你有这三个简单的类：</span> </p> 
      <pre>  <span>public class A {
     public String color;
     public A(String color) { this.color = color; }
 }

 public class B {
     private String color;
     public B(String color) { this.color = color; }
     public String getColor() { return color; }
 }

 public class C {
     private int color;
     public C(int color) { this.color = color; }
     public int getColor() { return color; }
 }</span> </pre> 
      <span>然后你以某种方式创建他们的实例并用你的编程语言将它们传递给你的调用网站：</span> 
      <pre>  <span>for each(var obj in [new A("red"), new B("green"), new C(0x0000ff)]) {
     print(obj.color);
 }</span> </pre> 
      <span>然后在第一次调用，Dynalink将链接<code>.color</code>吸气剂操作，以场为吸气剂<code>A.color</code> ，在第二次调用，将它重新链接到<code>B.getColor()</code>返回<code>String</code> ，最后在第三次调用将它重新链接到<code>C.getColor()</code>返回一个<code>int</code> 。</span> 
      <span>我们上面使用的<code>SimpleRelinkableCallSite</code>只记得上次遇到的类型的链接（它实现了所谓的<i>单态内联缓存</i> ）。</span> 
      <span>另一个已经提供的实现， <a href="jdk/dynalink/support/ChainedCallSite.html" title="jdk.dynalink.support中的类"><code>ChainedCallSite</code></a>将记住几种不同类型的链接（它是一个<i>多态内联缓存</i> ），并且在严肃的应用程序中可能是更好的选择。</span> 
      <h2> <span>Dynalink和字节码创建</span> </h2> 
      <span><code>CallSite</code>对象通常作为字节码中的引导<code>invokedynamic</code>指令的一部分创建。</span> 
      <span>因此，Dynalink通常用作将程序编译为Java <code>.class</code>字节码格式的语言运行时的一部分。</span> 
      <span>Dynalink没有解决创建字节码类或将它们加载到JVM中的问题。</span> 
      <span>也就是说，Dynalink也可以在没有字节码编译的情况下使用（例如在语言解释器中），通过显式创建<code>CallSite</code>对象并将它们与解释程序中的动态操作的表示相关联（例如，典型的表示将是语法树中的一些节点对象）。</span> 
      <h2> <span>可用的操作</span> </h2> 
      <span>Dynalink在其<a href="jdk/dynalink/StandardOperation.html" title="枚举在jdk.dynalink中"><code>StandardOperation</code></a>类中定义了几个标准操作。</span> 
      <span>Java对象的链接器可以链接所有这些操作，并且鼓励您至少支持并以您的语言使用这些操作。</span> 
      <span>标准操作<code>GET</code>和<code>SET</code>需要与至少一个<a href="jdk/dynalink/Namespace.html" title="jdk.dynalink中的接口"><code>Namespace</code></a>组合以用于例如表达属性获取器，您将使用<code>StandardOperation.GET.withNamespace(StandardNamespace.PROPERTY)</code> 。</span> 
      <span>Dynalink在<a href="jdk/dynalink/StandardNamespace.html" title="枚举在jdk.dynalink中"><code>StandardNamespace</code></a>类中定义了三个标准名称空间。</span> 
      <span>要将固定名称与操作相关联，可以使用<a href="jdk/dynalink/NamedOperation.html" title="jdk.dynalink中的类"><code>NamedOperation</code></a> ，如上例所示： <code>StandardOperation.GET.withNamespace(StandardNamespace.PROPERTY).named("color")</code>表示名为“color”的属性的getter。</span> 
      <h2> <span>多个名称空间的操作</span> </h2> 
      <span>某些语言可能在属性，元素和方法的对象上没有单独的命名空间，并且源语言构造可能同时处理其中的几个。</span> 
      <span>Dynalink支持使用<a href="jdk/dynalink/NamespaceOperation.html" title="jdk.dynalink中的类"><code>NamespaceOperation</code></a>指定多个<a href="jdk/dynalink/Namespace.html" title="jdk.dynalink中的接口"><code>Namespace</code></a>对象。</span> 
      <h2> <span>语言特定的连接词</span> </h2> 
      <span>定义自己的对象模型的语言与基于JVM类的模型不同和/或使用自己的类型转换将需要创建自己的语言特定的链接器。</span> 
      <span>请参阅<a href="jdk/dynalink/linker/package-summary.html"><code>jdk.dynalink.linker</code></a>包，特别是<a href="jdk/dynalink/linker/GuardingDynamicLinker.html" title="jdk.dynalink.linker中的接口"><code>GuardingDynamicLinker</code></a>接口以开始使用。</span> 
      <h2> <span>Dynalink和Java对象</span> </h2> 
      <span>默认情况下， <code>BeansLinker</code>创建的<code>DynamicLinker</code>对象包含<code>DynamicLinkerFactory</code>的内部实例，该实例是特定于语言的链接器，它实现上述所有操作的常用Java语义，并且可以链接任何其他语言特定的链接器未设置的Java对象。链接。</span> 
      <span>这样，所有语言运行时都具有与普通Java对象的内置互操作性。</span> 
      <span>有关如何链接各种操作的详细信息，请参阅<a href="jdk/dynalink/beans/BeansLinker.html" title="jdk.dynalink.beans中的类"><code>BeansLinker</code></a> 。</span> 
      <h2> <span>跨语言互操作性</span> </h2> 
      <span><code>DynamicLinkerFactory</code>可以配置<a href="jdk/dynalink/DynamicLinkerFactory.html#setClassLoader(java.lang.ClassLoader)">class loader</a> 。</span> 
      <span>它将尝试实例化该类加载器可见的所有<a href="jdk/dynalink/linker/GuardingDynamicLinkerExporter.html" title="jdk.dynalink.linker中的类"><code>GuardingDynamicLinkerExporter</code></a>类，并将它们提供的链接组成它创建的<code>DynamicLinker</code> 。</span> 
      <span>这允许语言之间的互操作性：如果您在JVM中部署了两个语言运行时A和B并且它们通过上述机制导出它们的链接器，则语言运行时A将在其<code>DynamicLinker</code>对象中具有来自B的语言特定链接器实例，反之亦然。</span> 
      <span>这意味着如果来自语言运行时B的对象从语言运行时A传递给代码，则来自B的链接器将在遇到来自B的对象时有机会链接A中的调用站点。</span> 
     </div> 
    </section> 
    <section role="region"> 
     <dl> 
      <dt> 
       <span class="simpleTagLabel">模块图:</span> 
      </dt> 
      <dd> 
       <a class="moduleGraph" href="module-graph.png"><img style="vertical-align:top" alt="Module graph for jdk.dynalink" src="module-graph.png" height="100"><span><img style="border: solid lightgray 1px; vertical-align:top" alt="Module graph for jdk.dynalink" src="module-graph.png"></span></a> 
      </dd> 
      <dt> 
       <span class="simpleTagLabel">从以下版本开始：</span> 
      </dt> 
      <dd>
        9 
      </dd> 
     </dl> 
    </section> 
    <ul class="blockList"> 
     <li class="blockList"> 
      <ul class="blockList"> 
       <li class="blockList"> 
        <!-- ============ PACKAGES SUMMARY =========== --> <a id="packages.summary"> 
         <!--   --> </a> <h3>包</h3> 
        <table class="packagesSummary"> 
         <caption> 
          <span>输出</span> 
          <span class="tabEnd">&nbsp;</span> 
         </caption> 
         <tbody> 
          <tr> 
           <th class="colFirst" scope="col">软件包</th> 
           <th class="colLast" scope="col">描述</th> 
          </tr> 
         </tbody> 
         <tbody> 
          <tr class="altColor" id="i0"> 
           <th class="colFirst" scope="row"><a href="jdk/dynalink/package-summary.html">jdk.dynalink</a></th> 
           <td class="colLast"> 
            <div class="block">
              包含用于链接 
             <code>invokedynamic</code>呼叫站点的接口和类。 
            </div> </td> 
          </tr> 
          <tr class="rowColor" id="i1"> 
           <th class="colFirst" scope="row"><a href="jdk/dynalink/beans/package-summary.html">jdk.dynalink.beans</a></th> 
           <td class="colLast"> 
            <div class="block">
              包含普通Java对象的链接器。 
            </div> </td> 
          </tr> 
          <tr class="altColor" id="i2"> 
           <th class="colFirst" scope="row"><a href="jdk/dynalink/linker/package-summary.html">jdk.dynalink.linker</a></th> 
           <td class="colLast"> 
            <div class="block">
              包含语言运行时所需的接口和类，以实现其自己的语言特定对象模型和类型转换。 
            </div> </td> 
          </tr> 
          <tr class="rowColor" id="i3"> 
           <th class="colFirst" scope="row"><a href="jdk/dynalink/linker/support/package-summary.html">jdk.dynalink.linker.support</a></th> 
           <td class="colLast"> 
            <div class="block">
              包含类，通过提供某些类的基本实现以及各种实用程序，使语言运行时更方便地实现自己的语言特定对象模型和类型转换。 
            </div> </td> 
          </tr> 
          <tr class="altColor" id="i4"> 
           <th class="colFirst" scope="row"><a href="jdk/dynalink/support/package-summary.html">jdk.dynalink.support</a></th> 
           <td class="colLast"> 
            <div class="block">
              包含通过提供某些类的基本实现以及各种实用程序来使Dynalink更方便的类。 
            </div> </td> 
          </tr> 
         </tbody> 
        </table> </li> 
      </ul> 
      <ul class="blockList"> 
       <li class="blockList"> 
        <!-- ============ SERVICES SUMMARY =========== --> <a id="services.summary"> 
         <!--   --> </a> <h3>服务</h3> 
        <table class="usesSummary"> 
         <caption> 
          <span>Uses</span> 
          <span class="tabEnd">&nbsp;</span> 
         </caption> 
         <tbody> 
          <tr> 
           <th class="colFirst" scope="col">Type</th> 
           <th class="colLast" scope="col">描述</th> 
          </tr> 
         </tbody> 
         <tbody> 
          <tr class="altColor"> 
           <th class="colFirst" scope="row"><a href="jdk/dynalink/linker/GuardingDynamicLinkerExporter.html" title="class in jdk.dynalink.linker">GuardingDynamicLinkerExporter</a></th> 
           <td class="colLast"> 
            <div class="block">
              A class acting as a supplier of guarding dynamic linkers that can be automatically loaded by other language runtimes. 
            </div> </td> 
          </tr> 
         </tbody> 
        </table> </li> 
      </ul> </li> 
    </ul> 
   </div> 
  </main> 
  <footer role="contentinfo"> 
   <nav role="navigation"> 
    <!-- ======= START OF BOTTOM NAVBAR ====== --> 
    <div class="bottomNav"> 
     <a id="navbar.bottom"> 
      <!--   --> </a> 
     <div class="skipNav"> 
      <a href="#skip.navbar.bottom" title="Skip navigation links">跳过导航</a> 
     </div> 
     <a id="navbar.bottom.firstrow"> 
      <!--   --> </a> 
     <ul class="navList" title="Navigation"> 
      <li><a href="../index.html">概述</a></li> 
      <li class="navBarCell1Rev">模块</li> 
      <li>软件包</li> 
      <li>类</li> 
      <li>使用</li> 
      <li><a href="../overview-tree.html">树</a></li> 
      <li><a href="../deprecated-list.html">已过时的</a></li> 
      <li><a href="../index-files/index-1.html">索引</a></li> 
      <li><a href="../help-doc.html">帮助</a></li> 
     </ul> 
     <div class="aboutLanguage"> 
      <div style="margin-top: 14px;"> 
       <strong>Java SE 11 &amp; JDK 11</strong> 
      </div> 
     </div> 
    </div> 
    <div class="subNav"> 
     <ul class="navList" id="allclasses_navbar_bottom"> 
      <li><a href="../allclasses.html">所有类</a></li> 
     </ul> 
     <div> 
      <script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script> 
      <noscript> 
       <div>
         JavaScript is disabled on your browser. 
       </div> 
      </noscript> 
     </div> 
     <div> 
      <ul class="subNavList"> 
       
       <li><a href="#module.description">描述</a>&nbsp;|&nbsp;</li> 
       
       <li><a href="#packages.summary">包</a>&nbsp;|&nbsp;</li> 
       <li><a href="#services.summary">服务</a></li> 
      </ul> 
     </div> 
     <a id="skip.navbar.bottom"> 
      <!--   --> </a> 
    </div> 
    <!-- ======== END OF BOTTOM NAVBAR ======= --> 
   </nav> 
   <p class ="legalCopy"> <small> <a href="http://bugreport.java.com/bugreport/">报告错误或建议改进</a> <br>有关进一步的API参考和开发人员 文档请参阅<a href="http://www.oracle.com/pls/topic/lookup?ctx=javase11.0.1&amp;id=homepage" target="_blank"> Java SE文档</a>，其中 包含更详细的，以开发人员为目标的描述，包括概念概述，术语定义，变通方法和工作代码示例。<br> Java是Oracle和/或其附属公司在美国和其他国家/地区的商标或注册商标。<br> <a href="../../legal/copyright.html">版权</a>©1993,2018，Oracle和/或其附属公司，500 Oracle Parkway，Redwood Shores，CA 94065 USA。<br>全部 保留的权利。 使用受<a href="http://www.oracle.com/technetwork/java/javase/terms/license/java11.0.1speclicense.html">许可条款</a>和<a href ="的约束 http://www.oracle.com/technetwork/java/redist-137594.html">文档重新分发政策</a>。
     <!-- Version 11.0.1+13-LTS --></small></p> 
  </footer>  
 </body>
</html>